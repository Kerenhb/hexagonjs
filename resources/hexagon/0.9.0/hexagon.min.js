/* hexagon.js 0.9.0 */
(function(){var hx = window.hx = {};
hx.theme = {
    "dropdown": {
  "spacing": "0"
},
    "paginator": {
  "arrowButton": "",
  "defaultButton": "hx-compliment",
  "selectedButton": "hx-positive"
},
    "palette": {
  "defaultCol": "#6582A6",
  "positiveCol": "#6FB365",
  "warningCol": "#CB9856",
  "negativeCol": "#C74967",
  "infoCol": "#A36FA9",
  "complimentCol": "#FDFDFD",
  "contrastCol": "#3D3D3D",
  "lightTextCol": "#F3F3F3",
  "darkTextCol": "#3D3D3D"
},
    "plot": {
  "colors": [
    "rgb(177,119,190)",
    "rgb(90,155,212)",
    "rgb(241,90,113)",
    "rgb(151,195,102)",
    "rgb(250,169,91)",
    "rgb(226,212,64)"
  ],
  "warmCol": "rgb(250,169,91)",
  "ambientCol": "rgb(226,212,64)",
  "coldCol": "rgb(90,155,212)",
  "positiveCol": "rgb(151,195,102)",
  "warningCol": "rgb(226,212,64)",
  "negativeCol": "rgb(241,90,113)"
}
  };
(function(){var Set,checkPrefix,prefix,prefixChar,prefixString;prefixString="\x00",prefixChar=prefixString.charCodeAt(0),prefix=function(t){return prefixString+t},checkPrefix=function(t){return t&&t.charCodeAt(0)===prefixChar},Set=function(){function t(t){var r,i,e;if(t)for(i=0,e=t.length;e>i;i++)r=t[i],this.add(r);this.size=0}return t.prototype.add=function(t){return prefix(t)in this||this.size++,this[prefix(t)]=t,this},t.prototype.clear=function(){var t;for(t in this)checkPrefix(t)&&delete this[t];return void(this.size=0)},t.prototype["delete"]=function(t){var r;return r=prefix(t),r in this&&delete this[r]?(this.size--,!0):!1},t.prototype.entries=function(){var t,r,i;t=[];for(r in this)i=this[r],checkPrefix(r)&&t.push([i,i]);return t},t.prototype.forEach=function(t,r){var i,e;null==r&&(r=this);for(i in this)e=this[i],checkPrefix(i)&&t.call(r,e);return void 0},t.prototype.has=function(t){return prefix(t)in this},t.prototype.keys=function(){return this.values()},t.prototype.values=function(){var t,r,i;r=[];for(t in this)i=this[t],checkPrefix(t)&&r.push(i);return r},t}(),hx.Set=Set;})();(function(){var Map,checkPrefix,prefix,prefixChar,prefixString;prefixString="\x00",prefixChar=prefixString.charCodeAt(0),prefix=function(t){return prefixString+t},checkPrefix=function(t){return t&&t.charCodeAt(0)===prefixChar},Map=function(){function t(t){var r,i,e;if(this.size=0,t)for(i=0,e=t.length;e>i;i++)r=t[i],this.set(r[0],r[1])}return t.prototype.clear=function(){var t;for(t in this)checkPrefix(t)&&delete this[t];return this.size=0},t.prototype["delete"]=function(t){var r;return r=prefix(t),r in this&&delete this[r]&&this.size--,this},t.prototype.entries=function(){var t,r,i;t=[];for(r in this)i=this[r],checkPrefix(r)&&t.push([r.substring(1),i]);return t},t.prototype.forEach=function(t,r){var i,e;null==r&&(r=this);for(i in this)e=this[i],checkPrefix(i)&&t.call(r,i.substring(1),e);return this},t.prototype.get=function(t){return prefix(t)in this?this[prefix(t)]:void 0},t.prototype.has=function(t){return prefix(t)in this},t.prototype.keys=function(){var t,r;r=[];for(t in this)checkPrefix(t)&&r.push(t.substring(1));return r},t.prototype.set=function(t,r){return prefix(t)in this||this.size++,this[prefix(t)]=r,this},t.prototype.values=function(){var t,r,i;t=[];for(r in this)i=this[r],checkPrefix(r)&&t.push(i);return t},t}(),hx.Map=Map;})();(function(){var List;List=function(){function t(t){this.list=null!=t?t:[],this.size=this.list.length}return t.prototype.add=function(t){return this.list.push(t),this.size++,this},t.prototype.clear=function(){return this.list=[],this.size=0,this},t.prototype["delete"]=function(t){return t>=0&&t<this.list.length?(this.list.splice(t,1),this.size--,!0):!1},t.prototype.entries=function(){return this.list},t.prototype.forEach=function(t,i){var s,e,n,r;for(null==i&&(i=this),r=this.list,e=0,n=r.length;n>e;e++)s=r[e],t.call(i,s);return void 0},t.prototype.get=function(t){return t>=0&&t<this.list.length?this.list[t]:void 0},t.prototype.has=function(t){return-1!==this.list.indexOf(t)},t.prototype.remove=function(t){var i;return-1!==(i=this.list.indexOf(t))?(this.list.splice(i,1),this.size--,!0):!1},t.prototype.removeAll=function(t){var i,s;for(s=0;-1!==(i=this.list.indexOf(t));)this.list.splice(i,1),this.size--,s++;return s},t.prototype.values=function(){return this.list},t}(),hx.List=List;})();(function(){var hx_extend,hx_merge,hx_parseHTML,supportsDate,supportsTouch,vendorPrefixes,__slice=[].slice;hx.deprecatedWarning=function(){var n,e;return n=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[],console.groupCollapsed("Deprecation Warning: "+n),e.length>0&&console.warn.apply(console,["Alternatives:"].concat(e)),console.trace("Stack Trace"),console.groupEnd()},hx.consoleWarning=function(){var n,e;return n=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[],console.groupCollapsed(n),e.length>0&&console.warn.apply(console,e),console.trace("Stack Trace"),console.groupEnd()},hx.hash=function(n,e){var r,t,o,a;for(o=0,t=n.length-1,r=a=0;t>=a;r=a+=1)o=31*o+n.charCodeAt(r),o&=o;return e?Math.abs(o)%e:o},hx.transpose=function(n){var e,r,t,o,a,i,u;if(null==n.length)return void 0;if(a=n.length,0===a||null==n[0].length)return n;for(e=n[0].length,o=new Array(e),r=i=0;e>i;r=i+=1)for(o[r]=new Array(a),t=u=0;a>u;t=u+=1)o[r][t]=n[t][r];return o},supportsTouch=void 0,supportsDate=void 0,hx.supports=function(n){var e;switch(n){case"touch":return null!=supportsTouch?supportsTouch:supportsTouch="ontouchstart"in window;case"date":return void 0===supportsDate&&(e=document.createElement("input"),e.setAttribute("type","date"),supportsDate="text"!==e.type),supportsDate}},hx.isChild=function(n,e){return hx.deprecatedWarning("hx.isChild","use Node.contains instead"),n.contains(e)},hx.clamp=function(n,e,r){return Math.min(e,Math.max(n,r))},hx.clampUnit=function(n){return hx.clamp(0,1,n)},hx.randomId=function(n,e){var r,t,o;return null==n&&(n=16),null==e&&(e="ABCEDEF0123456789"),t=e.split(""),r=t.length,function(){var e,a;for(a=[],o=e=0;n>e;o=e+=1)a.push(t[Math.floor(Math.random()*r)]);return a}().join("")},hx.min=function(n,e){return null!=e&&hx.consoleWarning("hx.min","hx.min no longer supports a second parameter to do transformations - apply transformations before passing into min:","eg hx.min(array.map(f)) instead of hx.min(array, f)"),Math.min.apply(null,null!=n?n.filter(hx.defined):void 0)},hx.minBy=function(n,e){var r,t,o,a,i,u,s,h,c;if(null==n||0===n.length)return void 0;if(e){for(o=n[0],a=e(o),t=u=1,c=n.length-1;c>u;t=u+=1)i=n[t],void 0!==i&&(r=e(i),void 0!==r&&a>r&&(o=i,a=r));return o}for(o=n[0],s=0,h=n.length;h>s;s++)i=n[s],void 0!==i&&o>i&&(o=i);return o},hx.max=function(n,e){return null!=e&&hx.consoleWarning("hx.max","hx.max no longer supports a second parameter to do transformations - apply transformations before passing into max:","eg hx.max(array.map(f)) instead of hx.max(array, f)"),Math.max.apply(null,null!=n?n.filter(hx.defined):void 0)},hx.maxBy=function(n,e){var r,t,o,a,i,u,s,h,c;if(null==n||0===n.length)return void 0;if(e){for(o=n[0],a=e(o),t=u=1,c=n.length-1;c>u;t=u+=1)i=n[t],void 0!==i&&(r=e(i),void 0!==r&&r>a&&(o=i,a=r));return o}for(o=n[0],s=0,h=n.length;h>s;s++)i=n[s],void 0!==i&&i>o&&(o=i);return o},hx.range=function(n){var e,r,t;for(t=[],e=r=0;n>r;e=r+=1)t.push(e);return t},hx.sum=function(n,e){return null!=e&&hx.consoleWarning("hx.sum no longer supports a second parameter to do transformations - apply transformations before passing into sum:","eg hx.sum(array.map(f)) instead of hx.sum(array, f)"),n.reduce(function(n,e){return n+e})},hx.flatten=function(n){return[].concat.apply([],n)},hx.cycle=function(n,e){return n[e%n.length]},hx.hashList=function(n,e){return n[hx.hash(e,n.length)]},hx.find=function(n,e){var r,t,o;for(t=0,o=n.length;o>t;t++)if(r=n[t],e(r))return r;return void 0},hx.isString=function(n){return"string"==typeof n||n instanceof String},hx.isFunction=function(n){return"function"==typeof n},hx.isArray=function(n){return n instanceof Array},hx.isObject=function(n){return"object"==typeof n&&!hx.isArray(n)},hx.isPlainObject=function(n){return"object"==typeof n&&!n.nodeType&&n.constructor&&n.constructor.prototype.hasOwnProperty("isPrototypeOf")},hx.groupBy=function(n,e){var r,t,o,a,i,u;for(t=new hx.Map,i=0,u=n.length;u>i;i++)a=n[i],r=e(a),t.has(r)||t.set(r,new hx.List),t.get(r).add(a);return o=t.entries(),o.forEach(function(n){return n[1]=n[1].entries()}),o},hx.unique=function(n){return new hx.Set(n).values()},hx.endsWith=function(n,e){return-1!==n.indexOf(e,n.length-e.length)},hx.startsWith=function(n,e){return 0===n.lastIndexOf(e,0)},hx.tween=function(n,e,r){return n+(e-n)*r},hx.defined=function(n){return void 0!==n},hx.zip=function(n){var e,r,t,o;if(n){if(n.length>0){if(r=hx.min(n.map(function(n){return n.length||0})),r>0){for(o=[],e=t=0;r>t;e=t+=1)o.push(n.map(function(n){return n[e]}));return o}return[]}return[]}return[]},hx_extend=function(n,e,r){var t,o,a;a=[];for(t in e)o=e[t],hx.isPlainObject(o)?(null==n[t]&&(n[t]={}),a.push(hx_extend(n[t],o,r))):a.push(void 0!==o||r?n[t]=hx.clone(o):void 0);return a},hx_merge=function(n,e,r){var t,o,a,i,u,s,h,c;if(n){for(a={},u=0,h=r.length;h>u;u++)o=r[u],hx.isPlainObject(o)&&hx_extend(a,o,e);return a}for(a={},s=0,c=r.length;c>s;s++)if(o=r[s],hx.isPlainObject(o))for(t in o)i=o[t],(void 0!==i||e)&&(a[t]=i);return a},hx.merge=function(){var n,e;return e=arguments[0],n=2<=arguments.length?__slice.call(arguments,1):[],hx_merge(!0,e,n)},hx.shallowMerge=function(){var n,e;return e=arguments[0],n=2<=arguments.length?__slice.call(arguments,1):[],hx_merge(!1,e,n)},hx.clone=function(n){return hx.isArray(n)?n.map(hx.clone):hx.isPlainObject(n)?hx.merge(!0,{},n):hx.isObject(n)?{}:n},hx.shallowClone=function(n){return hx.isArray(n)?n.slice():hx.isPlainObject(n)?hx.shallowMerge(!0,{},n):hx.isObject(n)?{}:n},vendorPrefixes=["webkit","ms","moz","Moz","o","O"],hx.vendor=function(n,e){var r,t,o,a;if(e in n)return n[e];for(o=0,a=vendorPrefixes.length;a>o;o++)if(r=vendorPrefixes[o],(t=r+e.charAt(0)+e.slice(1))in n)return n[t]},hx.identity=function(n){return n},hx_parseHTML=null,hx.parseHTML=function(n){var e;if(!hx_parseHTML)try{document.createRange().createContextualFragment(""),hx_parseHTML=function(n){return document.createRange().createContextualFragment(n)}}catch(r){e=r,hx_parseHTML=function(n){var e,r,t;for(r=document.createDocumentFragment(),t=document.createElement("div"),t.innerHTML=n;e=t.firstChild;)r.appendChild(e);return r}}return hx_parseHTML(n)},hx.cleanNode=function(n,e){var r,t;for(null==e&&(e=!0),t=n.childNodes.length-1;t>=0;)r=n.childNodes[t],3===r.nodeType&&/\s/.test(r.nodeValue)?n.removeChild(r):1===r.nodeType&&e&&hx.cleanNode(r),t-=1;return n};})();(function(){var Color,fromArray,fromString;Color=function(){function t(t,r,s,i,n,h,e){this.r=null!=t?t:0,this.g=null!=r?r:0,this.b=null!=s?s:0,this.a=null!=i?i:1,this.h=null!=n?n:0,this.s=null!=h?h:0,this.l=null!=e?e:0}var r,s,i,n;return i=function(t,r,s){return 0>s&&(s+=1),s>1&&(s-=1),1/6>s?t+6*(r-t)*s:.5>s?r:2/3>s?t+(r-t)*(2/3-s)*6:t},r=function(t){var r;return r=t.toString(16),1===r.length?"0"+r:r},n=function(t){var r,s,n,h,e,u,o,a;return n=t[0],a=t[1],h=t[2],a=hx.clampUnit(a),h=hx.clampUnit(h),0===a?o=s=r=h:(u=.5>h?h*(1+a):h+a-h*a,e=2*h-u,o=i(e,u,n+1/3),s=i(e,u,n),r=i(e,u,n-1/3)),o*=255,s*=255,r*=255,[o,s,r]},s=function(t){var r,s,i,n,h,e,u,o,a;if(o=t[0]/255,i=t[1]/255,r=t[2]/255,e=Math.max(o,i,r),u=Math.min(o,i,r),h=(e+u)/2,s=e-u,e===u)n=a=0;else{switch(a=h>.5?s/(2-e-u):s/(e+u),e){case o:n=(i-r)/s+(r>i?6:0);break;case i:n=(r-o)/s+2;break;case r:n=(o-i)/s+4}n/=6}return[n,a,h]},t.prototype.getTextCol=function(){var t;return t=(299*this.r+587*this.g+114*this.b)/1e3,t>=128?"black":"white"},t.prototype.setRGB=function(t,r){return null==t&&(t=[]),null==t[0]&&(t[0]=this.r),null==t[1]&&(t[1]=this.g),null==t[2]&&(t[2]=this.b),null==t[3]&&(t[3]=this.a),this.r=Math.round(Number(t[0])),this.g=Math.round(Number(t[1])),this.b=Math.round(Number(t[2])),this.a=Math.round(100*Number(t[3]))/100,r||this.setHSL(s([this.r,this.g,this.b]),1),this},t.prototype.setHSL=function(t,r){return null==t&&(t=[]),null==t[0]&&(t[0]=this.h),null==t[1]&&(t[1]=this.s),null==t[2]&&(t[2]=this.l),null==t[3]&&(t[3]=this.a),t[0]>1&&(t[0]/=360),t[1]>1&&(t[1]/=100),t[2]>1&&(t[2]/=100),this.h=Number(t[0]),this.s=Number(t[1]),this.l=Number(t[2]),this.a=Math.round(100*Number(t[3]))/100,r||this.setRGB(n([this.h,this.s,this.l]),1),this},t.prototype.toString=function(t){var s,i,n;switch(s=Math.round(360*this.h),n=Math.round(100*this.s),i=Math.round(100*this.l),t){case"hsl":return"hsl("+s+","+n+"%,"+i+"%)";case"hsla":return"hsla("+s+","+n+"%,"+i+"%,"+this.a+")";case"rgb":return"rgb("+this.r+","+this.g+","+this.b+")";case"rgba":return"rgba("+this.r+","+this.g+","+this.b+","+this.a+")";default:return 1!==this.a?"rgba("+this.r+","+this.g+","+this.b+","+this.a+")":"#"+r(this.r)+r(this.g)+r(this.b)}},t.prototype.toArray=function(){return[this.r,this.g,this.b,this.a]},t.prototype.mix=function(t,r){var s,i,n,h;return null==r&&(r=.5),h=this.r*(1-r)+t.r*r,n=this.g*(1-r)+t.g*r,i=this.b*(1-r)+t.b*r,s=this.a*(1-r)+t.a*r,this.setRGB([h,n,i,s])},t.prototype.range=function(t,r,s,i){var n,h,e,u,o;return null==t&&(t=3),null==r&&(r=3),null==s&&(s=.5),o=s/Math.max(t,r,1),u=this,h=hx.range(t+1).map(function(t){return u.clone().lighten(o*t)}),n=hx.range(r).reverse().map(function(t){return u.clone().darken(o*(t+1))}),e=n.concat(h),i?e.map("array"===i?function(t){return t.toArray()}:function(t){return t.toString(i)}):e},t.prototype.saturate=function(t){return this.s=this.s+this.s*t,this.setHSL([this.h,this.s,this.l])},t.prototype.desaturate=function(t){return this.s=this.s-this.s*t,this.setHSL([this.h,this.s,this.l])},t.prototype.saturation=function(t){return 0!==this.s&&(this.s=t),this.setHSL([this.h,this.s,this.l])},t.prototype.lighten=function(t){return this.l=this.l+this.l*t,this.setHSL([this.h,this.s,this.l])},t.prototype.darken=function(t){return this.l=this.l-this.l*t,this.setHSL([this.h,this.s,this.l])},t.prototype.lightness=function(t){return this.l=t,this.setHSL([this.h,this.s,this.l])},t.prototype.fadeIn=function(t){return this.a=Math.round(100*(this.a+this.a*t))/100,this.a>1&&(this.a=1),this},t.prototype.fadeOut=function(t){return this.a=Math.round(100*(this.a-this.a*t))/100,this.a<0&&(this.a=0),this},t.prototype.alpha=function(t){return this.a=t,this},t.prototype.clone=function(){return new t(this.r,this.g,this.b,this.a,this.h,this.s,this.l)},t}(),fromString=function(t){var r,s,i,n,h,e,u,o,a;if(!hx.isString(t))return void 0;if(-1!==t.indexOf("#"))t=t.substring(1),h=3===t.length?1:2,o=[t.substring(0,h),t.substring(h,2*h),t.substring(2*h,3*h)],1===h&&(o[0]+=""+o[0],o[1]+=""+o[1],o[2]+=""+o[2]),e=parseInt(o[0],16),i=parseInt(o[1],16),s=parseInt(o[2],16),r=1,u=[e,i,s,r];else{if(-1===t.indexOf("rgb"))return-1!==t.indexOf("hsl")?(a=t.replace("hsl(","").replace("hsla(","").replace(")","").replace("%","").replace("%","").replace("%",""),n=a.split(","),n.some(function(t){return isNaN(Number(t))})?void 0:(null==n[3]&&(n[3]=1),(new Color).setHSL(n))):void 0;a=t.replace("rgb(","").replace("rgba(","").replace(")",""),u=a.split(",")}return null==u[3]&&(u[3]=1),u.some(function(t){return isNaN(Number(t))})?void 0:(new Color).setRGB(u)},fromArray=function(t){return t[0]=hx.clamp(0,255,t[0]),t[1]=hx.clamp(0,255,t[1]),t[2]=hx.clamp(0,255,t[2]),null==t[3]&&(t[3]=1),t[3]=hx.clamp(0,1,t[3]),(new Color).setRGB(t)},hx.color=function(){return 4===arguments.length?(new Color).setRGB([arguments[0],arguments[1],arguments[2],arguments[3]]):3===arguments.length?(new Color).setRGB([arguments[0],arguments[1],arguments[2],1]):1===arguments.length?Array.isArray(arguments[0])?fromArray(arguments[0]):fromString(arguments[0]):new Color},hx.color.isColorString=function(t){return void 0!==fromString(t)},hx.color.isColor=function(t){return t instanceof Color};})();(function(){var ElementSet,Selection,augmenters,classed,closestParent,flattenNodes,getHexagonElementDataObject,namespaces,reformed,select,selectAll,selectSingle;namespaces={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},selectSingle=function(e,t){return t.querySelector(e)},selectAll=function(e,t){return t.querySelectorAll(e)},"function"==typeof Sizzle&&(selectSingle=function(e,t){return Sizzle(e,t)[0]||null},selectAll=Sizzle),getHexagonElementDataObject=function(e,t){return null==t&&(t=!0),t?(null==e.__hx__&&(e.__hx__={}),e.__hx__):e.__hx__?e.__hx__:void 0},ElementSet=function(){function e(){this.elements=new hx.List,this.ids=new hx.Set}return e.prototype.add=function(e){var t,n;return t=getHexagonElementDataObject(e),null==t.id&&(t.id=hx.randomId()),n=t.id,this.ids.has(n)?void 0:(this.ids.add(n),this.elements.add(e))},e.prototype.remove=function(e){var t;return t=getHexagonElementDataObject(e,!1),t&&t.id&&this.ids.has(t.id)?(this.elements.remove(e),this.ids["delete"](t.id)):void 0},e.prototype.entries=function(){return this.elements.entries()},e.prototype.has=function(e){var t;return t=getHexagonElementDataObject(e),t&&t.id&&this.ids.has(t.id)||!1},e}(),closestParent=function(e,t){var n;for(t=t.parentNode,n=function(){if(t.matches)return"matches";if(t.matchesSelector)return"matchesSelector";if(t.mozMatchesSelector)return"mozMatchesSelector";if(t.webkitMatchesSelector)return"webkitMatchesSelector";if(t.oMatchesSelector)return"oMatchesSelector";if(t.msMatchesSelector)return"msMatchesSelector";throw new Error("Dom matches method is not available (and is needed for closest())")}();t&&t!==document;){if(t[n](e))return t;t=t.parentNode}return void 0},flattenNodes=function(e){var t,n,r,o,s,i,l;for(r=new ElementSet,o=0,i=e.length;i>o;o++)for(n=e[o],s=0,l=n.length;l>s;s++)t=n[s],r.add(t);return r.entries()},classed=function(e,t,n){var r,o,s,i;return i=hx.select(e),(r=i.attr("class"))?(s=r.split(" "),o=s.indexOf(t),n&&-1===o?s.push(t):n||-1===o||s.splice(o,1),i.attr("class",s.join(" "))):(n&&i.attr("class",t),i)},reformed=function(e,t){return e?0===t.length?void 0:1===t.length?t[0]:t:t},augmenters=[],Selection=function(){function e(e){this.nodes=e,this.nodes=this.nodes.filter(function(e){return null!=e}),this.singleSelection=!1,this.longestTransition=0}var t,n;return e.prototype.select=function(t){var n;return hx.isString(t)?(n=new e(this.nodes.map(function(e){return selectSingle(t,e)})),n.singleSelection=this.singleSelection,n):(hx.consoleWarning("Selection.select was passed the wrong argument type","Selection.select only accepts a string argument, you supplied:",t),new e([]))},e.prototype.selectAll=function(t){return hx.isString(t)?new e(flattenNodes(this.nodes.map(function(e){return selectAll(t,e)}))):(hx.consoleWarning("Selection.selectAll was passed the wrong argument type","Selection.selectAll only accepts a string argument, you supplied:",t),new e([]))},e.prototype.closest=function(t){var n;return n=hx.isString(t)?new e(this.nodes.map(function(e){return closestParent(t,e)})):(hx.consoleWarning("Selection.closest was passed the wrong argument type","Selection.closest only accepts a string argument, you supplied:",t),new e([])),n.singleSelection=this.singleSelection,n},n=function(e,t,n){var r,o,s,i,l,u,c;if(t instanceof HTMLElement)return e.singleSelection?1===e.nodes.length?(n(e.nodes[0],t),[t]):[]:(hx.consoleWarning("Selection Api error when attaching element","You can not attach an existing element to a selection with multiple elements"),[]);for(u=e.nodes,c=[],i=0,l=u.length;l>i;i++)s=u[i],r=namespaces.hasOwnProperty(t)?namespaces[t]:s.namespaceURI,o=s.ownerDocument.createElementNS(r,t),n(s,o),c.push(o);return c},t=function(t,r,o,s){var i,l,u,c,a,h;return null==s&&(s=!1),h=t.singleSelection,u=r instanceof e?(h=h&&r.singleSelection,i=s?-1:1,c=function(){var e,s,u,c;for(u=r.nodes,c=[],i>0?(e=0,s=u.length):e=u.length-1;i>0?s>e:e>=0;e+=i)l=u[e],c.push(n(t,l,o));return c}(),hx.flatten(s?c.reverse():c)):hx.isArray(r)?(h=!1,i=s?-1:1,c=function(){var e,s,u;for(u=[],i>0?(e=0,s=r.length):e=r.length-1;i>0?s>e:e>=0;e+=i)l=r[e],u.push(n(t,l,o));return u}(),hx.flatten(s?c.reverse():c)):n(t,r,o),a=new e(u),a.singleSelection=h,a},e.prototype.prepend=function(e){return t(this,e,function(e,t){return e.insertBefore(t,e.firstChild)},!0)},e.prototype.append=function(e){return t(this,e,function(e,t){return e.appendChild(t)})},e.prototype.insertBefore=function(e){return t(this,e,function(e,t){return e.parentNode.insertBefore(t,e)})},e.prototype.insertAfter=function(e){return t(this,e,function(e,t){return e.parentNode.insertBefore(t,e.nextSibling)},!0)},e.prototype.remove=function(){var e,t,n,r,o,s;for(r=this.nodes,s=[],t=0,n=r.length;n>t;t++)e=r[t],s.push(null!=(o=e.parentNode)?o.removeChild(e):void 0);return s},e.prototype.node=function(e){return null==e&&(e=0),this.nodes[e]},e.prototype.clone=function(t){var n,r,o;return null==t&&(t=!0),n=function(){var e,n,o,s;for(o=this.nodes,s=[],e=0,n=o.length;n>e;e++)r=o[e],s.push(r.cloneNode(t));return s}.call(this),o=new e(n),o.singleSelection=this.singleSelection,o},e.prototype.prop=function(e,t){var n,r,o,s;if(2===arguments.length){if(null!=t)for(s=this.nodes,r=0,o=s.length;o>r;r++)n=s[r],n[e]=t;return this}return reformed(this.singleSelection,function(){var t,r,o,s;for(o=this.nodes,s=[],t=0,r=o.length;r>t;t++)n=o[t],s.push(n[e]);return s}.call(this))},e.prototype.attr=function(e,t){var n,r,o,s;if(2===arguments.length){for(s=this.nodes,r=0,o=s.length;o>r;r++)n=s[r],void 0!==t?n.setAttribute(e,t):n.removeAttribute(e);return this}return reformed(this.singleSelection,function(){var t,r,o,s;for(o=this.nodes,s=[],t=0,r=o.length;r>t;t++)n=o[t],s.push(n.getAttribute(e));return s}.call(this))},e.prototype.style=function(e,t){var n,r,o,s;if(2===arguments.length){for(s=this.nodes,r=0,o=s.length;o>r;r++)n=s[r],n.style.setProperty(e,t);return this}return reformed(this.singleSelection,function(){var t,r,o,s;for(o=this.nodes,s=[],t=0,r=o.length;r>t;t++)n=o[t],s.push(window.getComputedStyle(n,null).getPropertyValue(e));return s}.call(this))},e.prototype.text=function(e){var t,n,r,o;if(1===arguments.length){for(o=this.nodes,n=0,r=o.length;r>n;n++)t=o[n],t.textContent=null!=e?e:"";return this}return reformed(this.singleSelection,function(){var e,n,r,o;for(r=this.nodes,o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(t.textContent||"");return o}.call(this))},e.prototype.html=function(e){var t,n,r,o;if(1===arguments.length){for(o=this.nodes,n=0,r=o.length;r>n;n++)t=o[n],t.innerHTML=e||"";return this}return reformed(this.singleSelection,function(){var e,n,r,o;for(r=this.nodes,o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(t.innerHTML||"");return o}.call(this))},e.prototype["class"]=function(e){var t,n,r,o;if(1===arguments.length){for(o=this.nodes,n=0,r=o.length;r>n;n++)t=o[n],t.setAttribute("class",e||"");return this}return reformed(this.singleSelection,function(){var e,n,r,o;for(r=this.nodes,o=[],e=0,n=r.length;n>e;e++)t=r[e],o.push(t.getAttribute("class")||"");return o}.call(this))},e.prototype.classed=function(e,t){var n,r,o,s,i,l;if(1===arguments.length)return n=function(){var e,t,n,r;for(n=this.nodes,r=[],e=0,t=n.length;t>e;e++)o=n[e],r.push(o.getAttribute("class")||"");return r}.call(this),reformed(this.singleSelection,function(){var t,o,s;for(s=[],t=0,o=n.length;o>t;t++)r=n[t],s.push(-1!==r.split(" ").indexOf(e));return s}());for(l=this.nodes,s=0,i=l.length;i>s;s++)o=l[s],classed(o,e,t);return this},e.prototype.value=function(e){return 1===arguments.length?this.prop("value",e):this.prop("value")},e.prototype.on=function(e,t,n){var r,o,s,i,l,u,c,a,h,g;for(g=this.nodes,u=0,a=g.length;a>u;u++){if(l=g[u],o=getHexagonElementDataObject(l),i=o.eventEmitter?o.eventEmitter:o.eventEmitter=new hx.EventEmitter,null==o.eventAugmenters&&(o.eventAugmenters=new hx.Map),i.hasNameRegistered(e)||l.addEventListener(e,function(t){return i.emit(e,t)}),n||i.deregisterAll(e),!o.eventAugmenters.has(e)){for(s=[],c=0,h=augmenters.length;h>c;c++)r=augmenters[c],r.name===e&&s.push(r.setup(l,i));o.eventAugmenters.set(e,s)}i.on(e,t)}return this},e.prototype.off=function(e,t){var n,r,o,s,i,l;for(i=this.nodes,o=0,s=i.length;s>o;o++)r=i[o],n=getHexagonElementDataObject(r),null!=(l=n.eventEmitter)&&l.deregister(e,t);return this},e.prototype.data=function(e,t){var n,r,o;return 1===arguments.length?(o=function(){var t,o,s,i;for(s=this.nodes,i=[],t=0,o=s.length;o>t;t++)r=s[t],n=getHexagonElementDataObject(r),i.push(n.data?n.data.get(e):void 0);return i}.call(this),reformed(this.singleSelection,o)):(o=function(){var o,s,i,l;for(i=this.nodes,l=[],o=0,s=i.length;s>o;o++)r=i[o],n=getHexagonElementDataObject(r),null==n.data&&(n.data=new hx.Map),l.push(n.data.set(e,t));return l}.call(this),this)},e.prototype.view=function(e,t){return null==t&&(t="div"),0===this.size()&&hx.consoleWarning(".view() called on an empty selection"),new View(this,e,t)},e.prototype.each=function(e){return this.nodes.forEach(e),this},e.prototype.map=function(e){return reformed(this.singleSelection,this.nodes.map(e))},e.prototype.filter=function(t){var n;return n=new e(this.nodes.filter(t)),n.singleSelection=this.singleSelection,n},e.prototype.box=function(){var e;return reformed(this.singleSelection,function(){var t,n,r,o;for(r=this.nodes,o=[],t=0,n=r.length;n>t;t++)e=r[t],o.push(e.getBoundingClientRect());return o}.call(this))},e.prototype.width=function(){var e;return reformed(this.singleSelection,function(){var t,n,r,o;for(r=this.nodes,o=[],t=0,n=r.length;n>t;t++)e=r[t],o.push(e.getBoundingClientRect().width);return o}.call(this))},e.prototype.height=function(){var e;return reformed(this.singleSelection,function(){var t,n,r,o;for(r=this.nodes,o=[],t=0,n=r.length;n>t;t++)e=r[t],o.push(e.getBoundingClientRect().height);return o}.call(this))},e.prototype.size=function(){return this.nodes.length},e.prototype.empty=function(){return 0===this.nodes.length},e}(),select=function(e,t){var n,r;return n=t?e:"string"==typeof e?[selectSingle(e,document)]:[e],r=new Selection(n),r.singleSelection=!t,r},hx.select=function(e){return e instanceof HTMLElement||e instanceof SVGElement||hx.isString(e)||e===document||e===window?select(e):(hx.consoleWarning("hx.select was passed the wrong argument type","hx.select only accepts a HTMLElement, SVGElement or string argument, you supplied:",e),new Selection([]))},hx.select.getHexagonElementDataObject=getHexagonElementDataObject,hx.select.addEventAugmenter=function(e){return augmenters.push(e)},hx.selectAll=function(e){return hx.isString(e)||hx.isArray(e)?hx.isArray(e)?select(e,!0):select(document).selectAll(e):(hx.consoleWarning("hx.selectAll was passed the wrong argument type","hx.selectAll only accepts a string argument, you supplied:",e),new Selection([]))},hx.detached=function(e,t){return t=namespaces.hasOwnProperty(e)?namespaces[e]:namespaces.xhtml,hx.select(document.createElementNS(t,e))},hx.Selection=Selection;})();(function(){var hx_ease,loopUpdate,next;next=hx.vendor(window,"requestAnimationFrame")||function(n){return setTimeout(n,17)},loopUpdate=function(n,e){return n()?void 0:next(e)},hx.loop=function(n){var e;return e=function(){return loopUpdate(n,e)},void loopUpdate(n,e)},hx.transition=function(n,e,t,o){var r,i;return null==t&&(t=hx.ease.linear),i=(new Date).getTime(),0>=n?(e(1,!1),o&&o(!1),hx.identity):(r=!1,hx.loop(function(){var u;return u=((new Date).getTime()-i)/n,u>=1||r?(e(1,r),o&&o(r),!0):(e(t(u),!1),!1)}),function(){return r=!0})},hx.ease=hx_ease={linear:hx.identity,quad:function(n){return n*n},cubic:function(n){return n*n*n}};})();(function(){var EventEmitter;EventEmitter=function(){function t(){this.callbacks=new hx.Map,this.allCallbacks=new hx.List}return t.prototype.emit=function(t,e){var i,s,n,l,a,r,c;if(this.callbacks.has(t))for(r=this.callbacks.get(t).entries(),s=0,l=r.length;l>s;s++)(i=r[s])(e);for(c=this.allCallbacks.entries(),n=0,a=c.length;a>n;n++)(i=c[n])(t,e);return this},t.prototype.on=function(t,e){return t?(this.callbacks.has(t)||this.callbacks.set(t,new hx.List),this.callbacks.get(t).add(e)):this.allCallbacks.add(e),this},t.prototype.hasNameRegistered=function(t){return this.callbacks.has(t)},t.prototype.has=function(t){return this.allCallbacks.size>0||this.callbacks.has(t)&&this.callbacks.get(t).size>0},t.prototype.off=function(t,e){var i;return e?t?null!=(i=this.callbacks.get(t))&&i.remove(e):this.allCallbacks.remove(e):t?this.callbacks.set(t,new hx.List):(this.callbacks=new hx.Map,this.allCallbacks=new hx.List),this},t.prototype.deregister=function(t,e){return this.off(t,e)},t.prototype.deregisterAll=function(t){return this.off(t)},t.prototype.pipe=function(t,e,i){var s;return s=i?function(t){return-1!==i.indexOf(t)}:function(t){return!0},e?this.on(null,function(i,n){return s(i)?t.emit(e+"."+i,n):void 0}):this.on(null,function(e,i){return s(e)?t.emit(e,i):void 0}),this},t}(),hx.EventEmitter=EventEmitter;})();(function(){var interpolateNumber,splitString;splitString=function(n){var r,t,e;for(e=new RegExp(/[-+]?(?:\d+\.?\d*|\.?\d+)|((?:[^-+\d])+|\D+)/g),t=[];null!==(r=e.exec(n));)t.push(isNaN(parseInt(r[0]))?r[0]:Number(r[0]));return t},interpolateNumber=function(n,r){return n=+n,r=+r,function(t){return n*(1-t)+r*t}},hx.interpolate=function(n,r){var t,e,i;return"number"==typeof n?interpolateNumber(n,r):(t=hx.color(n),e=hx.color(r),void 0!==t&&void 0!==e?function(n){return t.clone().mix(e,n).toString("rgba")}:(n=splitString(n),r=splitString(r),n.length===r.length?function(t){var e,i,o,u;for(e=[],i=o=0,u=n.length;u>=o;i=o+=1)e[i]=isNaN(parseInt(n[i]))||isNaN(parseInt(r[i]))?n[i]===r[i]?n[i]:r[i]:interpolateNumber(n[i],r[i])(t);return e.join("")}:(i=r.join(""),function(n){return i})))};})();(function(){var Animation,Morph,hx_morphs,__hasProp={}.hasOwnProperty,__extends=function(t,n){function e(){this.constructor=t}for(var r in n)__hasProp.call(n,r)&&(t[r]=n[r]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};Animation=function(t){function n(t,e){this.node=t,this.ease=null!=e?e:hx.ease.linear,n.__super__.constructor.apply(this,arguments),this.cancelers=[],this.remaining=0,this.finished=!1,this.endCallback=function(t){return function(n){return t.remaining--,t.remaining<=0&&!t.finished&&!n?(t.finished=!0,t.emit("end")):void 0}}(this)}var e;return __extends(n,t),e=function(t,n){return this.remaining++,this.cancelers.push(hx.transition(n,t,this.ease,this.endCallback)),this},n.prototype.style=function(t,n,r){var i,o;return this.node?4===arguments.length?(i=hx.interpolate(arguments[1],arguments[2]),o=function(n){return function(e,r){return r?void 0:n.node.style.setProperty(t,i(e))}}(this),e.call(this,o,arguments[3]||200)):(i=hx.interpolate(window.getComputedStyle(this.node,null).getPropertyValue(t),n),o=function(n){return function(e,r){return r?void 0:n.node.style.setProperty(t,i(e))}}(this),e.call(this,o,r||200)):this.endCallback(),this},n.prototype.attr=function(t,n,r){var i,o;return this.node?4===arguments.length?(i=hx.interpolate(arguments[1],arguments[2]),o=function(n){return function(e,r){return r?void 0:n.node.setAttribute(t,i(e))}}(this),e.call(this,o,arguments[3]||200)):(i=hx.interpolate(this.node.getAttribute(t),n),o=function(n){return function(e,r){return r?void 0:n.node.setAttribute(t,i(e))}}(this),e.call(this,o,r||200)):this.endCallback(),this},n.prototype.cancel=function(){var t,n,e,r;for(this.emit("cancelled"),r=this.cancelers,n=0,e=r.length;e>n;n++)(t=r[n])();return this},n}(hx.EventEmitter),hx.animate=function(t,n){return new Animation(t,n)},hx.Selection.prototype.animate=function(t){return hx.animate(this.nodes[0],t)},Morph=function(t){function n(t,r,i,o){this.node=t,this.trigger=r,n.__super__.constructor.apply(this,arguments),this.actions=[],this.start=i||function(t){return function(){return e.call(t)}}(this),this.cancelers=o||[],this.cancelled=!1,this.finished=!1,this.trigger&&this.trigger.on("end",function(t){return function(){return t.finished=!0,t.cancelled?void 0:e.call(t)}}(this))}var e;return __extends(n,t),n.prototype.and=function(t,n){var e;return null==n&&(n=200),hx.isFunction(t)?this.actions.push(t):this.node&&(e=hx_morphs.get(t),e?this.actions.push(function(t){return function(){return e(t.node,n)}}(this)):hx.consoleWarning(t+" is not a registered morph","The available morphs are",hx_morphs.entries())),this},n.prototype.then=function(t,e){return null==e&&(e=200),this.actions.length>0?new n(this.node,this,this.start,this.cancelers).and(t,e):this.and(t,e)},n.prototype.andStyle=function(t,n,e){var r;return null==e&&(e=200),r=arguments,this.and(4===r.length?function(t){return function(){return hx.animate(t.node).style(r[0],r[1],r[2],r[3])}}(this):function(r){return function(){return hx.animate(r.node).style(t,n,e)}}(this))},n.prototype.thenStyle=function(t,n,e){var r;return null==e&&(e=200),r=arguments,this.then(4===r.length?function(t){return function(){return hx.animate(t.node).style(r[0],r[1],r[2],r[3])}}(this):function(r){return function(){return hx.animate(r.node).style(t,n,e)}}(this))},n.prototype.andAttr=function(t,n,e){var r;return null==e&&(e=200),r=arguments,this.and(4===r.length?function(t){return function(){return hx.animate(t.node).attr(r[0],r[1],r[2],r[3])}}(this):function(r){return function(){return hx.animate(r.node).attr(t,n,e)}}(this))},n.prototype.thenAttr=function(t,n,e){var r;return null==e&&(e=200),r=arguments,this.then(4===r.length?function(t){return function(){return hx.animate(t.node).attr(r[0],r[1],r[2],r[3])}}(this):function(r){return function(){return hx.animate(r.node).attr(t,n,e)}}(this))},n.prototype["with"]=function(t,n){return this.then(t,n)},n.prototype.withStyle=function(t,n,e){var r;return r=arguments,this.then(4===r.length?function(t){return function(){return hx.animate(t.node).style(r[0],r[1],r[2],r[3])}}(this):function(r){return function(){return hx.animate(r.node).style(t,n,e)}}(this))},n.prototype.withAttr=function(t,n,e){var r;return r=arguments,this.then(4===r.length?function(t){return function(){return hx.animate(t.node).attr(r[0],r[1],r[2],r[3])}}(this):function(r){return function(){return hx.animate(r.node).attr(t,n,e)}}(this))},n.prototype.cancel=function(){var t,n,e,r;if(!this.cancelled)for(this.emit("cancelled"),this.cancelled=!0,r=this.cancelers,n=0,e=r.length;e>n;n++)t=r[n],hx.isFunction(t.cancel)&&t.cancel();return this},e=function(){var t,n,e,r,i,o,h,s;if(this.actions.length>0){for(n=this.actions.length,e=function(t){return function(){return n--,0===n?t.emit("end"):void 0}}(this),h=this.actions,s=[],i=0,o=h.length;o>i;i++)t=h[i],r=t(e),void 0!==r&&r.cancel&&this.cancelers.push(r),s.push(r instanceof hx.EventEmitter?r.on("end",e):0===t.length?e():void 0);return s}return this.emit("end")},n.prototype.go=function(t){var n;return t===!0&&this.cancelOngoing(),this.start(),this.node&&(n=hx.select.getHexagonElementDataObject(this.node,!0),null==n.morphs&&(n.morphs=[]),n.morphs=n.morphs.filter(function(t){return!t.cancelled&&!t.finished}),n.morphs.push(this)),this},n.prototype.cancelOngoing=function(){var t,n,e,r,i;if(this.node&&(n=hx.select.getHexagonElementDataObject(this.node,!1),n&&n.morphs)){for(i=n.morphs,e=0,r=i.length;r>e;e++)t=i[e],t.finished||t.cancelled||t.cancel();n.morphs=[]}return this},n}(hx.EventEmitter),hx.morph=function(t){return new Morph(t)},hx.Selection.prototype.morph=function(){return new Morph(this.nodes[0])},hx_morphs=new hx.Map,hx.morph.register=function(t,n){return hx_morphs.set(t,n)};})();(function(){hx.select.addEventAugmenter({name:"pointerdown",setup:function(e,t){return e.addEventListener("mousedown",function(e){return t.emit("pointerdown",{x:e.clientX,y:e.clientY,event:e})}),hx.supports("touch")?e.addEventListener("touchstart",function(e){return t.emit("pointerdown",{x:e.targetTouches[0].pageX,y:e.targetTouches[0].pageY,event:e})}):void 0}}),hx.select.addEventAugmenter({name:"pointermove",setup:function(e,t){return e.addEventListener("mousemove",function(e){return t.emit("pointermove",{x:e.clientX,y:e.clientY,event:e})}),hx.supports("touch")?e.addEventListener("touchmove",function(e){return t.emit("pointermove",{x:e.targetTouches[0].pageX,y:e.targetTouches[0].pageY,event:e})}):void 0}}),hx.select.addEventAugmenter({name:"pointerup",setup:function(e,t){return e.addEventListener("mouseup",function(e){return t.emit("pointerup",{x:e.clientX,y:e.clientY,event:e})}),hx.supports("touch")?(e.addEventListener("touchend",function(e){return t.emit("pointerup",{event:e})}),e.addEventListener("touchcancel",function(e){return t.emit("pointerup",{event:e})})):void 0}}),hx.select.addEventAugmenter({name:"pointerleave",setup:function(e,t){return e.addEventListener("mouseleave",function(e){return t.emit("pointerleave",{x:e.clientX,y:e.clientY,event:e})}),hx.supports("touch")?e.addEventListener("touchleave",function(e){return t.emit("pointerleave",{event:e})}):void 0}}),hx.select.addEventAugmenter({name:"pointerenter",setup:function(e,t){return e.addEventListener("mouseenter",function(e){return t.emit("pointerenter",{x:e.clientX,y:e.clientY,event:e})}),hx.supports("touch")?e.addEventListener("touchenter",function(e){return t.emit("pointerenter",{event:e})}):void 0}});})();(function(){var Delay,__bind=function(t,e){return function(){return t.apply(e,arguments)}},__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};hx.morph.register("fadeout",function(t,e){return null==e&&(e=100),hx.animate(t).style("opacity",0,e)}),hx.morph.register("fadein",function(t,e){return null==e&&(e=100),hx.animate(t).style("opacity",1,e)}),hx.morph.register("collapse",function(t,e){return null==e&&(e=100),hx.animate(t).style("height","0px",e).style("padding-top","0px",e).style("padding-bottom","0px",e).style("margin-top","0px",e).style("margin-bottom","0px",e).on("end",function(e){return hx.select(t).style("display","none").style("height","").style("padding-top","").style("padding-bottom","").style("margin-top","").style("margin-bottom","").style("opacity","")})}),hx.morph.register("expand",function(t,e){var n,r,o,i,s,l,a,p,y,m,u;return null==e&&(e=100),l=hx.select(t),a="none"===l.style("display")?"0px":l.style("height"),u="none"===l.style("display")?"0px":l.style("padding-top"),m="none"===l.style("display")?"0px":l.style("padding-bottom"),y="none"===l.style("display")?"0px":l.style("margin-top"),p="none"===l.style("display")?"0px":l.style("margin-bottom"),l.style("display",""),n=l.style("height","").style("height"),s=l.style("padding-top","").style("padding-top"),i=l.style("padding-bottom","").style("padding-bottom"),o=l.style("margin-top","").style("margin-top"),r=l.style("margin-bottom","").style("margin-bottom"),l.style("height",a).style("padding-top",u).style("padding-bottom",m).style("margin-top",y).style("margin-bottom",p).style("overflow","hidden"),hx.animate(t).style("height",n,e).style("padding-top",s,e).style("padding-bottom",i,e).style("margin-top",o,e).style("margin-bottom",r,e).on("end",function(t){return l.style("height","").style("padding-top","").style("padding-bottom","").style("margin-top","").style("margin-bottom","").style("overflow","")})}),hx.morph.register("expand-fadein",function(t,e){return null==e&&(e=100),hx.morph(t)["with"](function(){return hx.select(t).style("opacity",0)}).then("expand",e/2).then("fadein",e/2).go()}),hx.morph.register("fadeout-collapse",function(t,e){return null==e&&(e=100),hx.morph(t)["with"]("fadeout",e).and("collapse",e).go()}),hx.morph.register("rotate-90",function(t,e){return null==e&&(e=100),hx.animate(t).style("-webkit-transform","matrix(1, 0, 0, 1, 0, 0)","matrix(0, 1, -1, 0, 0, 0)",e).style("transform","matrix(1, 0, 0, 1, 0, 0)","matrix(0, 1, -1, 0, 0, 0)",e).on("end",function(){return hx.select(t).style("transform","").style("-webkit-transform","")}).on("cancel",function(){return hx.select(t).style("transform","").style("-webkit-transform","")})}),hx.morph.register("rotate-0",function(t,e){return null==e&&(e=100),hx.animate(t).style("-webkit-transform","matrix(0, 1, -1, 0, 0, 0)","matrix(1, 0, 0, 1, 0, 0)",e).style("transform","matrix(0, 1, -1, 0, 0, 0)","matrix(1, 0, 0, 1, 0, 0)",e).on("end",function(){return hx.select(t).style("transform","").style("-webkit-transform","")}).on("cancel",function(){return hx.select(t).style("transform","").style("-webkit-transform","")})}),Delay=function(t){function e(t){this.cancel=__bind(this.cancel,this),e.__super__.constructor.apply(this,arguments),this.timeout=setTimeout(function(t){return function(){return t.emit("end")}}(this),t)}return __extends(e,t),e.prototype.cancel=function(){return clearTimeout(this.timeout)},e}(hx.EventEmitter),hx.morph.register("delay",function(t,e){return null==e&&(e=100),new Delay(e)});})();(function(){var ClickDetector,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};ClickDetector=function(t){function e(){var t;e.__super__.constructor.apply(this,arguments),this.exceptions=new hx.List,t=void 0,this.downAction=function(e){return function(n){var o,i,r,c,s;for(n=n.event,t=n.target,o=!0,s=e.exceptions.entries(),r=0,c=s.length;c>r;r++)i=s[r],i.contains(n.target)&&(o=!1);return o?e.emit("click"):void 0}}(this),this.upAction=function(e){return function(n){var o,i,r,c,s;for(n=n.event,o=!0,t&&!t.contains(n.target)&&(o=!1),t=void 0,s=e.exceptions.entries(),r=0,c=s.length;c>r;r++)i=s[r],i.contains(n.target)&&(o=!1);return o?e.emit("click"):void 0}}(this),hx.select(document).on("pointerdown",this.downAction,!0),hx.select(document).on("pointerup",this.upAction,!0)}return __extends(e,t),e.prototype.addException=function(t){return this.exceptions.add(t)},e.prototype.removeAllExceptions=function(){return this.exceptions.clear()},e.prototype.cleanUp=function(){return hx.select(document).off("pointerdown",this.downAction),hx.select(document).off("pointerup",this.upAction)},e}(hx.EventEmitter),hx.ClickDetector=ClickDetector;})();(function(){var initToggleButtons;initToggleButtons=function(t){var e;return e=[],hx.selectAll(t).map(function(t){return t=hx.select(t),t.classed("hx-btn-toggle")?(e.push(t.node()),t.on("click",function(t){var e;return t=hx.select(t.target),e=t.classed("hx-btn-toggle-off"),t.attr("data",e).classed("hx-btn-toggle-off",!e)},!0).attr("data",t.classed("hx-btn-toggle-off")?!1:!0)):void 0}),e},hx.initialiseToggleButtons=initToggleButtons,initToggleButtons(".hx-btn-toggle");})();(function(){var Dropdown,checkFixedPos,checkParents,checkZIndex,__hasProp={}.hasOwnProperty,__extends=function(t,e){function i(){this.constructor=t}for(var n in e)__hasProp.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};checkFixedPos=function(t){var e;return e=hx.select(t),e.size()>0&&"fixed"===e.style("position")?!0:void 0},checkZIndex=function(t){var e,i;return e=hx.select(t),i=Number(e.style("z-index")),!isNaN(i)&&i>0?i:void 0},checkParents=function(t,e){var i,n;for(i=t;null!==i&&9!==i.nodeType;){if(n=e(i),null!=n)return n;i=i.parentNode}return!1},Dropdown=function(t){function e(t,i,n,o,s,r,h){var c;switch(this.selector=t,this.dropdownContent=i,null==n&&(n="click"),null==o&&(o="lblt"),this.spacing=s,this.matchWidth=null!=r?r:!0,this.ddClass=null!=h?h:"",e.__super__.constructor.apply(this,arguments),this.selection=hx.select(this.selector),this.visible=!1,this.dropdown=void 0,this.clickDetector=new hx.ClickDetector,this.useScroll=!1,c=function(){switch(o){case"up":return"ltlb";case"down":return"lblt";case"left":return"ltrt";case"right":return"rtlt";default:return o}}(),this.alignments=c.split(""),n){case"click":this.selection.on("click",function(t){return function(){return t.toggle()}}(this));break;case"hover":this.selection.on("mouseover",function(t){return function(){return t.show()}}(this)),this.selection.on("mouseout",function(t){return function(){return t.hide()}}(this)),this.selection.on("click",function(t){return function(){return t.toggle()}}(this))}}return __extends(e,t),e.prototype.toggle=function(){return this.isOpen()?this.hide():this.show()},e.prototype.show=function(){var t,e,i,n,o,s,r,h,c,d,l,p,a,u,w,f,g,x,m,y;if(f=null!=this.spacing?this.spacing:Number(hx.theme.dropdown.spacing),!this.dropdown){switch(!1){case!hx.isString(this.dropdownContent):this.dropdown=hx.select("body").append("div").attr("class","hx-dropdown"),this.dropdown.html(this.dropdownContent),this.clickDetector.removeAllExceptions(),this.clickDetector.addException(this.dropdown.node()),this.clickDetector.addException(this.selection.node());break;case!hx.isFunction(this.dropdownContent):this.dropdown=hx.select("body").append("div").attr("class","hx-dropdown"),l=this.dropdown.node(),this.dropdownContent(l),this.clickDetector.removeAllExceptions(),this.clickDetector.addException(l),this.clickDetector.addException(this.selection.node());break;default:console.error("hexagon: dropdownContent is not a valid type "+this.selector)}this.ddClass.length>0&&this.dropdown.classed(this.ddClass,!0)}if(this.clickDetector.on("click",function(t){return function(){return t.hide()}}(this)),!this.visible&&this.dropdown){if(a=checkParents(this.selection.node(),checkZIndex),a>0&&this.dropdown.style("z-index",a+1),u=this.selection.box(),this.dropdown.style("display","block"),this.matchWidth&&this.dropdown.style("min-width",u.width+"px"),o=this.dropdown.box(),n=this.dropdown.style("max-height").replace("px",""),r=u.left,x=u.top,"r"===this.alignments[0]&&(r=u.right),"b"===this.alignments[1]&&(x=u.bottom),"r"===this.alignments[2]&&(r-=o.width),"b"===this.alignments[3]&&(x-=o.height),this.alignments[0]!==this.alignments[2])switch(this.alignments[2]){case"l":r+=f;break;case"r":r-=f}if(this.alignments[1]!==this.alignments[3])switch(this.alignments[3]){case"t":x+=f;break;case"b":c=!0,x-=f}return w=window.scrollbars?16:0,0>r&&(r=0),(h=r+o.width-window.innerWidth+w)>0&&(r-=h),0>x&&(x=0),i=isNaN(n)?o.height:Math.min(n,o.height),(m=x+i-window.innerHeight)>0&&(d=!0,x-=m),e=function(t,e,i,n){var o,s,r;return o=i>t&&e>n,s=e>=n&&n>t&&t>=i,r=i>=t&&e>i&&n>=e,o||s?2:r?1:0},s=e(r,r+o.width,u.left,u.left+u.width),g=e(x,x+o.height,u.top,u.top+u.height),s>0&&g>0&&(g>1&&!d?(c=!1,x=u.top+u.height+f):(c=!0,x=u.top-o.height-f,0>x&&(c=!1,x=u.top+u.height+f))),p=checkParents(this.selection.node(),checkFixedPos),p?this.dropdown.style("position","fixed"):(x+=window.scrollY,r+=window.scrollX),y="top",c&&(y="bottom",t=document.body.scrollHeight-document.body.clientHeight,x=document.body.scrollHeight-x-t-o.height),this.dropdown.style("top","auto").style(y,x+"px").style("left",r+"px").style("width",o.width+"px"),this.dropdown.style("height","0px").style(y,x+8+"px").style("opacity",0).morph()["with"]("fadein",150).and("expand",150).and(function(t){return function(){return t.dropdown.animate().style(y,x+"px",150)}}(this)).then(function(t){return function(){return t.useScroll&&null!=t.dropdown?t.dropdown.style("overflow-y","auto"):void 0}}(this)).go(),this.visible=!0,this.emit("show"),this.emit("change",!0)}},e.prototype.hide=function(){return this.visible?(this.visible=!1,this.emit("hide"),this.emit("change",!1),this.dropdown.remove(),this.dropdown=void 0,this.clickDetector.off("click")):void 0},e.prototype.isOpen=function(){return this.visible},e.prototype.cleanUp=function(){return this.clickDetector.cleanUp()},e}(hx.EventEmitter),hx.Dropdown=Dropdown;})();(function(){var Collapsible,__hasProp={}.hasOwnProperty,__extends=function(e,t){function l(){this.constructor=e}for(var s in t)__hasProp.call(t,s)&&(e[s]=t[s]);return l.prototype=t.prototype,e.prototype=new l,e.__super__=t.prototype,e};Collapsible=function(e){function t(e,l,s,i){var o,n,h;this.lazyContent=l,null==s&&(s=!1),null==i&&(i=!0),t.__super__.constructor.apply(this,arguments),this.lazyContentCreated=!1,this.selection=hx.select(e).classed("hx-openable",!0).classed("hx-collapsible",!0),this.selection.classed("hx-collapseable")&&(hx.deprecatedWarning("the class hx-collapsable has been deprecated","use hx-collapsible instead",this.selection.node()),this.selection.select(".hx-collapseable-heading").classed("hx-collapsible-heading",!0),this.selection.select(".hx-collapseable-content").classed("hx-collapsible-content",!0),this.selection.select(".hx-collapseable-toggle").classed("hx-collapsible-toggle",!0)),n=this.selection.select(".hx-collapsible-heading"),(h=n.select(".hx-collapsible-toggle")).empty()?n.on("click",function(e){return function(){return e.toggle()}}(this),!0):(n.classed("hx-collapsible-heading-no-hover",!0),h.on("click",function(e){return function(){return e.toggle()}}(this),!0)),o=this.selection.select(".hx-collapsible-content").style("height",0).style("opacity",0),i&&(h.empty()?(n.select("i").remove(),n.prepend("i")["class"]("fa fa-chevron-right hx-collapsible-icon")):(h.select("i").remove(),h.prepend("i")["class"]("fa fa-chevron-right hx-collapsible-icon"))),hx.select.getHexagonElementDataObject(this.selection.node()).widget=this,this.visible=void 0,s?this.show(!1):this.hide(!1)}return __extends(t,e),t.prototype.toggle=function(e){return null==e&&(e=!0),this.isOpen()?this.hide(e):this.show(e)},t.prototype.show=function(e){var t;return null==e&&(e=!0),this.lazyContentCreated||(this.lazyContentCreated=!0,this.lazyContent&&this.lazyContent(this.selection.select(".hx-collapsible-content").node())),this.visible!==!0&&(this.selection.classed("hx-collapsible-expanded",!0).classed("hx-opened",!0),t=this.selection.select(".hx-collapsible-content"),e?(t.morph()["with"]("expand-fadein",200).go(!0),this.selection.select(".hx-collapsible-heading").select(".hx-collapsible-icon").morph()["with"]("rotate-90",200).go(!0)):t.style("display","").style("height","").style("opacity",""),this.visible=!0,this.emit("show"),this.emit("change",!0)),this},t.prototype.hide=function(e){return null==e&&(e=!0),this.visible!==!1&&(this.selection.classed("hx-collapsible-expanded",!1).classed("hx-opened",!1),e?(this.selection.select(".hx-collapsible-content").morph().then("fadeout-collapse",100).go(!0),this.selection.select(".hx-collapsible-heading").select(".hx-collapsible-icon").morph()["with"]("rotate-0",200).go(!0)):this.selection.select(".hx-collapsible-content").style("display","none"),this.visible=!1,this.emit("hide"),this.emit("change",!1)),this},t.prototype.isOpen=function(){return this.visible},t}(hx.EventEmitter),hx.Collapsible=Collapsible,hx.Collapseable=Collapsible,hx.initialiseCollapsibles=hx.initialiseCollapseables=function(e,t){return hx.selectAll(e).map(function(e){return new Collapsible(e,t)})};})();(function(){var collator,compare,hasCollator,localeCompare;hasCollator=null!=("undefined"!=typeof Intl&&null!==Intl?Intl.Collator:void 0),collator=hasCollator?new Intl.Collator(void 0,{numeric:!0}).compare:function(o,l){return l>o?-1:o>l?1:0},compare=function(o,l){return isNaN(Number(o))||isNaN(Number(l))?collator(o,l):o-l},localeCompare=function(o,l){var r;return null==l&&(l={numeric:!0}),r=hasCollator?new Intl.Collator(o,l).compare:function(r,a){return r.localeCompare(a,o,l)},function(o,l){return isNaN(Number(o))||isNaN(Number(l))?r(o,l):o-l}},hx.sort={compare:compare,localeCompare:localeCompare};})();(function(){var View;View=function(){function e(e,t,n){var l;this.rootSelection=e,this.selector=t,this.defaultType=n,l=this,this["new"]=function(e){return"."===l.selector.charAt(0)?this.append(l.defaultType)["class"](l.selector.substring(1)).node():this.append(l.defaultType).node()},this.each=function(e,t){},this.old=function(e,t){return this.remove()}}return e.prototype.enter=function(e){return this["new"]=e,this},e.prototype.exit=function(e){return this.old=e,this},e.prototype.update=function(e){return this.each=e,this},e.prototype.apply=function(e,t){var n,l,o,h,s,a,i,u,r,c,m,d,p,f,g,x,w,y,v,b,S,j,D,E,H,O,A,T,V;if(0!==this.rootSelection.size()){if(e instanceof Array||(e=[e]),h=[],f=[],s=[],p=this.rootSelection.selectAll(this.selector).nodes,t){for(m=new hx.Map,l=new hx.Map,g=0,v=e.length;v>g;g++)o=e[g],u=t(o),l.set(u,o);for(x=0,b=p.length;b>x;x++)c=p[x],d=hx.select.getHexagonElementDataObject(c),d.datum?(n=d.datum,u=t(n),m.has(u)?s.push({element:c,datum:n}):(m.set(u,c),l.has(u)?(o=l.get(u),l["delete"](u),f.push({element:c,datum:o})):s.push({element:c,datum:n}))):s.push({element:c,datum:void 0});h=function(){var e,t,o,h;for(o=l.entries(),h=[],e=0,t=o.length;t>e;e++)n=o[e],h.push({datum:n[1]});return h}()}else{for(a=0,w=0,S=p.length;S>w;w++)c=p[w],a<e.length?(d=hx.select.getHexagonElementDataObject(c),d.datum=e[a],f.push({element:c,datum:e[a]})):(d=hx.select.getHexagonElementDataObject(c,!1),s.push({element:c,datum:d.datum})),a++;if(a<e.length)for(i=y=a,T=e.length-1;T>=a?T>=y:y>=T;i=T>=a?++y:--y)h.push({datum:e[i]})}for(r=function(){var e,t,l;for(l=[],a=t=0,e=h.length;e>t;a=++t)n=h[a],l.push({element:this["new"].call(this.rootSelection,n.datum,a),datum:n.datum});return l}.call(this),H=0,j=r.length;j>H;H++)n=r[H],hx.select.getHexagonElementDataObject(n.element).datum=n.datum;for(a=O=0,D=s.length;D>O;a=++O)n=s[a],this.old.call(hx.select(n.element),n.datum,n.element,a);for(V=f.concat(r),a=A=0,E=V.length;E>A;a=++A)n=V[a],this.each.call(hx.select(n.element),n.datum,n.element,a);return this}},e}(),hx.Selection.prototype.view=function(e,t){return null==t&&(t="div"),0===this.size()&&hx.consoleWarning(".view() called on an empty selection"),new View(this,e,t)};})();(function(){var formatExp,formatFixed,formatRound,formatSI,precision,roundPrecision,siSuffixes,strictCheck,zeroPad;siSuffixes=["y","z","a","f","p","n","Âµ","","","K","M","G","T","P","E","Z","Y"],zeroPad=function(t,r){var n,o,i;return n=t.toString(),n.length<r?(o=r-n.length,function(){var t,r,n;for(n=[],i=t=0,r=o-1;r>=0?r>=t:t>=r;i=r>=0?++t:--t)n.push("0");return n}().join("")+n):n},precision=function(t){return t?Math.floor(Math.log(Math.abs(t))/Math.LN10):1},roundPrecision=function(t,r,n){return n>=0?Math.round(t/Math.pow(r,n))*Math.pow(r,n):Math.round(t*Math.pow(r,-n))/Math.pow(r,-n)},formatRound=function(t,r){var n;return isNaN(t)?"NaN":(n=precision(t)-r+1,roundPrecision(t,10,n).toString())},formatSI=function(t,r){var n,o,i,a;return isNaN(t)?"NaN":(n=Math.min(precision(t),26),i=siSuffixes[Math.min(Math.max(0,Math.floor(8+n/3)),16)],a=Math.abs(t)<1&&n%3&&!(n>-3&&0>n)?1e3:1,-3===n&&(a=1e3,i=siSuffixes[6]),o=Math.pow(10,n-n%3)/a,formatRound(t/o,r)+i)},formatExp=function(t,r){var n;return isNaN(t)?"NaN":(n=precision(t),formatRound(t/Math.pow(10,n),r)+"e"+n)},formatFixed=function(t,r){return isNaN(t)?"NaN":t.toFixed(r)},strictCheck=function(t,r,n){return n?function(n){return t(n,r)}:function(n){return hx.isString(n)?n:t(n,r)}},hx.format={round:function(t,r){return strictCheck(formatRound,t,r)},si:function(t,r){return strictCheck(formatSI,t,r)},exp:function(t,r){return strictCheck(formatExp,t,r)},fixed:function(t,r){return strictCheck(formatFixed,t,r)},zeroPad:function(t,r){return strictCheck(zeroPad,t,r)}};})();(function(){var NumberPicker,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var r in e)__hasProp.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};NumberPicker=function(t){function e(t,n){var r,u,a;this.selector=t,null==n&&(n=""),e.__super__.constructor.apply(this,arguments),u=hx.select(this.selector),a=u["class"]("hx-number-picker"),r=a.append("button")["class"]("hx-btn "+n),r.append("i")["class"]("fa fa-chevron-up"),r.on("click",function(t){return function(){return t.increment()}}(this)),this.selectInput=a.append("input"),this.selectInput.attr("type","number"),this.selectInput.on("blur",function(t){return function(){return null==t.selectInput.attr("readonly")&&t.selectInput.attr("data-value",t.selectInput.value()),t.emit("input-change",{value:t.getValue()}),t.emit("change",{value:t.getValue()})}}(this)),r=a.append("button")["class"]("hx-btn "+n),r.append("i")["class"]("fa fa-chevron-down"),r.on("click",function(t){return function(){return t.decrement()}}(this))}return __extends(e,t),e.prototype.getValue=function(){return Number(this.selectInput.attr("data-value"))},e.prototype.setValue=function(t,e){return e&&isNaN(e)?this.selectInput.attr("type","text").attr("readonly",""):this.selectInput.attr("type","number").node().removeAttribute("readonly"),this.selectInput.value(e||t),this.selectInput.attr("data-value",t),this.emit("change",{value:t})},e.prototype.increment=function(){return this.setValue(this.getValue()+1),this.emit("increment")},e.prototype.decrement=function(){return this.setValue(this.getValue()-1),this.emit("decrement")},e}(hx.EventEmitter),hx.NumberPicker=NumberPicker;})();(function(){var Menu,MenuItem,checkEvent,dealWithEvent,dropdownContent,getAllItems,moveSelectionDown,moveSelectionUp,setActive,toggleCollapseable,__hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var o in t)__hasProp.call(t,o)&&(e[o]=t[o]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};dropdownContent=function(e,t){return function(n){var o;return o=hx.select(n).view(".hx-menu-item").update(function(e,t){return e.build(t)}).apply(e()),t?t.addException(n):void 0}},getAllItems=function(e){var t,n;return t=[],n=function(e,o){return e.forEach(function(e,i){return e.parentIndex=o,t.push(e),e.items?n(e.items,i):void 0})},n(e.items),t},setActive=function(e,t,n,o){var i,l,r,s,c,u,d,a,h,p,m,v,f,x,w,b,g,y,k;if(null!=(b=e.dropdown.dropdown)&&b.selectAll(".hx-menu-item").classed("hx-menu-active",!1),t>=0){for(i=getAllItems(e),m=i[t].node,r=null!=(g=i[t])?g.content:void 0,d=!(null!=r?r.disabled:void 0)&&!(null!=r?r.unselectable:void 0);!(null!==m.offsetParent&&d||o);){if(n?t-=1:t+=1,r=null!=(y=i[t])?y.content:void 0,d=!(null!=r?r.disabled:void 0)&&!(null!=r?r.unselectable:void 0),null==i[t]){u=!0;break}m=i[t].node}if(u&&!n)return void setActive(e,t-1,!0);e.cursorPos=t,null==(s=null!=(k=e.dropdown.dropdown)?k.node():void 0)||o||(p=hx.select(m).classed("hx-menu-active",!0),h=p.node(),v=h.offsetTop,l=p.select(".hx-menu-collapsible"),a=l.size()>0?l.node().clientHeight:h.clientHeight,f=hx.select(h.parentNode),x=f.classed("hx-collapsible-content")?f.node().offsetTop:0,w=v+a+x,c=w>s.clientHeight?w-s.clientHeight:0,s.scrollTop=c)}return e.has("select")?e.emit("select",{content:null!=i?i[e.cursorPos]:void 0,index:e.cursorPos,click:o,type:o?"click":""}):void 0},moveSelectionUp=function(e){var t;return t=e.cursorPos,t>0?t-=1:0===t&&(t=-1),e.cursorPos=t,setActive(e,t,!0)},moveSelectionDown=function(e){var t,n;return n=e.cursorPos,t=getAllItems(e),n<t.length-1&&(n+=1),e.cursorPos=n,setActive(e,n)},toggleCollapseable=function(e,t){switch(t){case!0:return e.show();case!1:return e.hide();default:return e.toggle()}},dealWithEvent=function(e,t,n){var o,i,l,r;return null==n&&(n="enter"),i="tab"===n?Math.max(e.cursorPos,0):e.cursorPos,o=getAllItems(e),l=o[i],null==t||t||null==(null!=l&&null!=(r=l.parent)?r.collapsible:void 0)?null!=(null!=l?l.collapsible:void 0)?toggleCollapseable(l.collapsible,t):null!=t&&t||null==t?e.emit("select",{type:n,content:l}):void 0:(toggleCollapseable(l.parent.collapsible,t),setTimeout(function(){return moveSelectionUp(e)},200))},checkEvent=function(e,t){switch(e.which){case 9:dealWithEvent(t,void 0,"tab");break;case 13:e.preventDefault(),dealWithEvent(t,void 0);break;case 37:dealWithEvent(t,!1);break;case 38:e.preventDefault(),moveSelectionUp(t);break;case 39:dealWithEvent(t,!0);break;case 40:e.preventDefault(),moveSelectionDown(t)}return t.emit("input",e)},MenuItem=function(){function e(e,t,n){this.content=e,this.parent=t,this.menu=n,this.items=[],this.dropdown=void 0}return e.prototype.build=function(e){var t,n,o,i;return this.node=e,e=hx.select(e),this.items.length>0?(e.view(".hx-collapsible").apply(this),t=e.select(".hx-collapsible"),t.view(".hx-collapsible-heading").apply(this),t.view(".hx-collapsible-content").update(function(){return this.style("display","none")}).apply(this),this.menu.colorClass&&t.classed(this.menu.colorClass,!0),o=t.select(".hx-collapsible-heading").classed("hx-menu-collapsible",!0).node(),n=e.select(".hx-collapsible-content").node(),this.menu.renderer(o,this.content),this.collapsible=new hx.Collapsible(t.node()),dropdownContent(function(e){return function(){return e.items}}(this))(n)):(i=!this.content.unselectable&&!this.content.disabled,e.classed("hx-menu-link",i).classed("hx-menu-item-disabled",this.content.disabled).classed("hx-menu-unselectable",this.content.unselectable),this.menu.renderer(e.node(),this.content))},e.prototype.addItem=function(t){var n;return n=new e(t,this,this.menu),this.items.push(n),n},e.prototype.addItems=function(e){var t,n,o,i;for(i=[],n=0,o=e.length;o>n;n++)t=e[n],i.push(this.addItem(t));return i},e.prototype.clearItems=function(){return this.items=[]},e.prototype.addException=function(e){return this.dropdown.clickDetector.addException(e),this.parent.addException(e)},e}(),Menu=function(e){function t(e,o,i,l){var r,s,c,u,d,a,h;if(this.selector=e,null==i&&(i="click"),t.__super__.constructor.apply(this,arguments),this.items=[],c=hx.select(this.selector),!l)for(l="",a=0,h=n.length;h>a;a++)r=n[a],c.classed(r)&&(this.colorClass=r);null!=this.colorClass&&(l=l+" "+this.colorClass),l="hx-menu "+l,this.dropdown=new hx.Dropdown(this.selector,"",i,o,void 0,!0,l),this.dropdown.dropdownContent=dropdownContent(function(e){return function(){return e.items}}(this)),u=this,"input"===c.node().nodeName.toLowerCase()&&(s=!0,d=c),this.dropdown.on("show",function(){return u.cursorPos=-1,s||(d=u.dropdown.dropdown,d.attr("tabindex","-1"),d.node().focus()),d.on("keydown",function(e){return u.dropdown.isOpen()&&checkEvent(e,u),u.emit("keydown",e)}),u.dropdown.dropdown.on("click",function(e){var t,n,o,i,l;if(l=hx.select(e.target).closest(".hx-menu-item").node(),null==l&&(l=e.target),o=-1,i=hx.select(l),i.classed("hx-menu-link")){for(t=getAllItems(u),n=0;0>o;){if(t[n].node===l){o=n;break}n+=1}setActive(u,o,void 0,!0)}return d.node().focus()})}),this.dropdown.pipe(this)}var n;return __extends(t,e),n=["hx-positive","hx-warning","hx-negative","hx-info","hx-compliment","hx-contrast"],t.prototype.renderer=function(e,t){return hx.select(e).html(t).on("click",function(e){return function(){return e.emit("select",t)}}(this))},t.prototype.addItem=function(e){var t;return t=new MenuItem(e,this,this),this.items.push(t),t},t.prototype.addItems=function(e){var t,n,o,i;for(i=[],n=0,o=e.length;o>n;n++)t=e[n],i.push(this.addItem(t));return i},t.prototype.addException=function(e){return this.dropdown.clickDetector.addException(e)},t.prototype.clearItems=function(){return this.items=[]},t.prototype.hide=function(){return this.dropdown.hide()},t.prototype.render=function(e){var t;return t=function(e,n){var o,i,l,r,s;for(s=[],l=0,r=e.length;r>l;l++)o=e[l],i=n.addItem(o),s.push(o.children?t(o.children,i):void 0);return s},this.clearItems(),t(e,this)},t}(hx.EventEmitter),hx.Menu=Menu;})();(function(){var buildFilter,filterCaseModifier,filterDefaults,filterMatch;filterDefaults={caseSensitive:!1,searchValues:void 0,sort:!0},filterCaseModifier=function(r){return r?function(r){return r}:function(r){return r.toLowerCase()}},filterMatch=function(r,e,t){var n,i,u,l,o,f;if(u=0,i=!1,null!=t.searchValues)for(f=t.searchValues(r),l=0,o=f.length;o>l;l++)n=f[l],u+=t.lookup(t.caseModifier(n.toString())),u>-1&&(i=!0);else u+=t.lookup(t.caseModifier(r.toString()));return e===!0?u:i||u>-1?!0:!1},buildFilter=function(r){return function(e,t,n){return null==n&&(n={}),n=hx.merge({},filterDefaults,n),n.caseModifier=filterCaseModifier(n.caseSensitive),"string"==typeof t&&(t=n.caseModifier(t)),n.lookup=r(t),e=e.filter(function(r){return filterMatch(r,!1,n)}),n.sort===!0&&(e=e.sort(function(r,e){var t,i,u,l,o,f,a,c;if(i=filterMatch(r,!0,n),l=filterMatch(e,!0,n),i>l)return 1;if(l>i)return-1;if(null!=n.searchValues){for(f=0,t=n.searchValues(r),u=n.searchValues(e),o=a=0,c=t.length;c>a&&(f=hx.sort.compare(t[o],u[o]),0===f);o=a+=1);return f}return hx.sort.compare(r,e)})),e}},hx.filter={exact:buildFilter(function(r){return function(e){return e===r?r.length:-1}}),startsWith:buildFilter(function(r){return function(e){return hx.startsWith(e,r)?r.length:-1}}),contains:buildFilter(function(r){return function(e){var t;return t=e.indexOf(r),t>-1?t+r.length:-1}}),excludes:buildFilter(function(r){return function(e){var t;return t=e.indexOf(r),-1===t?r.length:-1}}),greater:buildFilter(function(r){return function(e){var t;return t=hx.sort.compare(e,r),-1!==t?t:-1}}),less:buildFilter(function(r){return function(e){var t;return t=hx.sort.compare(r,e),-1!==t?t:-1}}),fuzzy:buildFilter(function(r){var e,t;return t="("+r.split("").join(").*?(")+").*?",e=new RegExp(t),function(r){var t;return t=r.match(e),null!=t?t.index+t[0].length:-1}}),regex:buildFilter(function(r){return function(e){var t;return t=e.match(r),null!=t?t.index+t[0].length:-1}})};})();(function(){var DatePicker,DatePickerFeed,DatePickerMomentFeed,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var a in e)__hasProp.call(e,a)&&(t[a]=e[a]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};DatePickerMomentFeed=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.selectedDate1=moment().hour(0).minute(0).seconds(0).millisecond(0),this.selectedDate2=moment().hour(0).minute(0).seconds(0).millisecond(0),this.locale=moment.locale(),this.year=this.getYear(),this.month=this.getMonth(),this.momentDate=moment(new Date(this.year,this.month))}return __extends(e,t),e.prototype.setDate=function(t,e){var n,a,s;return a=moment(t),null!=e?(s=this.getWhichDate(!0),n=this.getWhichDate(!1),this.selectedDate1=s,this.selectedDate2=n,e?(this.selectedDate1=a,this.selectedDate2=a):this.selectedDate2=a):this.selectedDate1=a,void this.emit("change")},e.prototype.showMonth=function(t,e){return this.momentDate=moment(new Date(e,t)),this.month=this.momentDate.month(),this.year=this.momentDate.year(),void this.emit("calendarChange")},e.prototype.showNextMonth=function(){return this.showMonth(this.month+1,this.year)},e.prototype.showPrevMonth=function(){return this.showMonth(this.month-1,this.year)},e.prototype.setDay=function(t){return this.selectedDate1.date(t),void this.emit("change")},e.prototype.setMonth=function(t){return this.selectedDate1.month(t),void this.emit("change")},e.prototype.setYear=function(t){return this.selectedDate1.year(t),void this.emit("change")},e.prototype.addDays=function(t,e){return this.setDay(this.getDay(e)+t)},e.prototype.addMonths=function(t,e){return this.setMonth(this.getMonth(e)+t)},e.prototype.addYears=function(t,e){return this.setYear(this.getYear(e)+t)},e.prototype.getDate=function(t){return this.getWhichDate(t).toDate()},e.prototype.getWhichDate=function(t){var e;return e=null!=t&&t?this.selectedDate1.isBefore(this.selectedDate2)?this.selectedDate1:this.selectedDate2:null==t||t?this.selectedDate1:this.selectedDate1.isAfter(this.selectedDate2)?this.selectedDate1:this.selectedDate2},e.prototype.getDay=function(t){return this.getWhichDate(t).date()},e.prototype.getMonth=function(t){return this.getWhichDate(t).month()},e.prototype.getYear=function(t){return this.getWhichDate(t).year()},e.prototype.getScreenDate=function(t,e){var n,a;return n=this.getWhichDate(e),n.locale(this.locale),a=n.format(t?"":"L")},e.prototype.getDayNames=function(){var t,e,n;if(this.locale!==this.oldLocale||null==this.dayNames){for(t=moment("2015-01-11T12:00:00Z"),t.locale(this.locale),this.dayNames=[t.format("dd")],e=n=0;6>n;e=++n)this.dayNames.push(t.add(1,"d").format("dd"));this.oldLocale=this.locale}return this.dayNames},e.prototype.getMonthName=function(){return this.momentDate.locale(this.locale).format("MMMM")},e.prototype.getYearName=function(){return this.momentDate.locale(this.locale).format("YYYY")},e.prototype.getCalendarDays=function(){var t,e,n,a,s,r,i,o;if(t=moment({year:this.year,month:this.month,day:1}),t.locale(this.locale),r=t.isoWeekday(),n=t.daysInMonth(),s=[],i=[],r%7!==0)for(a=o=0;r>=0?r>o:o>r;a=r>=0?++o:--o)i.push(void 0);for(a=0;31>=a&&(a+=1,e=t.date(a),i.push({screenDay:e.format("D"),day:a}),(i.length>6||a===n)&&(s.push(i),i=[]),a!==n););return s},e.prototype.getPickerOrder=function(){var t,e,n,a,s,r,i,o,h;for(t=moment({year:2003,month:11,day:22}).locale(this.locale),e=t.format("L"),i=e.indexOf(t.format("YYYY")),s=e.indexOf(t.format("MM")),n=e.indexOf(t.format("DD")),r=[],a=o=0,h=e.length;h>=0?h>=o:o>=h;a=h>=0?++o:--o)switch(a){case i:r.push("YYYY");break;case s:r.push("MM");break;case n:r.push("DD")}return 0===r.length&&(r=["DD","MM","YYYY"]),r},e.prototype.getCount=function(){return Math.abs(this.selectedDate1.diff(this.selectedDate2,"days"))+1},e.prototype.dateFromString=function(t){var e,n,a,s,r,i,o,h,c,u,d,l;if(o=t.split("/"),e=!o.some(function(t){return""===t||"0"===t})){for(a="",l=this.getPickerOrder(),s=u=0,d=l.length;d>u;s=++u)switch(h=l[s],i=o[s],h){case"DD":n=i.length<3&&""!==i,a+="DD";break;case"MM":r=i.length<3&&""!==i,a+="MM";break;case"YYYY":c=i.length<5&&""!==i,a+="YYYY"}return n&&r&&c?moment(t,a,this.locale).toDate():new Date("Invalid Date")}return new Date("Invalid Date")},e.prototype.isSelectedDay=function(t,e,n,a){return this.getYear(a)===t&&this.getMonth(a)===e&&this.getDay(a)===n},e.prototype.isBetweenDays=function(t,e,n){var a,s,r;return r=moment({year:t,month:e,day:n}),s=this.getWhichDate(!0),a=this.getWhichDate(!1),r.isBefore(a)&&r.isAfter(s)},e.prototype.isToday=function(t,e,n){var a;return a=moment().hour(0).minute(0).seconds(0).millisecond(0),moment({year:t,month:e,day:n}).isSame(a)},e.prototype.update=function(t){return this.locale=null!=t&&t?t===!0?this.locale:t:moment.locale(),this.momentDate.locale(this.locale),this.selectedDate1.locale(this.locale),void this.selectedDate2.locale(this.locale)},e}(hx.EventEmitter),DatePickerFeed=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"],this.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],this.selectedDate1=new Date,this.selectedDate1.setHours(0,0,0,0),this.selectedDate2=new Date,this.selectedDate2.setHours(0,0,0,0),this.year=this.selectedDate1.getFullYear(),this.month=this.selectedDate1.getMonth()}var n;return __extends(e,t),e.prototype.setDate=function(t,e){var n,a;return null!=e?(a=this.getWhichDate(!0),n=this.getWhichDate(!1),this.selectedDate1=a,this.selectedDate2=n,e?(this.selectedDate1=t,this.selectedDate2=t):this.selectedDate2=t):(this.selectedDate1=t,this.selectedDate2=t),void this.emit("change")},e.prototype.showMonth=function(t,e){var n;return n=new Date(e,t),this.month=n.getMonth(),this.year=n.getFullYear(),void this.emit("calendarChange")},e.prototype.showNextMonth=function(){return this.showMonth(this.month+1,this.year)},e.prototype.showPrevMonth=function(){return this.showMonth(this.month-1,this.year)},e.prototype.setDay=function(t){return this.selectedDate1.setDate(t),void this.emit("change")},e.prototype.setMonth=function(t){return this.selectedDate1.setMonth(t),void this.emit("change")},e.prototype.setYear=function(t){return this.selectedDate1.setFullYear(t),void this.emit("change")},e.prototype.addDays=function(t,e){return this.setDay(this.getDay(e)+t)},e.prototype.addMonths=function(t,e){return this.setMonth(this.getMonth(e)+t)},e.prototype.addYears=function(t,e){return this.setYear(this.getYear(e)+t)},e.prototype.getDate=function(t){return this.getWhichDate(t)},e.prototype.getWhichDate=function(t){var e;return e=null!=t&&t?this.selectedDate1<this.selectedDate2?this.selectedDate1:this.selectedDate2:null==t||t?this.selectedDate1:this.selectedDate2<this.selectedDate1?this.selectedDate1:this.selectedDate2},e.prototype.getDay=function(t){return this.getWhichDate(t).getDate()},e.prototype.getMonth=function(t){return this.getWhichDate(t).getMonth()},e.prototype.getYear=function(t){return this.getWhichDate(t).getFullYear()},n=hx.format.zeroPad(2),e.prototype.getScreenDate=function(t,e){var a,s;return s=function(t){return t.split("/").map(function(t){return n(t)}).join("/")},a=t?this.getYear(e)+"-"+n(this.getMonth(e)+1)+"-"+n(this.getDay(e)):s(this.getWhichDate(e).toLocaleDateString())},e.prototype.getDayNames=function(){return this.dayNames},e.prototype.getMonthName=function(){return this.monthNames[this.month]},e.prototype.getYearName=function(){return this.year},e.prototype.getCalendarDays=function(){var t,e,n,a,s,r,i,o;for(s=new Date(this.year,this.month).getDay(),e=new Date(this.year,this.month+1,0).getDate(),a=[],a.push(s>0?function(){var t,e,n;for(n=[],r=t=0,e=s-1;e>=0?e>=t:t>=e;r=e>=0?++t:--t)n.push(void 0);return n}().concat(function(){i=[];for(var t=1,e=7-s;e>=1?e>=t:t>=e;e>=1?t++:t--)i.push(t);return i}.apply(this)):[1,2,3,4,5,6,7]),n=1-s;e>n;)n+=7,t=Math.min(n+6,e),t>=n&&a.push(function(){o=[];for(var e=n;t>=n?t>=e:e>=t;t>=n?e++:e--)o.push(e);return o}.apply(this));return a},e.prototype.getPickerOrder=function(){var t,e,n,a,s,r,i,o,h;for(t=new Date(2003,5,1),e=t.toLocaleDateString(),i=e.indexOf(t.getFullYear()),s=e.indexOf(t.getMonth()+1),n=e.indexOf(t.getDate()),r=[],a=o=0,h=e.length;h>=0?h>=o:o>=h;a=h>=0?++o:--o)switch(a){case i:r.push("YYYY");break;case s:r.push("MM");break;case n:r.push("DD")}return 0===r.length&&(r=["DD","MM","YYYY"]),r},e.prototype.getCount=function(){var t,e,n;return n=864e5,t=this.getWhichDate(!0)-this.getWhichDate(!1),e=Math.round(Math.abs(t/n)),e+1},e.prototype.dateFromString=function(t){var e,n,a,s,r,i,o,h,c,u,d,l,p,f,D;if(c=t.split("/"),e=!c.some(function(t){return""===t||"0"===t})){for(s="",D=this.getPickerOrder(),r=p=0,f=D.length;f>p;r=++p)switch(u=D[r],h=c[r],u){case"DD":a=h.length<3&&""!==h,n=c[r];break;case"MM":o=h.length<3&&""!==h,i=c[r];break;case"YYYY":l=h.length<5&&""!==h,d=c[r]}return a&&o&&l?new Date(d,i,n):new Date("Invalid Date")}return new Date("Invalid Date")},e.prototype.isSelectedDay=function(t,e,n,a){return this.getYear(a)===t&&this.getMonth(a)===e&&this.getDay(a)===n},e.prototype.isBetweenDays=function(t,e,n){var a,s,r;return r=new Date(t,e,n),s=this.getWhichDate(!0),a=this.getWhichDate(!1),a>r&&r>s},e.prototype.isToday=function(t,e,n){var a,s;return s=new Date,a=new Date(t,e,n),a.setHours(0,0,0,0)===s.setHours(0,0,0,0)},e.prototype.update=function(){return void 0},e}(hx.EventEmitter),DatePicker=function(t){function e(t,r,i,o){var h,c,u,d,l,p,f,D,y,g,m,v,M;this.selector=t,this.type=null!=r?r:"calendar",this.closeOnSelect=null!=i?i:!0,this.selectRange=null!=o?o:!1,e.__super__.constructor.apply(this,arguments),M=this._={},y=this,this.selectRange&&(this.type="calendar"),M.feed="undefined"!=typeof moment&&null!==moment?new DatePickerMomentFeed:new DatePickerFeed,M.feed.on("calendarChange",function(t){return function(e){return n.call(t)}}(this)).on("change",function(t){return function(e){return t.preventFeedback?void 0:(t.preventFeedback=!0,t.selectRange?(t.inputStart.classed("hx-date-error",!1),t.inputEnd.classed("hx-date-error",!1)):t.input.classed("hx-date-error",!1),t.dontSetupInput||s.call(t),t.supressCallback||t.emit("change"),t.dontSetupInput=!1,t.supressCallback=!1,t.preventFeedback=!1,"calendar"===t.type?n.call(t):a.call(t))}}(this)),this.supressCallback=!1,M.clickStart=void 0,this.selection=hx.select(this.selector).classed("hx-date-picker",!0),f=this.selection.append("div")["class"]("hx-date-input-container"),p=f.append("i")["class"]("fa fa-calendar"),this.selectRange?(this.useInbuilt=!1,m=function(t){var e,n,a,s;return y.supressCallback?void 0:(e=M.feed.dateFromString(y.inputStart.value()),n=M.feed.dateFromString(y.inputEnd.value()),t&&e>n?(e=n,y.inputStart.value(y.inputEnd.value())):!t&&e>n&&(n=e,y.inputEnd.value(y.inputStart.value())),s=e.getTime(),a=n.getTime(),s&&a?(y.setRange(e,n,!0),y.showMonth(e.getMonth(),e.getFullYear())):(y.inputStart.classed("hx-date-error",!s),y.inputEnd.classed("hx-date-error",!a)))},this.inputStart=f.append("input")["class"]("hx-date-input").on("input",function(){return m(!1)}),f.append("i")["class"]("hx-date-to-icon fa fa-angle-double-right"),this.inputEnd=f.append("input")["class"]("hx-date-input").on("input",function(){return m(!0)})):(this.input=f.append("input")["class"]("hx-date-input").on("input",function(t){return function(e){var n;return y.supressCallback?void 0:(n=M.feed.dateFromString(e.target.value),n.getTime()?(y.setDate(n,!0),y.showMonth(n.getMonth(),n.getFullYear())):t.input.classed("hx-date-error",!0))}}(this)),this.useInbuilt=hx.supports("date")&&hx.supports("touch"),this.useInbuilt&&this.input.attr("type","date")),s.call(this),"calendar"===this.type?(c=hx.detached("div"),c["class"]("hx-datepicker-calendar"),u=c.append("div")["class"]("hx-calendar-month-header"),this.monthNameHeader=u.append("div")["class"]("hx-month"),u.append("div")["class"]("hx-divider").text(" / "),this.yearHeader=u.append("div")["class"]("hx-year"),h=u.append("div")["class"]("hx-calendar-month-back").on("click",function(){return M.feed.showPrevMonth()}).append("i")["class"]("fa fa-chevron-left"),l=u.append("div")["class"]("hx-calendar-month-forward").on("click",function(){return M.feed.showNextMonth()}).append("i")["class"]("fa fa-chevron-right"),this.calendarTable=c.append("table")["class"]("hx-calendar").append("tbody"),this.calendarHeaderView=this.calendarTable.append("tr").view("th","th").enter(function(t){return this.append("th").text(t).node()}).update(function(t){return this.text(t).node()}),g=function(t){return function(e){var a;return a=hx.select(e),a.append(c),n.call(t,!0)}}(this)):"datepicker"===this.type&&(d=hx.detached("div").node(),D=hx.detached("div").node(),v=hx.detached("div").node(),this.dayPicker=new hx.NumberPicker(d).on("change",function(t){return function(e){return t.supressCallback?void 0:M.feed.setDay(e.value)}}(this)),this.monthPicker=new hx.NumberPicker(D).on("change",function(t){return function(e){return t.supressCallback?void 0:M.feed.setMonth(e.value-1)}}(this)),this.yearPicker=new hx.NumberPicker(v).on("change",function(t){return function(e){return t.supressCallback?void 0:M.feed.setYear(e.value)}}(this)),this.dayPicker.selectInput.attr("tabindex",1),this.monthPicker.selectInput.attr("tabindex",2),this.yearPicker.selectInput.attr("tabindex",3),g=function(t){return function(e){var n,s,r,i,o;for(s=hx.select(e),o=M.feed.getPickerOrder(),r=0,i=o.length;i>r;r++)switch(n=o[r]){case"DD":s.append(d);break;case"MM":s.append(D);break;case"YYYY":s.append(v)}return a.call(t,!0)}}(this)),this.useInbuilt||(this.dropdown=new hx.Dropdown(this.selector,g,"click","down",void 0,!1))}var n,a,s,r;return __extends(e,t),r=function(t,e,n,a){var r,i;return i=this._.feed,r=this,hx.select(t).view(".hx-day").enter(function(t){var e;return e=this.append("td")["class"]("hx-day"),r.selectRange&&e.append("div")["class"]("hx-day-range-bg"),e.append("div")["class"]("hx-day-text"),e.node()}).update(function(t){var e,o,h,c,u;return null!=t&&isNaN(t)?(e=t.day,u=t.screenDay):(e=t,u=t),this.classed("hx-day-today",i.isToday(a,n,e)),r.selectRange?(c=i.isSelectedDay(a,n,e,!0),o=i.isSelectedDay(a,n,e,!1),h=i.isBetweenDays(a,n,e),this.classed("hx-selected-date",c||o).classed("hx-selected-date-start",c).classed("hx-selected-date-range",h).classed("hx-selected-date-end",o)):this.classed("hx-selected-date",i.isSelectedDay(a,n,e)),this.classed("hx-out-of-month",null==e).on("click",function(o){return function(){return r._.clickStart=r.selectRange?!r._.clickStart:void 0,null!=t&&i.setDate(new Date(a,n,e),r._.clickStart),s.call(r),(r.selectRange&&!r._.clickStart||!r.selectRange)&&r.closeOnSelect?r.hideDropdown():void 0}}(this)),this.select(".hx-day-text").text(u||"")}).apply(e)},s=function(){return this.selectRange?(this.inputStart.value(this._.feed.getScreenDate(!1,!0)),this.inputEnd.value(this._.feed.getScreenDate(!1,!1))):this.input.value(this._.feed.getScreenDate(this.useInbuilt))},n=function(t){var e,n,a,s,i,o;return this.useInbuilt||!this.dropdown.isOpen()&&!t?void 0:(o=this._.feed,s=this,i=o.year,n=o.month,a=o.getMonthName(),this.monthNameHeader.text(a),this.yearHeader.text(o.getYearName()),e=o.getCalendarDays(),this.calendarTable.view(".hx-week","tr").update(function(t,e){return r.call(s,e,t,n,i)}).apply(e),this.calendarHeaderView.apply(o.getDayNames()))},a=function(t){var e,n,a,s,r,i,o,h;if(!this.useInbuilt&&(this.dropdown.isOpen()||t)){for(r=this._.feed,n=r.getDate(),this.supressCallback=!0,e=r.getScreenDate().split("/"),h=r.getPickerOrder(),a=i=0,o=h.length;o>i;a=++i)switch(s=h[a]){case"DD":this.dayPicker.setValue(n.getDate(),e[a]);break;case"MM":this.monthPicker.setValue(n.getMonth()+1,e[a]);break;case"YYYY":this.yearPicker.setValue(n.getFullYear(),e[a])}return this.supressCallback=!1}},e.prototype.showDropdown=function(){return this.useInbuilt?void 0:this.dropdown.show()},e.prototype.hideDropdown=function(){return this.useInbuilt?void 0:this.dropdown.hide()},e.prototype.setDate=function(t,e,n){return this.dontSetupInput=null!=e?e:!1,this.supressCallback=null!=n?n:!1,this._.feed.setDate(t)},e.prototype.setRange=function(t,e,n,a){return null==n&&(n=!1),this.supressCallback=null!=a?a:!1,this.selectRange?(this.dontSetupInput=n,this._.feed.setDate(t,!0),this.dontSetupInput=n,this._.feed.setDate(e,!1)):void 0},e.prototype.showMonth=function(t,e){return this._.feed.showMonth(t,e)},e.prototype.setDay=function(t,e){return this.supressCallback=null!=e?e:!1,this._.feed.setDay(t)},e.prototype.setMonth=function(t,e){return this.supressCallback=null!=e?e:!1,this._.feed.setMonth(t)},e.prototype.setYear=function(t,e){return this.supressCallback=null!=e?e:!1,this._.feed.setYear(t)},e.prototype.addDays=function(t){return this._.feed.addDays(t)},e.prototype.addMonths=function(t){return this._.feed.addMonths(t)},e.prototype.addYears=function(t){return this._.feed.addYears(t)},e.prototype.getRange=function(){return{start:this._.feed.getDate(!0),end:this._.feed.getDate(!1),count:this._.feed.getCount()}},e.prototype.getDate=function(t){return this._.feed.getDate(!t)},e.prototype.getScreenDate=function(t){return this._.feed.getScreenDate(!t)},e.prototype.update=function(t){return this._.feed.update(t),s.call(this),"calendar"===this.type?n.call(this,!0):a.call(this,!0),void(this.dropdown.isOpen()&&(this.dropdown.hide(),this.dropdown.show()))},e}(hx.EventEmitter),hx.DatePicker=DatePicker;})();(function(){var TimePicker,TimePickerFeed,TimePickerMomentFeed,zeroPad,__hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var s in t)__hasProp.call(t,s)&&(e[s]=t[s]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};zeroPad=function(e){return e=e.toString(),1===e.length?"0"+e:e},TimePickerMomentFeed=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.selectedDate=moment().millisecond(0),this.locale=moment.locale()}return __extends(t,e),t.prototype.setDate=function(e,t){var n;return t?this.selectedDate=moment(e):(n=moment(e),this.selectedDate.date(n.date()).month(n.month()).year(n.year())),void this.emit("change",this.selectedDate.toDate())},t.prototype.setHour=function(e){return this.selectedDate.hours(e),void this.emit("change",this.selectedDate.toDate())},t.prototype.setMinute=function(e){return this.selectedDate.minutes(e),void this.emit("change",this.selectedDate.toDate())},t.prototype.setSecond=function(e){return this.selectedDate.seconds(e),void this.emit("change",this.selectedDate.toDate())},t.prototype.addHours=function(e){return this.selectedDate.add(e,"hours")},t.prototype.addMinutes=function(e){return this.selectedDate.add(e,"minutes")},t.prototype.addSeconds=function(e){return this.selectedDate.add(e,"seconds")},t.prototype.getDate=function(){return this.selectedDate.toDate()},t.prototype.getHour=function(){return this.selectedDate.hour()},t.prototype.getMinute=function(){return this.selectedDate.minute()},t.prototype.getSecond=function(){return this.selectedDate.second()},t.prototype.getScreenTime=function(e){var t;return t=e?"H:mm:ss":"H:mm",this.selectedDate.format(t)},t.prototype.update=function(){return this.locale=moment.locale(),void this.selectedDate.locale(this.locale)},t.prototype.checkTime=function(e){return moment({hours:e[0],minutes:e[1],seconds:e[2]}).isValid()},t}(hx.EventEmitter),TimePickerFeed=function(e){function t(){t.__super__.constructor.apply(this,arguments),this.selectedDate=new Date,this.selectedDate.setMilliseconds(0)}return __extends(t,e),t.prototype.setDate=function(e,t){return t?this.selectedDate=e:(e.setHours(this.getHour(),this.getMinute(),this.getSecond(),0),this.selectedDate=e),void this.emit("change",this.selectedDate)},t.prototype.setHour=function(e){return this.selectedDate.setHours(e),void this.emit("change",this.selectedDate)},t.prototype.setMinute=function(e){return this.selectedDate.setMinutes(e),void this.emit("change",this.selectedDate)},t.prototype.setSecond=function(e){return this.selectedDate.setSeconds(e),void this.emit("change",this.selectedDate)},t.prototype.addHours=function(e){return this.setHour(this.getHour()+e)},t.prototype.addMinutes=function(e){return this.setMinute(this.getMinute()+e)},t.prototype.addSeconds=function(e){return this.setSeconds(this.getSecond()+e)},t.prototype.getDate=function(){return this.selectedDate},t.prototype.getHour=function(){return this.selectedDate.getHours()},t.prototype.getMinute=function(){return this.selectedDate.getMinutes()},t.prototype.getSecond=function(){return this.selectedDate.getSeconds()},t.prototype.getScreenTime=function(e){var t;return t=this.selectedDate.getHours()+":"+zeroPad(this.selectedDate.getMinutes()),e&&(t+=":"+zeroPad(this.selectedDate.getSeconds())),t},t.prototype.checkTime=function(e){return!isNaN(e[0])&&!isNaN(e[1])&&!isNaN(e[2])},t}(hx.EventEmitter),TimePicker=function(e){function t(e,i,o){var r,c,u,d,a,h,p;this.selector=e,this.showSeconds=i,t.__super__.constructor.apply(this,arguments),p=this._={},p.feed="undefined"!=typeof moment&&null!==moment?new TimePickerMomentFeed:new TimePickerFeed,p.feed.on("change",function(e){return function(t){return e.preventFeedback?void 0:(e.preventFeedback=!0,e.input.classed("hx-time-error",!1),e.dontSetupInput||n.call(e),e.supressCallback||e.emit("change"),e.dontSetupInput=!1,e.supressCallback=!1,e.preventFeedback=!1,s.call(e))}}(this)),this.supressCallback=!1,this.selection=hx.select(this.selector).classed("hx-time-picker",!0),u=this.selection.append("div")["class"]("hx-time-input-container"),c=u.append("i")["class"]("fa fa-clock-o"),this.input=u.append("input")["class"]("hx-time-input"),this.input.on("input",function(e){return function(t){var n;return e.supressCallback?void 0:(n=t.target.value.split(":"),null==n[2]&&(n[2]=0),p.feed.checkTime(n)?(p.feed.setHour(n[0]),p.feed.setMinute(n[1]),p.feed.setSecond(n[2]||0)):e.input.classed("hx-time-error",!0))}}(this)),n.call(this),r=hx.detached("div").node(),d=hx.detached("div").node(),a=hx.detached("div").node(),this.hourPicker=new hx.NumberPicker(r,o).on("change",function(e){return function(t){return e.supressCallback?void 0:p.feed.setHour(t.value)}}(this)),this.hourPicker.selectInput.attr("tabindex",1).attr("maxlength","2"),this.minutePicker=new hx.NumberPicker(d,o).on("change",function(e){return function(t){return e.supressCallback?void 0:p.feed.setMinute(t.value)}}(this)),this.minutePicker.selectInput.attr("tabindex",2).attr("maxlength","2"),this.secondPicker=new hx.NumberPicker(a,o).on("change",function(e){return function(t){return e.supressCallback?void 0:p.feed.setSecond(t.value)}}(this)),this.secondPicker.selectInput.attr("tabindex",3).attr("maxlength","2"),h=function(e){return function(t){var n;return n=hx.select(t),n.append(r),n.append(d),e.showSeconds&&n.append(a),s.call(e,!0)}}(this),this.dropdown=new hx.Dropdown(this.selector,h,"click","down",void 0,null,"hx-time-picker-dropdown")}var n,s;return __extends(t,e),s=function(e){var t,n;return this.dropdown.isOpen()||e?(n=this._.feed,this.supressCallback=!0,t=this.getScreenTime(!0).split(":"),this.hourPicker.setValue(n.getHour(),t[0]),this.minutePicker.setValue(zeroPad(n.getMinute()),t[1]),this.secondPicker.setValue(zeroPad(n.getSecond()),t[2]),this.supressCallback=!1):void 0},n=function(){return this.input.classed("hx-short-time",!this.showSeconds),this.input.value(this._.feed.getScreenTime(this.showSeconds))},t.prototype.setDate=function(e,t,n){return null==t&&(t=!1),null==n&&(n=!1),this.supressCallback=n,this._.feed.setDate(e,t)},t.prototype.setHour=function(e,t){return null==t&&(t=!1),this.supressCallback=t,this._.feed.setHour(e)},t.prototype.setMinute=function(e,t){return null==t&&(t=!1),this.supressCallback=t,this._.feed.setMinute(e)},t.prototype.setSecond=function(e,t){return null==t&&(t=!1),this.supressCallback=t,this._.feed.setSecond(e)},t.prototype.addHours=function(e){return this._.feed.addHours(e)},t.prototype.addMinutes=function(e){return this._.feed.addMinutes(e)},t.prototype.addSeconds=function(e){return this._.feed.addSeconds(e)},t.prototype.getDate=function(){return this._.feed.getDate()},t.prototype.getHour=function(){return this._.feed.getHour()},t.prototype.getMinute=function(){return this._.feed.getMinute()},t.prototype.getSecond=function(){return this._.feed.getSecond()},t.prototype.getScreenTime=function(){return this._.feed.getScreenTime(this.showSeconds)},t.prototype.update=function(){return this._.feed.update(),n.call(this),s.call(this,!0)},t}(hx.EventEmitter),hx.TimePicker=TimePicker;})();(function(){var hasResponse,hx_xhr,performRequest,reshapedRequest,respondToRequest,sendRequest;hasResponse=function(e){var t;return t=e.responseType,t&&"text"!==t?e.response:e.responseText},respondToRequest=function(e,t,r,n,s,o){var u,a,i,p;if(p=e.status,i=null!=r?{url:t,data:r}:t,!p&&hasResponse(e)||p>=200&&300>p||304===p){try{a=s.formatter(e)}catch(h){return u=h,void n(u,void 0,i,o)}n(void 0,a,i,o)}else n(e,void 0,i,o)},sendRequest=function(e,t,r,n){var s,o,u,a;e.open(n.requestType,t,!0),a=n.headers;for(s in a)u=a[s],e.setRequestHeader(s,u);return e.responseType=n.responseType||n.contentType||void 0,e.overrideMimeType(e.responseType),o=null!=r&&"string"!=typeof r?JSON.stringify(r):r,e.send(o)},performRequest=function(e,t,r,n,s){var o,u,a,i,p;return null==t&&(t=null),null==n&&(n={}),o={requestType:"GET",formatter:hx.identity,headers:{}},n=hx.merge(!0,o,n),n.contentType&&(null==(i=n.headers)["Content-Type"]&&(i["Content-Type"]=n.contentType),null==(p=n.headers).accept&&(p.accept=n.contentType+",*/*")),"GET"===n.requestType&&t&&(n.requestType="POST"),u=new XMLHttpRequest,"withCredentials"in u||void 0===typeof XDomainRequest||!/^(http(s)?:)?\/\//.test(e)||(u=new XDomainRequest),a=function(){return respondToRequest(u,e,t,r,n,s)},"onload"in u?u.onload=u.onerror=a:u.onreadystatechange=function(){u.readyState>3&&a()},sendRequest(u,e,t,n)},hx_xhr=function(e,t,r,n,s){var o,u,a,i,p,h,c;if("array"===e){for(a=[],o=function(e,r,s,o){var u,i;return a[o]={data:r,source:s},n(e,r,s,o),a.filter(function(e){return void 0!==e}).length===t.length?(i=a.map(function(e){return e.source}),u=a.map(function(e){return e.data}),n(e,u,i,-1)):void 0},c=[],u=p=0,h=t.length;h>p;u=++p)i=t[u],hx.isObject(i)&&(r=i.data||r,i=i.url),c.push(performRequest(i,r,o,s,u));return c}return"object"===e?(r=t.data||r,i=t.url):i=t,performRequest(i,r,n,s)},hx.request=hx.xhr=function(){var e,t,r,n,s;return s=arguments[0],n=function(){switch(!1){case!hx.isArray(s):return"array";case!hx.isObject(s):return"object";case!hx.isString(s):return"string"}}(),!n||"array"===n&&0===s.length?void console.error("Incorrect URL passed into hx.xhr: ",s):(hx.isFunction(arguments[1])?(e=arguments[1],r=arguments[2]):(t=arguments[1],e=arguments[2],r=arguments[3]),hx_xhr(n,s,t||null,e,r))},reshapedRequest=function(e,t,r){var n,s,o,u,a;return a=e[0],hx.isFunction(e[1])?(n=e[1],u=e[2]):(s=e[1],n=e[2],u=e[3]),o={contentType:t,formatter:r},u=hx.merge(!0,o,u),hx.xhr(a,s,n,u)},hx.json=function(){return reshapedRequest(arguments,"application/json",function(e){return e.responseText?JSON.parse(e.responseText):void 0})},hx.html=function(){return reshapedRequest(arguments,"text/html",function(e){return hx.parseHTML(e.responseText)})};})();(function(){var TagInput,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};TagInput=function(t){function e(t,n,i){var r;this.selector=t,this.classifier=n,this.validator=i,e.__super__.constructor.apply(this,arguments),this.selection=hx.select(this.selector),this.tagContainer=this.selection.append("span")["class"]("hx-tags-container"),this.selection.classed("hx-tag-input",!0).classed("hx-input-group",!0),this.form=this.selection.append("form"),this.input=this.form.append("input").attr("placeholder","add tag..."),r=!1,this.form.on("keypress",function(t){return function(e){var n;return 13===e.keyCode&&t.form.node().checkValidity()&&(e.preventDefault(),n=t.input.value())?(t.add(n,void 0,!0),t.emit("add",{value:n,type:"user"}),t.input.value("")):void 0}}(this)),this.input.on("input",function(t){return function(){var e,n;return n=t.input.value(),t.validator?(e=t.validator(n),t.input.node().setCustomValidity(e||"")):""===n?t.input.node().setCustomValidity(""):void 0}}(this)),this.input.on("keydown",function(t){return function(e){var n,i,o;return 8===(e.keyCode||e.charCode)&&!r&&(r=!0,t.input.node().setCustomValidity(""),""===t.input.value()&&(i=t.tagContainer.selectAll(".hx-tag"),i.size()>0))?(n=hx.select(i.node(i.size()-1)),o=n.text(),n.remove(),t.emit("remove",{value:o,type:"user"})):void 0}}(this)),this.input.on("keyup",function(t){return 8===(t.keyCode||t.charCode)?(r=!1,!0):void 0})}return __extends(e,t),e.prototype.add=function(t,e,n){var i,r,o,a,s,u;if(hx.isArray(t)){for(u=[],a=0,s=t.length;s>a;a++)r=t[a],u.push(this.add(r,e,n));return u}return o=this.tagContainer.append("span").text(t),o["class"](e?"hx-tag "+e:"hx-tag"),this.classifier&&(i=this.classifier(t),i&&o.classed(i,!0)),o.on("click",function(t){return function(){var e;return e=o.text(),o.remove(),t.emit("remove",{value:e,type:"user"})}}(this)),n?void 0:this.emit("add",{value:t,type:"api"})},e.prototype.remove=function(t){return this.tagContainer.selectAll(".hx-tag").filter(function(e){return hx.select(e).text()===t}).each(function(t){return function(e){return t.emit("remove",{value:hx.select(e).text(),type:"api"})}}(this)).remove().length},e.prototype.removeAll=function(){var t,e;return t=this.tagContainer.selectAll(".hx-tag").each(function(t){return function(e){return t.emit("remove",{value:hx.select(e).text(),type:"api"})}}(this)),e=t.text(),t.remove(),e},e.prototype.tags=function(){return this.tagContainer.selectAll(".hx-tag").text()},e}(hx.EventEmitter),hx.TagInput=TagInput;})();(function(){var Modal,makeButtons,modal_dialog,modal_input,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Modal=function(t){function e(t,n,o){this.title=t,this.setup=n,this.isClosable=null!=o?o:!0,e.__super__.constructor.apply(this,arguments),this.contentContainer=null}var n;return __extends(e,t),n=function(t,e){var n;return n=hx.select("body").classed("hx-modal-open",!1),n.select(".hx-modal-container").remove(),n.select(".hx-modal-shade").remove(),t.emit("close",e)},e.prototype.show=function(){var t,e,o,a,s;return t=hx.select("body").classed("hx-modal-open",!0),a=t.select(".hx-modal-shade"),a.empty()&&(a=t.append("div").attr("class","hx-modal-shade"),a.style("opacity",0).morph()["with"]("fadein",150).go()),o=t.select(".hx-modal-container"),o.empty()&&(o=t.append("div").attr("class","hx-modal-container")),e=o.select(".hx-modal"),e.empty()&&(e=o.append("div").attr("class","hx-modal")),s=e.append("div").attr("class","hx-modal-title").text(this.title),this.isClosable&&(s.append("button")["class"]("hx-modal-close hx-btn").html('<i class="fa fa-times"></i>').on("click",function(t){return function(){return n(t,{cause:"button"})}}(this)),o.on("click",function(t){return function(o){return e.node().contains(o.target)?void 0:n(t,{cause:"shade"})}}(this))),this.contentContainer=e.append("div").attr("class","hx-modal-content"),this.setup&&this.setup(this.contentContainer.node()),e.style("opacity",0).style("top","-30px").morph()["with"]("fadein",150).and(function(){return e.animate().style("top","0px",100)}).go(),this.emit("open",this.contentContainer.node()),this},e.prototype.close=function(){return n(this,{cause:"api"})},e}(hx.EventEmitter),makeButtons=function(t,e,n,o){return void e.forEach(function(e){return t.append("button")["class"](e.classes).html('<i class="'+e.icon+'"></i> '+e.text).on("click",function(){return o(e.value),n.close()})})},modal_dialog=function(t,e,n,o,a){var s,i;return null==a&&(a=!1),i=function(t){var a,s;return null==o&&(o=[{text:"Cancel",icon:"fa fa-times",value:!1,classes:"hx-btn hx-negative"},{text:"Confirm",icon:"fa fa-check",value:!0,classes:"hx-btn hx-positive"}]),s=hx.select(t),e=s.append("div")["class"]("hx-modal-message").text(e),a=s.append("div")["class"]("hx-modal-buttons"),makeButtons(a,o,this,n)},s=new Modal(t,i,a),s.on("close",function(t){return"api"!==t.cause?n():void 0}),s.show()},modal_input=function(t,e,n,o){var a,s;return null==o&&(o=!0),s=function(t){var o,a,s,i;return a=[{text:"Cancel",icon:"fa fa-times",value:!1,classes:"hx-btn hx-negative"},{text:"Confirm",icon:"fa fa-check",value:!0,classes:"hx-btn hx-positive"}],s=hx.select(t),e=s.append("span")["class"]("hx-modal-message").text(e),i=s.append("input")["class"]("hx-modal-input").text(i),o=s.append("div")["class"]("hx-modal-buttons"),makeButtons(o,a,this,function(t){return n(t?i.value():t)})},a=new Modal(t,s),a.on("close",function(t){return"api"!==t.cause?n():void 0}),a.show()},hx.Modal=Modal,hx.modal={dialog:modal_dialog,input:modal_input};})();(function(){var Notification,NotificationManager,inbuiltNotificationManager;Notification=function(){function t(t,i,n,o,e){this.manager=t,this.message=i,this.icon=n,this.cssclass=o,this.pinned=e,this.domPin=hx.detached("i").attr("class","hx-notification-pin fa fa-thumb-tack").on("click",function(t){return function(){return t.togglePin()}}(this)),this.id=this.manager.nextId(),this.updatePinnedStatus()}return t.prototype.startTimeout=function(t){return this.timeoutId=window.setTimeout(function(t){return function(){return t.close()}}(this),1e3*t)},t.prototype.close=function(){return this.manager.removeNotification(this)},t.prototype.pin=function(){return this.pinned=!0,window.clearTimeout(this.timeoutId),this.updatePinnedStatus()},t.prototype.unpin=function(){return this.pinned=!1,this.startTimeout(1),this.updatePinnedStatus()},t.prototype.togglePin=function(){return this.pinned?this.unpin():this.pin()},t.prototype.updatePinnedStatus=function(){return this.domPin.classed("hx-notification-pin-pinned",this.pinned)},t}(),NotificationManager=function(){function t(t){null==t&&(t="body"),this.currentId=0,this.notifications=[],this.notificationContainer=hx.select(t).append("div").attr("class","hx-notification-container")}var i,n;return n=function(t,i){return i.append("i").attr("class","hx-notification-icon "+t.icon),i.append("div").attr("class","hx-notification-text").text(t.message),i.append("i").attr("class","hx-notification-close fa fa-times").on("click",function(){return t.close()}),i.append(t.domPin)},t.prototype.nextId=function(){return this.currentId++},t.prototype.redraw=function(){var t;return t=this.notificationContainer.view(".hx-notification"),t.enter(function(t){var i;return i=this.append("div"),i.attr("class","hx-notification "+t.cssclass).each(function(o){return n(t,i),t.trueHeight=i.style("height")}).style("opacity",0).style("height",0).style("padding-top",0).style("padding-bottom",0).style("margin-top",0).style("margin-bottom",0).morph()["with"]("expand").and("fadein").then(function(){return i.style("height","")}).go(),i.node()}),t.exit(function(){return this.style("overflow","hidden").morph()["with"]("fadeout",100).then("collapse",100).then(function(t){return function(){return t.remove()}}(this)).go()}),t.apply(this.notifications,function(t){return t.id})},t.prototype.removeNotification=function(t){var i;return i=this.notifications.indexOf(t),i>=0&&this.notifications.splice(i,1),this.redraw()},i=function(t,i,n,o,e){var a;return a=new Notification(t,i,n,o,e),t.notifications.push(a),t.redraw(),a},t.prototype.permanent=function(t,n,o){return null==n&&(n=""),null==o&&(o=""),i(this,t,n,o,!0)},t.prototype.temporary=function(t,n,o,e){var a;return null==n&&(n=""),null==o&&(o=""),null==e&&(e=5),a=i(this,t,n,o,!1),a.startTimeout(e),a},t.prototype.info=function(t,i){return null==i&&(i=5),this.temporary(t,"fa fa-info","hx-notification-info",i)},t.prototype.warning=function(t,i){return null==i&&(i=5),this.temporary(t,"fa fa-warning","hx-notification-warning",i)},t.prototype.error=function(t,i){return null==i&&(i=5),hx.deprecatedWarning("NotificationManager.error","use .negative(message, timeout) instead"),this.temporary(t,"fa fa-exclamation-circle","hx-notification-negative",i)},t.prototype.negative=function(t,i){return null==i&&(i=5),this.temporary(t,"fa fa-exclamation-circle","hx-notification-negative",i)},t.prototype.positive=function(t,i){return null==i&&(i=5),this.temporary(t,"fa fa-check","hx-notification-positive",i)},t.prototype.loading=function(t){return this.permanent(t,"hx-spinner","hx-notification-loading")},t}(),hx.NotificationManager=NotificationManager,inbuiltNotificationManager=void 0,hx.getNotificationManager=function(){return inbuiltNotificationManager||(inbuiltNotificationManager=new NotificationManager),inbuiltNotificationManager},hx.notify=hx.getNotificationManager;})();(function(){var Slider,sliderRefresh,__hasProp={}.hasOwnProperty,__extends=function(e,t){function n(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};sliderRefresh=function(e){switch(e.type){case"slider":return e.setValue(e.getValue());case"range":return e.setRangeStartValue(e.getRangeStartValue()),e.setRangeEndValue(e.getRangeEndValue())}},Slider=function(e){function t(e,r,s){switch(this.type=null!=r?r:"slider",this.render=s,t.__super__.constructor.apply(this,arguments),this.container=hx.select(e).classed("hx-slider",!0),this.value=.5,this.rangeStartValue=.25,this.rangeEndValue=.75,null==this.render&&(this.render=function(e,t,n,r,i){return hx.select(t).text(hx.format.fixed(2)(n))}),this.type){case"slider":this.slider=this.container.append("div").attr("class","hx-slider-slider").style("left",0).on("mousedown",function(e){return function(t){return i(e,t.clientX,e.setValue,e.getValue,e.slider,1,void 0)}}(this)).on("touchstart",function(e){return function(t){return i(e,t.touches[0].pageX,e.setValue,e.getValue,e.slider,1,void 0)}}(this)),this.render(this,this.slider.node(),this.value,!1);break;case"range":this.range=this.container.append("div").attr("class","hx-slider-range").style("left",0).style("width",0),this.slider1=this.container.append("div").attr("class","hx-slider-slider hx-slider-slider-left").style("left",0).on("mousedown",function(e){return function(t){return i(e,t.clientX,function(t){return e.setRangeStartValue(Math.min(e.rangeEndValue,t))},function(){return e.rangeStartValue},e.slider1,2,"range-start")}}(this)).on("touchstart",function(e){return function(t){return i(e,t.touches[0].pageX,function(t){return e.setRangeStartValue(Math.min(e.rangeEndValue,t))},function(){return e.rangeStartValue},e.slider1,2,"range-start")}}(this)),this.render(this,this.slider1.node(),this.rangeEndValue,!1,!0),this.slider2=this.container.append("div").attr("class","hx-slider-slider hx-slider-slider-right").style("left",0).on("mousedown",function(e){return function(t){return i(e,t.clientX+n(e),function(t){return e.setRangeEndValue(Math.max(e.rangeStartValue,t))},function(){return e.rangeEndValue},e.slider2,2,"range-end")}}(this)).on("touchstart",function(e){return function(t){return i(e,t.touches[0].pageX+n(e),function(t){return e.setRangeEndValue(Math.max(e.rangeStartValue,t))},function(){return e.rangeEndValue},e.slider2,2,"range-end")}}(this)),this.render(this,this.slider2.node(),this.rangeStartValue,!1,!1)}this.offsetX=0,this.mouseDown=!1,hx.select(document).on("pointermove",function(e){return function(t){var n,r,i;return n=t.event,e.mouseDown?(i=t.x+e.offsetX,r=e.selectedWidth(),e.selectedSetValue(i/r),e.emit("slide",{value:e.getValue()}),n.preventDefault()):void 0}}(this),!0),hx.select(document).on("pointerup",function(e){return function(t){return e.mouseDown?(e.mouseDown=!1,e.emit("slideend",{value:e.getValue()})):void 0}}(this),!0),sliderRefresh(this)}var n,r,i;return __extends(t,e),r=function(e,t,n,r,i,s){switch(null==i&&(i=0),t.style("left",i+n*r+"px"),e.type){case"slider":return e.emit("change",{value:n}),e.render(e,t.node(),n,!0);case"range":return e.emit("change",{startValue:e.getRangeStartValue(),endValue:e.getRangeEndValue()}),e.render(e,t.node(),n,!0,s)}},i=function(e,t,r,i,s,a,u){var l;return e.mouseDown=!0,e.offsetX=s.box().left-e.container.box().left-t,l={value:i()},u&&(l.type=u),e.emit("slidestart",l),e.selectedSetValue=r,e.selectedWidth=function(){return this.container.width()-n(this)*a}},n=function(e){switch(e.type){case"slider":return e.slider.width();case"range":return e.slider2.width()}},t.prototype.setValue=function(e){var t;return"slider"===this.type&&(this.value=hx.clampUnit(e),t=this.container.width()-n(this),r(this,this.slider,this.value,t)),this},t.prototype.getValue=function(){return this.value},t.prototype.setRangeStartValue=function(e){var t,i;return"range"===this.type&&(this.rangeStartValue=hx.clampUnit(e),i=n(this),t=this.container.width()-2*i,r(this,this.slider1,this.rangeStartValue,t,0,!0),this.range.style("left",t*this.rangeStartValue+i+"px"),this.range.style("width",t*(this.rangeEndValue-this.rangeStartValue)+"px")),this},t.prototype.setRangeEndValue=function(e){var t,i;return"range"===this.type&&(this.rangeEndValue=hx.clampUnit(e),i=n(this),t=this.container.width()-2*i,r(this,this.slider2,this.rangeEndValue,t,i,!1),this.range.style("width",t*(this.rangeEndValue-this.rangeStartValue)+"px")),this},t.prototype.getRangeStartValue=function(){return this.rangeStartValue},t.prototype.getRangeEndValue=function(){return this.rangeEndValue},t}(hx.EventEmitter),hx.Slider=Slider;})();(function(){var AutoComplete,buildAutoComplete,findTerm,showAutoComplete,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};findTerm=function(t,e){var n,o,i,l,s,u,r,a,h;return a=this,h=this._,null==h.prevTerm&&(h.prevTerm=""),n=h.data.get(t),t.length>=h.prevTerm.length&&null==n&&(n=h.data.get(h.prevTerm)),null==n&&(n=h.data.get("")),h.prevTerm=t,l="external"===this.options.matchType?n:0!==t.length||this.options.showAll?this.options.filter(n,t):[],i=n.length===l.length&&n.length>0,!this.options.showOtherResults||e||i||(u=l.length>0?l:[{unselectable:!0,text:a.options.noResultsMessage}],s=[{unselectable:!0,heading:!0,text:a.options.otherResultsMessage}],r=s.concat(0===l.length?n:(o=n.filter(function(t){return l.some(function(e){return e===t})?!1:!0}),null==this.options.filterOptions.sort||this.options.filterOptions.sort?o=o.sort(null!=this.options.inputMap?function(t,e){return t=a.options.inputMap(t),e=a.options.inputMap(e),hx.sort.compare(t,e)}:hx.sort.compare):void 0,o)),l=u.concat(r)),l},buildAutoComplete=function(t,e,n){var o,i,l,s;return l=this,s=this._,void(null==s.callback||e?(s.menu.cursorPos=-1,o=n?void 0:"external"===this.options.matchType?s.data.get(t):findTerm.call(l,t),i={unselectable:!0,text:""},s.menu.clearItems(),null==o?i.text="Loading...":t.length<this.options.minLength?i.text="Please enter "+this.options.minLength+" or more characters":(t.length>0||this.options.showAll)&&0===o.length?this.options.noResultsMessage.length>0&&null!=this.options.noResultsMessage&&(i.text=this.options.noResultsMessage):t.length>=this.options.minLength&&o.length>0&&s.menu.addItems(o),i.text.length>0&&s.menu.addItem(i),s.menu.items.length>0?s.menu.dropdown.isOpen()?s.menu.dropdown.dropdownContent(s.menu.dropdown.dropdown.node()):s.menu.dropdown.show():s.menu.hide()):t.length<this.options.minLength||!this.options.showAll&&0===t.length?(s.data.set(t,[]),buildAutoComplete.call(l,t,!0)):(buildAutoComplete.call(l,t,!0,!0),s.currentSearch=t,s.data.get(t)?buildAutoComplete.call(l,t,!0):(s.data.set(t,!0),s.callback.call(l,t,function(e){return s.cleanUp||(s.data.set(t,e),s.currentSearch!==t)?void 0:buildAutoComplete.call(l,t,!0)}))))},showAutoComplete=function(){return this._.cleanUp=!1,buildAutoComplete.call(this,this._.input.value()||"")},AutoComplete=function(t){function e(t,n,o){var i,l,s,u,r,a,h,p,c,d;this.selector=t,this.data=n,this.options=null!=o?o:{},e.__super__.constructor.apply(this,arguments),this._=a={},a.ignoreMatch=!1,a.ignoreNextFocus=!1,u=this,i={minLength:0,showAll:!0,mustMatch:!1,inputMap:void 0,renderer:void 0,matchType:"contains",placeholder:void 0,filter:void 0,filterOptions:void 0,showOtherResults:!1,allowTabCompletion:!0,noResultsMessage:"No results found",otherResultsMessage:"Other Results"},a.data=new hx.Map,hx.isFunction(this.data)?a.callback=this.data:a.data.set("",this.data),hx.isArray(this.data)||hx.isFunction(this.data)?(this.options=hx.merge(!0,i,this.options),null!=this.options.inputMap&&(d={searchValues:function(t){return[u.options.inputMap(t)]}}),this.options.filterOptions=hx.merge({},d,this.options.filterOptions),null==(h=this.options).filter&&(h.filter=function(t,e){return hx.filter[u.options.matchType](t,e,u.options.filterOptions)}),null==(p=this.options).renderer&&(p.renderer=null!=this.options.inputMap?function(t,e){return hx.select(t).text(u.options.inputMap(e))}:function(t,e){return hx.select(t).text(e)}),null==(c=this.options).placeholder&&(c.placeholder=this.options.minLength>0?"Min length "+this.options.minLength+" characters":void 0),l=hx.select(this.selector),s=new hx.Menu(this.selector,"down","","hx-autocomplete-dropdown"),s.on("input",function(t){return u.options.allowTabCompletion&&9===(t.which||t.keyCode)?t.preventDefault():void 0}),s.pipe(this,void 0,["keydown"]),a.setInputValue=null!=this.options.inputMap?function(t){return l.value(u.options.inputMap(t)),a.suppressEvents?void 0:u.emit("change",t)}:function(t){return l.value(t),a.suppressEvents?void 0:u.emit("change",t)},null!=this.options.placeholder&&l.attr("placeholder",this.options.placeholder),l.on("focus",function(t){return a.ignoreNextFocus?void 0:(a.cleanUp=!1,u.show())},!0),l.on("blur",function(t){return null!=t.relatedTarget&&u.hide(),a.ignoreNextFocus=!1},!0),r=void 0,l.on("input",function(){return a.cleanUp=!1,clearTimeout(r),a.initialValue=l.value(),r=setTimeout(function(){return l.value()!==a.prevTerm?buildAutoComplete.call(u,l.value()||""):void 0},200)}),s.renderer=function(t,e){var n;return n=hx.select(t),n.style("font-weight",""),e.unselectable||e.heading?(n.text(e.text).on("click",function(){return void 0}),e.heading?n.style("font-weight","600"):void 0):u.options.renderer(t,e)},s.on("select",function(t){var e,n;if(e=null!=t&&null!=(n=t.content)?n.content:void 0,null!=e){if(!(null!=e?e.unselectable:void 0)&&!(null!=e?e.heading:void 0)&&!(null!=e?e.disabled:void 0))if("tab"===t.type){if(u.options.allowTabCompletion)return a.setInputValue(e),a.ignoreMatch=!0,u.hide(),u.emit("select",e)}else{if(null==a.initialValue&&t.index>-1)return a.initialValue=l.value();if(-1===t.index&&null!=a.initialValue)return l.value(a.initialValue);if(a.setInputValue(e),"click"===t.type||"enter"===t.type)return a.ignoreMatch=!0,u.hide(),u.emit("select",e),a.ignoreNextFocus=!0}}else if("enter"===t.type)return a.ignoreMatch=!1,u.hide(),l.value().length>0&&u.emit("select",l.value()),a.ignoreNextFocus=!0}),s.on("show",function(){return a.initialValue=l.value(),s.dropdown.useScroll=!0}),s.on("hide",function(){var t;return a.cleanUp=!0,a.ignoreMatch||u.options.mustMatch&&l.value().length>0&&(t="external"===u.options.matchType?a.data.get(l.value()):findTerm.call(u,l.value(),!0),t!==!0&&(null!=t?t.length:void 0)>0?(t=null!=t?t.filter(function(t){return t=null!=u.options.inputMap?u.options.inputMap(t):t,t.toLowerCase()===l.value().toLowerCase()}):void 0,(null!=t?t.length:void 0)>0?a.setInputValue(t[0]):l.value("")):l.value("")),a.ignoreMatch=!1,u.clearCache(),a.suppressEvents||u.emit("hide",l.value()),void(a.suppressEvents=!1)}),s.on("click",function(){return a.ignoreMatch=!0},!0),a.menu=s,a.input=l):hx.consoleWarning("AutoComplete - ",this.selector,": data set incorrectly - you supplied: ",this.data," but should have been an array of items or a function")}return __extends(e,t),e.prototype.clearCache=function(){return this._.data=new hx.Map,null==this.data||hx.isFunction(this.data)||this._.data.set("",this.data),this},e.prototype.show=function(){return this._.ignoreNextFocus=!1,showAutoComplete.call(this),this},e.prototype.hide=function(t){var e;return null==t&&(t=!1),e=this._,e.suppressEvents=t,e.ignoreNextFocus=!1,e.menu.dropdown.isOpen()&&(e.menu.hide(),e.prevTerm=void 0,e.cleanUp=!0),this},e}(hx.EventEmitter),hx.AutoComplete=AutoComplete;})();(function(){var ColorPicker,Position,__hasProp={}.hasOwnProperty,__extends=function(e,o){function r(){this.constructor=e}for(var t in o)__hasProp.call(o,t)&&(e[t]=o[t]);return r.prototype=o.prototype,e.prototype=new r,e.__super__=o.prototype,e};Position=function(){function e(e,o){this.x=e,this.y=o}return e.prototype.add=function(o){var r;return r=new e(this.x,this.y),null!==o&&(isNaN(o.x)||(r.x+=o.x),isNaN(o.y)||(r.y+=o.y)),r},e.prototype.subtract=function(o){var r;return r=new e(this.x,this.y),null!==o&&(isNaN(o.x)||(r.x-=o.x),isNaN(o.y)||(r.y-=o.y)),r},e.prototype.min=function(o){var r;return r=new e(this.x,this.y),null!==o&&(!isNaN(o.x)&&this.x>o.x&&(r.x=o.x),!isNaN(o.y)&&this.y>o.y&&(r.y=o.y)),r},e.prototype.max=function(o){var r;return r=new e(this.x,this.y),null!==o&&(!isNaN(o.x)&&this.x<o.x&&(r.x=o.x),!isNaN(o.y)&&this.y<o.y&&(r.y=o.y)),r},e.prototype.bound=function(e,o){var r;return r=this.max(e),r.min(o)},e.prototype.check=function(){var o;return o=new e(this.x,this.y),isNaN(o.x)&&(o.x=0),isNaN(o.y)&&(o.y=0),o},e.prototype.apply=function(e){return isNaN(this.x)||e.style("left",this.x+"px"),isNaN(this.y)?void 0:e.style("top",this.y+"px")},e}(),ColorPicker=function(e){function o(e,r,t,n){var i;null==r&&(r="#000"),this.showInputs=null!=t?t:0,null==n&&(n="lblt"),o.__super__.constructor.apply(this,arguments),this.currentColor="string"==typeof r?hx.color(r):r,i=function(o){return function(r){var t,n,i,l,c,u,s,a,p,h,x,d,v,f,y,k,g,w,C,m,b,_,P,N,S,I,X,H,L,Y,z,B,E,F,M,q,D,G,R,T,O,A,U,V,j,J,K,Q;return l=function(e){return e=e?e:window.event,e.stopPropogation&&e.stopPropogation(),e.preventDefault&&e.preventDefault(),e.cancelBubble=e.cancel=!0,e.returnValue=!1,!1},f=function(e,o,r){return r?e.subtract(o):e.add(o)},w=function(e){var o,t;return e=e?e:window.event,isNaN(e.layerX)&&e.offsetX?o=new Position(e.offsetX,e.offsetY):(t=e.touches||e.targetTouches)?(r=hx.select(t[0].target).box(),o=new Position(t[0].pageX-r.left-window.scrollX,t[0].pageY-r.top-window.scrollY)):o=new Position(e.layerX,e.layerY),f(o,B,!0)},t=function(e){var o;return e=e?e:window.event,isNaN(window.scrollX)&&e.clientX?new Position(e.clientX+document.documentElement.scrollLeft+document.body.scrollLeft,e.clientY+document.documentElement.scrollTop+document.body.scrollTop):(o=e.touches||e.targetTouches)?new Position(o[0].clientX+window.scrollX,o[0].clientY+window.scrollY):new Position(e.clientX+window.scrollX,e.clientY+window.scrollY)},g=function(e){return e=e?e:window.event,e.target?e.target:e.srcElement},k=function(){return o.showInputs&&Q.style("background",o.currentColor.toString()),o.emit("changeend",o.currentColor)},v=function(e){var r,t;return o.showInputs&&(N.value(o.currentColor.toString().toUpperCase()),q.value(o.currentColor.r),m.value(o.currentColor.g),i.value(o.currentColor.b),I.value(Math.round(360*o.currentColor.h)),G.value(Math.round(100*o.currentColor.s)),L.value(Math.round(100*o.currentColor.l)),E.style("background",o.currentColor.toString())),("slider"===e||"box"===e)&&(r=hx.color().setHSL([o.currentColor.h,1,.5]),b.style("background-color",r.toString())),"box"===e&&(j.style("top",_-o.currentColor.h*_-V.y+"px"),t=new Position(o.currentColor.s*_,(1-o.currentColor.l)*_),t=f(t,p,!0),t.apply(h),k()),o.emit("change",o.currentColor)},P=function(e){return hx.color.isColorString(N.value())?(o.currentColor=hx.color(N.value()),v("box")):void 0},M=function(e){return o.currentColor.setRGB([parseInt(q.value())||0,o.currentColor.g,o.currentColor.b]),v("box")},C=function(e){return o.currentColor.setRGB([o.currentColor.r,parseInt(m.value())||0,o.currentColor.b]),v("box")},n=function(e){return o.currentColor.setRGB([o.currentColor.r,o.currentColor.g,parseInt(i.value())||0]),v("box")},S=function(e){return o.currentColor.setHSL([parseFloat(I.value())||0,o.currentColor.s,o.currentColor.l]),v("box")},D=function(e){return o.currentColor.setHSL([o.currentColor.h,parseFloat(G.value())/100||0,o.currentColor.l]),v("box")},H=function(e){return o.currentColor.setHSL([o.currentColor.h,o.currentColor.s,parseFloat(L.value())/100||0]),v("box")},U=function(e,r){return e=f(e,V,!1),o.currentColor.setHSL([(_-e.y)/_,o.currentColor.s,o.currentColor.l]),v("slider")},a=function(e,r){return e=f(e,p,!1),o.currentColor.setHSL([o.currentColor.h,e.x/_,1-e.y/_]),v("circle")},T=function(e,o){var r;return r=w(e),g(e)===o.node()&&(r.y+=parseInt(o.style("top"))),r=f(r,V,!0),r=r.bound(K,J),r.apply(o),U(r)},c=function(e,o){var r;return r=w(e),g(e)===o.node()&&(r.x+=parseInt(o.style("left")),r.y+=parseInt(o.style("top"))),r=f(r,p,!0),r=r.bound(d,x),r.apply(o),a(r)},y=function(e,o,r,n,i,c,u){var s,a,p,h,x,d,v,f,y,k,g,w;return p=k=y=g=h=null,null!==r&&null!==n&&(w=r.min(n),n=r.max(n),r=w),d=function(o){return y||!g||h?void 0:(y=!0,null!==i&&i(o,e),p=t(o),k=new Position(parseInt(e.style("left")),parseInt(e.style("top"))),k=k.check(),hx.select(document).on("touchmove",x),hx.select(document).on("touchend",f),hx.select(document).on("mousemove",x),hx.select(document).on("mouseup",f))},x=function(o){var i;if(y&&!h)return i=t(o),i=i.add(k).subtract(p),i=i.bound(r,n),i.apply(e),null!==c&&c(i,e),l(o)},f=function(e){return v(),l(e)},v=function(){return!y||h?!0:(hx.select(document).off("touchmove",x),hx.select(document).off("touchend",f),hx.select(document).off("mousemove",x),hx.select(document).off("mouseup",f),p=k=null,null!==u&&u(e),y=!1)},s=function(){return g||h?void 0:(g=!0,o.on("touchstart",d),o.on("mousedown",d))},a=function(){return g&&!h?(o.deregister("touchstart",d),o.deregister("mousedown",d),stopCurrentDragging&&y?v():void 0):void 0},s()},F=Math.round(99999*Math.random()),X=o.showInputs?"<div id='hx-colorpicker-inputs_"+F+"' class='hx-colorpicker-inputs'>\n  <div class='hx-colorpicker-input-group'>\n    <div id='hx-colorpicker-quickColor_"+F+"' class='hx-colorpicker-quickColor'></div><div id='hx-colorpicker-staticColor_"+F+"' class='hx-colorpicker-quickColor'></div>\n  </div>\n  <div class='hx-colorpicker-input'><label for='hex'>Hex:</label><input name='hex' id='hx-colorpicker-input-hex_"+F+"' type='text' size='7' maxlength='7' /></div>\n  <div class='hx-colorpicker-input-group'>\n    <div class='hx-colorpicker-input'><label for='red'>R:</label><input name='red' id='hx-colorpicker-input-red_"+F+"' type='text' size='7' maxlength='3' /></div>\n    <div class='hx-colorpicker-input'><label for='green'>G:</label><input name='green' id='hx-colorpicker-input-green_"+F+"' type='text' size='7' maxlength='3' /></div>\n    <div class='hx-colorpicker-input'><label for='blue'>B:</label><input name='blue' id='hx-colorpicker-input-blue_"+F+"' type='text' size='7' maxlength='3' /></div>\n  </div>\n  <div class='hx-colorpicker-input-group'>\n    <div class='hx-colorpicker-input'><label for='hue'>H:</label><input name='hue' id='hx-colorpicker-input-hue_"+F+"' type='text' size='7' maxlength='3' /></div>\n    <div class='hx-colorpicker-input'><label for='saturation'>S:</label><input name='saturation' id='hx-colorpicker-input-saturation_"+F+"' type='text' size='7' maxlength='3' /></div>\n    <div class='hx-colorpicker-input'><label for='lightness'>L:</label><input name='lightness' id='hx-colorpicker-input-lightness_"+F+"' type='text' size='7' maxlength='3' /></div>\n  </div>\n</div>":"",z="<div id='hx-colorpicker_"+F+"' class='hx-colorpicker'>\n  <div class='hx-colorpicker-inner'>\n    <div class='hx-colorpicker-fields'>\n      <div id='hx-colorpicker-grid_"+F+"' class='hx-colorpicker-grid'>\n        <div id='hx-colorpicker-circlePicker_"+F+"' class='hx-colorpicker-picker'></div>\n      </div>\n      <div id='hx-colorpicker-slider_"+F+"' class='hx-colorpicker-slider'>\n        <div id='hx-colorpicker-sliderPicker_"+F+"' class='hx-colorpicker-picker'></div>\n      </div>\n    </div>\n    "+X+"\n  </div>\n</div>","string"==typeof e&&(e=hx.select(e)),Y=hx.select(r).html(z),b=hx.select("#hx-colorpicker-grid_"+F),R=hx.select("#hx-colorpicker-slider_"+F),j=hx.select("#hx-colorpicker-sliderPicker_"+F),h=hx.select("#hx-colorpicker-circlePicker_"+F),o.showInputs&&(N=hx.select("#hx-colorpicker-input-hex_"+F),q=hx.select("#hx-colorpicker-input-red_"+F),m=hx.select("#hx-colorpicker-input-green_"+F),i=hx.select("#hx-colorpicker-input-blue_"+F),I=hx.select("#hx-colorpicker-input-hue_"+F),G=hx.select("#hx-colorpicker-input-saturation_"+F),L=hx.select("#hx-colorpicker-input-lightness_"+F),E=hx.select("#hx-colorpicker-quickColor_"+F),Q=hx.select("#hx-colorpicker-staticColor_"+F),N.on("change",P),q.on("change",M),m.on("change",C),i.on("change",n),I.on("change",S),G.on("change",D),L.on("change",H),E.style("background",o.currentColor.toString()),Q.style("background",o.currentColor.toString())),A=j.node().offsetHeight,s=h.node().offsetHeight,_=b.node().offsetHeight-2,K=new Position(0,-A/2),J=new Position(0,_-A/2),d=new Position(-(s/2),-(s/2)),x=new Position(_-s/2,_-s/2),B=new Position(navigator.userAgent.indexOf("Firefox")>=0?1:0,navigator.userAgent.indexOf("Firefox")>=0?1:0),p=new Position(s/2,s/2),V=new Position(0,A/2),O=u="",O=new y(j,R,K,J,T,U,k),u=new y(h,b,d,x,c,a,k),v("box")}}(this),new hx.Dropdown(e,i,"click",n)}return __extends(o,e),o}(hx.EventEmitter),hx.ColorPicker=ColorPicker;})();(function(){var ColorScale;ColorScale=function(){function r(r,i,n){this.domainMin=null!=r?r:0,this.domainMax=null!=i?i:10,this.rangeArr=n,this.rangeArr=this.rangeArr.sort(function(r,a){return r.val-a.val}),this.rangeMin=this.rangeArr[0].val,this.rangeMax=this.rangeArr[this.rangeArr.length-1].val,this.factor=a(this.domainMin,this.domainMax,this.rangeMin,this.rangeMax)}var a;return a=function(r,a,i,n){var t;return t=a-r,0!==t?(n-i)/t:1},r.prototype.apply=function(r){var a,i,n,t,h,e,o,s,g;switch(n=this.rangeMin+(r-this.domainMin)*this.factor,!1){case!(n<this.rangeMin):a=this.rangeArr[0].color;break;case!(n>this.rangeMax):a=this.rangeArr[this.rangeArr.length-1].color;break;default:for(i=s=0,g=this.rangeArr.length-1;g>s;i=s+=1)if(n>=this.rangeArr[i].val&&n<=this.rangeArr[i+1].val){e=i+1;break}t=n-this.rangeArr[e-1].val,o=this.rangeArr[e].val-this.rangeArr[e-1].val,h=hx.clamp(0,1,t/o),a=hx.color(this.rangeArr[e-1].color).mix(hx.color(this.rangeArr[e].color),h)}return a.toString()},r.prototype.domain=function(r,i){return this.domainMin=r,this.domainMax=i,this.factor=a(this.domainMin,this.domainMax,this.rangeMin,this.rangeMax),this},r.prototype.range=function(r){return this.rangeArr=r,this.factor=a(this.domainMin,this.domainMax,this.rangeMin,this.rangeMax),this},r}(),hx.ColorScale=ColorScale;})();(function(){var Crumbtrail;Crumbtrail=function(){function r(r){this.selector=r}return r.prototype.render=function(r,t,n){var e,a,i,u;return null==n&&(n="/"),e=function(r,t){return t%2===0?this.append("span")["class"]("hx-crumbtrail-node").node():this.append("span")["class"]("hx-crumbtrail-separator").html(n).node()},i=function(r,n,e){return e%2===0?t(n,r):void 0},a=hx.flatten(r.map(function(r){return[r,0]})).slice(0,-1),u=hx.select(this.selector).view("span").enter(e).update(i).apply(a)},r}(),hx.Crumbtrail=Crumbtrail;})();(function(){var Dashboard,DashboardWidget;Dashboard=function(){function e(e){this.selection=hx.select(e).classed("hx-layout",!0).classed("hx-group",!0).classed("hx-horizontal",!0).classed("hx-no-margin",!0)}return e.prototype.createWidget=function(e){return new DashboardWidget(this.selection.append("div").node(),e)},e}(),DashboardWidget=function(){function e(e,t){var n,s;s=this,this.selection=hx.select(e),this.selection["class"]("hx-widget hx-group hx-vertical").style("flex-basis",(t.width||500)+"px"),n=this.selection.append("div")["class"]("hx-widget-heading hx-section hx-fixed"),n.append("span").text(t.title),this.menuButton=n.append("button")["class"]("hx-btn hx-btn-invisible"),this.menuButton.append("i")["class"]("fa fa-bars"),this.body=this.selection.append("div")["class"]("hx-widget-body-wrapper hx-section").append("div")["class"]("hx-widget-body"),this.menu=new hx.Menu(this.menuButton.node(),"rbrt"),this.menu.renderer=function(e,t){var n;return n=hx.select(e).classed("hx-widget-menu-item",!0),n.append("i")["class"]("fa "+t.icon),n.append("span").text(t.name)},this.showMenu(t.showMenu)}return e.prototype.remove=function(){return this.selection.style("max-width",this.selection.style("width")).morph()["with"]("fadeout").thenStyle("max-width","0px").andStyle("height","0px").then(function(e){return function(){return e.selection.remove()}}(this)).go()},e.prototype.title=function(e){return this.selection.select(".hx-widget-heading").select("span").text(e)},e.prototype.showMenu=function(e){return this.menuButton.style("display",e?"":"none")},e}(),hx.Dashboard=Dashboard;})();(function(){var DateTimePicker,__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var i in e)__hasProp.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};DateTimePicker=function(t){function e(t,r,i){var n,s;this.selector=t,this.type=r,this.showSeconds=i,e.__super__.constructor.apply(this,arguments),this.supressCallback=!1,this.selection=hx.select(this.selector).classed("hx-date-time-picker",!0),n=this.selection.append("div").node(),s=this.selection.append("div").node(),this.datePicker=new hx.DatePicker(n,this.type),this.timePicker=new hx.TimePicker(s,this.showSeconds),this.datePicker.on("change",function(t){return function(){return t.timePicker.setDate(t.datePicker.getDate(),!1,!0),t.supressCallback||t.emit("change",t.getDate()),t.supressCallback=!1}}(this)),this.timePicker.on("change",function(t){return function(){return t.datePicker.setDate(t.getDate(),!1,!0),t.supressCallback||t.emit("change",t.getDate()),t.supressCallback=!1}}(this))}return __extends(e,t),e.prototype.getDate=function(){return this.timePicker.getDate()},e.prototype.getHour=function(){return this.timePicker.getHour()},e.prototype.getMinute=function(){return this.timePicker.getMinute()},e.prototype.getSecond=function(){return this.timePicker.getSecond()},e.prototype.getScreenDate=function(){return this.datePicker.getScreenDate()},e.prototype.getScreenTime=function(){return this.timePicker.getScreenTime()},e.prototype.setDate=function(t,e,r){return this.supressCallback=null!=r?r:!1,this.timePicker.setDate(t,e)},e.prototype.setDay=function(t,e){return this.supressCallback=null!=e?e:!1,this.datePicker.setDay(t)},e.prototype.setMonth=function(t,e){return this.supressCallback=null!=e?e:!1,this.datePicker.setMonth(t)},e.prototype.setYear=function(t,e){return this.supressCallback=null!=e?e:!1,this.datePicker.setYear(t)},e.prototype.setHour=function(t,e){return this.supressCallback=null!=e?e:!1,this.timePicker.setHour(t)},e.prototype.setMinute=function(t,e){return this.supressCallback=null!=e?e:!1,this.timePicker.setMinute(t)},e.prototype.setSecond=function(t,e){return this.supressCallback=null!=e?e:!1,this.timePicker.setSecond(t)},e.prototype.addDays=function(t){return this.datePicker.addDays(t)},e.prototype.addMonths=function(t){return this.datePicker.addMonths(t)},e.prototype.addYears=function(t){return this.datePicker.addYears(t)},e.prototype.addHours=function(t){return this.timePicker.addHours(t)},e.prototype.addMinutes=function(t){return this.timePicker.addMinutes(t)},e.prototype.addSeconds=function(t){return this.timePicker.addSeconds(t)},e.prototype.update=function(){var t,e;return"function"==typeof(t=this.timePicker).update&&t.update(),"function"==typeof(e=this.datePicker).update?e.update():void 0},e}(hx.EventEmitter),hx.DateTimePicker=DateTimePicker;})();(function(){var Camera,Circle,ColorProperty,Composite,DiscreteProperty,Drawing,DrawingColor,DrawingObject,Grid,Layer,Line,NumberProperty,PerformanceGauge,Point,Rectangle,Shape,StringProperty,Text,horizontalLineIntersection,lineIntersection,pointRectangleIntersection,verticalLineIntersection,__hasProp={}.hasOwnProperty,__extends=function(t,e){function i(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};pointRectangleIntersection=function(t,e,i,o,s,n){return t>=i&&s>=t&&e>=o&&n>=e},lineIntersection=function(t,e,i,o,s,n,r,a){var h,l,u,c,p,d;return l=i-t,c=o-e,u=r-s,p=a-n,h=(-c*(t-s)+l*(e-n))/(-u*c+l*p),d=(u*(e-n)-p*(t-s))/(-u*c+l*p),h>=0&&1>=h&&d>=0&&1>=d},horizontalLineIntersection=function(t,e,i,o,s,n,r){var a;return e===o?r===e&&(t>=s&&n>=t||i>=s&&n>=i||s>t&&i>n):(a=t+(r-e)*(i-t)/(o-e),a>=s&&n>=a)},verticalLineIntersection=function(t,e,i,o,s,n,r){var a;return t===i?r===t&&(e>=s&&n>=e||o>=s&&n>=o||s>e&&o>n):(a=e+(r-t)*(o-e)/(i-t),a>=s&&n>=a)},DrawingColor=function(){function t(){this.c=hx.color()}return t.prototype.set=function(t,e){switch(t){case"color":return this.c=hx.color(e);case"color.red":return this.c.r=hx.clamp(0,255,e);case"color.green":return this.c.g=hx.clamp(0,255,e);case"color.blue":return this.c.b=hx.clamp(0,255,e);case"color.alpha":return this.c.a=hx.clampUnit(e)}},t}(),DrawingObject=function(){function t(t){this.id=null!=t?t:hx.randomId(),this.attr=new hx.Map,this.properties=new hx.Map,this.selectable=this.addDiscreteProperty("selectable"),this.selected=!1}return t.prototype.addDiscreteProperty=function(t,e){var i;return null==e&&(e=!1),i=new DiscreteProperty(e),this.properties.set(t,i),i},t.prototype.addNumberProperty=function(t,e){var i;return null==e&&(e=0),i=new NumberProperty(e),this.properties.set(t,i),i},t.prototype.addColorProperty=function(t,e){var i;return null==e&&(e="#FFF"),i=new ColorProperty(e),this.properties.set(t,i),i},t.prototype.addStringProperty=function(t,e){var i;return null==e&&(e=""),i=new StringProperty(e),this.properties.set(t,i),i},t.prototype.set=function(t,e,i,o){return this.properties.has(t)?this.properties.get(t).set(e,i,o):hx.startsWith(t,"attr.")?this.attr.set(t.substring(5),e):console.warn("unknown property: ",t,Error().stack),this},t.prototype.get=function(t){return this.properties.has(t)?this.properties.get(t).value:hx.startsWith(t,"attr.")?this.attr.get(t.substring(5)):void 0},t.prototype.drawBoundingBox=function(t,e){var i,o;return i=this.getBoundingBox(t),i?(e.setStrokeColor(hx.color("rgba(64, 64, 64, 1)")),o=2,e.setStrokeWidth(Math.min(1,.95/e.camera.actualZoom)),t.strokeRect(i[0]-o,i[1]-o,i[2]-i[0]+2*o,i[3]-i[1]+2*o),e.setFillColor(hx.color("rgba(128, 128, 128, 0.1)")),t.fillRect(i[0]-o,i[1]-o,i[2]-i[0]+2*o,i[3]-i[1]+2*o)):void 0},t.prototype.pointInBoundingBox=function(t,e){var i;return i=this.getBoundingBox(e),pointRectangleIntersection(t.x,t.y,i[0],i[1],i[2],i[3])},t}(),ColorProperty=function(){function t(t){this.value=hx.color(),hx.defined(t)&&this.set(t)}return t.prototype.set=function(t,e,i){var o,s,n,r,a,h,l,u,c,p,d;return hx.defined(this.stop)&&(this.stop(),this.stop=void 0),hx.defined(e)?(p=this.value.r,c=this.value.g,u=this.value.b,l=this.value.a,o=hx.color(t),h=o.r,a=o.g,r=o.b,n=o.a,s=i?function(t){return function(e){return t.stop=void 0,i(!e,t.value)}}(this):void 0,d=function(t){return function(e,i){return i?void 0:(t.value.r=p+(h-p)*e,t.value.g=c+(a-c)*e,t.value.b=u+(r-u)*e,t.value.a=l+(n-l)*e)}}(this),this.stop=hx.transition(e,d,hx.ease.linear,s)):this.value=hx.color(t)},t}(),NumberProperty=function(){function t(t){this.value=t,this.stop=void 0}return t.prototype.set=function(t,e,i){var o,s,n;return hx.defined(this.stop)&&(this.stop(),this.stop=void 0),hx.defined(e)?(s=this.value,o=i?function(t){return function(e){return t.stop=void 0,i(!e,t.value)}}(this):void 0,n=function(e){return function(i,o){return o?void 0:e.value=s+(t-s)*i}}(this),this.stop=hx.transition(e,n,hx.ease.linear,o)):this.value=t},t}(),StringProperty=function(){function t(t){this.value=t,this.stop=void 0}return t.prototype.set=function(t,e,i){var o,s,n;return hx.defined(this.stop)&&(this.stop(),this.stop=void 0),hx.defined(e)?(s=hx.interpolate(this.value,t),o=i?function(t){return function(e){return t.stop=void 0,i(!e,t.value)}}(this):void 0,n=function(t){return function(e,i){return i?void 0:t.value=s(e)}}(this),this.stop=hx.transition(e,n,hx.ease.linear)):this.value=t},t}(),DiscreteProperty=function(){function t(t){this.value=t}return t.prototype.set=function(t){return this.value=t},t}(),Point=function(){function t(t,e){this.x=null!=t?t:0,this.y=null!=e?e:0}return t.prototype.set=function(t){return this.x=t.x,this.y=t.y},t.prototype.tweenTo=function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e},t.prototype.distanceTo=function(t){return Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y))},t.prototype.distanceToSquared=function(t){return(this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y)},t}(),Camera=function(t){function e(t){var i;this.drawing=t,e.__super__.constructor.apply(this,arguments),this.position=new Point,this.zoom=1,this.actualPosition=new Point,this.actualZoom=1,this.smoothPosition=!1,this.positionSmoothingFactor=.15,this.smoothZoom=!0,this.zoomSmoothingFactor=.15,this.zoomMax=null,this.zoomMin=null,this.xMin=null,this.yMin=null,this.xMax=null,this.yMax=null,this.mode=null,this.followContinualZoom=!1,this.smoothToNextTargetPosition=!1,this.lastx1=0,this.lasty1=0,this.lastx2=0,this.lasty2=0,this.lastZoom=1,this.isZoomTouch=!1,this.moving=!1,this.panEnabled=!1,this.zoomEnabled=!1,this.selectionEnabled=!1,i={selection:hx.select(this.drawing.canvasNode),positionLast:new Point,touchStart:new Point,mouseDown:!1,moveThreshold:5*this.drawing.dpr,longPressTime:1e3,longPressTimer:null,didLongPress:!1},hx.select(document).on("mousemove",function(t){return function(e){return n.call(t,e,i)}}(this),!0),hx.select(document).on("mouseup",function(t){return function(e){return r.call(t,e,i)}}(this),!0),i.selection.on("mousedown",function(t){return function(e){return s.call(t,e,i)}}(this)),i.selection.on("mousewheel",function(t){return function(e){return a.call(t,e,i)}}(this)),i.selection.on("DOMMouseScroll",function(t){return function(e){return a.call(t,e,i)}}(this)),hx.select(document).on("touchstart",function(t){return function(e){return u.call(t,e,i)}}(this),!0),i.selection.on("touchmove",function(t){return function(e){return l.call(t,e,i)}}(this)),hx.select(document).on("touchend",function(t){return function(e){return h.call(t,e,i)}}(this),!0),i.selection.on("touchcancel",function(t){return function(e){return h.call(t,e,i)}}(this))}var i,o,s,n,r,a,h,l,u,c,p;return __extends(e,t),p=function(t){return this.zoom=t,this.emit("zoom",{zoom:t})},s=function(t,e){var i,o;return t.preventDefault(),this.mouseDown=!0,i=t.clientX,o=t.clientY,e.touchStart.x=i,e.touchStart.y=o,this.emit("pointerdown",{x:i,y:o})},n=function(t,e){var i,o,s,n;return this.panEnabled&&this.mouseDown&&t.preventDefault(),s=t.clientX,n=t.clientY,this.mouseDown&&(!this.moving&&(e.touchStart.x-s)*(e.touchStart.x-s)+(e.touchStart.y-n)*(e.touchStart.y-n)>e.moveThreshold*e.moveThreshold&&(this.moving=!0,e.positionLast.set(e.touchStart),this.panEnabled&&e.selection.style("cursor","move")),this.moving)?(i=s-e.positionLast.x,o=n-e.positionLast.y,e.positionLast.x=t.clientX,e.positionLast.y=t.clientY,c.call(this,i,o)):void 0},r=function(t,e){return this.mouseDown?(t.preventDefault(),this.mouseDown=!1,this.moving?this.moving=!1:i.call(this,e.touchStart.x-e.selection.box().left,e.touchStart.y-e.selection.box().top),e.selection.style("cursor","default"),this.emit("pointerup",{x:e.touchStart.x,y:e.touchStart.y})):void 0},c=function(t,e,i){return this.panEnabled?(this.mode=void 0,this.smoothToNextTargetPosition=!1,this.position.x-=t*this.drawing.dpr/this.actualZoom,this.position.y-=e*this.drawing.dpr/this.actualZoom,this.emit("move",{dx:t,dy:e})):void 0},a=function(t,e){var i,o,s,n,r,a;return this.zoomEnabled?(t.preventDefault(),t.stopPropagation(),null!=t.wheelDelta?i=t.wheelDelta:null!=t.detail&&(i=-t.detail),o=Math.min(.99,Math.abs(i/120*.2)),t.ctrlKey&&(o/=5),s=t.clientX,n=t.clientY,r=this.getWorldX(s),a=this.getWorldY(n),p.call(this,i>0?this.zoom/(1-o):this.zoom*(1-o))):void 0},u=function(t,e){var i,s,n,r,a,h,l;if(t.preventDefault(),this.mouseDown=!0,i=t.changedTouches,i.length>0)for(n=h=0,l=i.length-1;l>=h;n=h+=1)r=i[n].clientX,a=i[n].clientY,this.emit("pointerdown",{x:r,y:a});return 1===t.targetTouches.length?(r=t.targetTouches[0].clientX,a=t.targetTouches[0].clientY,e.touchStart.x=r,e.touchStart.y=a,s=!1,e.longPressTimer=setTimeout(function(t){return function(){return o.call(t,e.touchStart.x-e.selection.box().left,e.touchStart.y-e.selection.box().top),s=!0}}(this),e.longPressTime)):2===t.targetTouches.length?(e.longPressTimer&&(clearTimeout(e.longPressTimer),e.longPressTimer=null),this.isZoomTouch=!0,this.lastx1=t.targetTouches[0].clientX,this.lasty1=t.targetTouches[0].clientY,this.lastx2=t.targetTouches[1].clientX,this.lasty2=t.targetTouches[1].clientY,this.startPinchDistance=Math.sqrt((this.lastx1-this.lastx2)*(this.lastx1-this.lastx2)+(this.lasty1-this.lasty2)*(this.lasty1-this.lasty2)),this.lastZoom=this.zoom):void 0},l=function(t,e){var i,o,s,n,r,a,h,l,u;if(t.preventDefault(),1!==t.targetTouches.length||this.isZoomTouch){if(2===t.targetTouches.length&&this.zoomEnabled)return r=t.targetTouches[0].clientX,l=t.targetTouches[0].clientY,a=t.targetTouches[1].clientX,u=t.targetTouches[1].clientY,i=Math.sqrt((r-a)*(r-a)+(l-u)*(l-u)),p.call(this,this.lastZoom*i/this.startPinchDistance)}else if(n=t.targetTouches[0].clientX,h=t.targetTouches[0].clientY,!this.moving&&(e.touchStart.x-n)*(e.touchStart.x-n)+(e.touchStart.y-h)*(e.touchStart.y-h)>e.moveThreshold*e.moveThreshold&&(this.moving=!0,e.positionLast.set(e.touchStart),e.longPressTimer&&(clearTimeout(e.longPressTimer),e.longPressTimer=null)),this.moving&&(o=n-e.positionLast.x,s=h-e.positionLast.y,e.positionLast.x=n,e.positionLast.y=h,this.mouseDown))return c.call(this,o,s)},h=function(t,e){var o,s,n,r,a,h,l;if(this.mouseDown){if(t.preventDefault(),o=t.changedTouches,o.length>0)for(n=h=0,l=o.length-1;l>=h;n=h+=1)r=o[n].clientX,a=o[n].clientY,this.emit("pointerup",{x:r,y:a});return 0===t.targetTouches.length?(this.isZoomTouch=!1,e.longPressTimer&&(clearTimeout(e.longPressTimer),e.longPressTimer=null),this.moving?this.moving=!1:s||i.call(this,e.touchStart.x-e.selection.box().left,e.touchStart.y-e.selection.box().top),s=!1):void 0}},i=function(t,e){var i,o,s;return s=this.screenPointToWorldPoint(new Point(t,e)),this.selectionEnabled&&(i=this.drawing.ctx,o=this.drawing.findBy(function(t){return t.selectable.value&&t.pointInBoundingBox(s,i)}),o?this.drawing.select(o):this.drawing.unselectAll()),this.emit("click",{x:t,y:e,wx:s.x,wy:s.y})},o=function(t,e){return this.emit("longpress",{x:t,y:e})},e.prototype.setupBounds=function(t,e,i,o,s,n){return this.zoomMin=t,this.zoomMax=e,this.xMin=i,this.yMin=o,this.xMax=s,this.yMax=n},e.prototype.clearTransform=function(t){return t.setTransform(1,0,0,1,0,0)},e.prototype.applyTransform=function(t){return t.translate(this.drawing.width/2,this.drawing.height/2),t.scale(this.actualZoom,this.actualZoom),t.translate(-this.actualPosition.x,-this.actualPosition.y)},e.prototype.update=function(){var t;switch(this.mode){case"follow":t=this.followObject.getBoundingBox(this.drawing.ctx),t&&(this.followContinualZoom&&(this.zoom=this.calculateZoomForBoundingBox(t,this.followZoomOut)),this.position.x=(t[0]+t[2])/2,this.position.y=(t[1]+t[3])/2)}return this.zoomMin&&this.zoom<this.zoomMin&&(this.zoom=this.zoomMin),this.zoomMax&&this.zoom>this.zoomMax&&(this.zoom=this.zoomMax),this.xMin&&this.position.x<this.xMin&&(this.position.x=this.xMin),this.yMin&&this.position.y<this.yMin&&(this.position.y=this.yMin),this.xMax&&this.position.x>this.xMax&&(this.position.x=this.xMax),this.yMax&&this.position.y>this.yMax&&(this.position.y=this.yMax),this.smoothPosition||this.smoothToNextTargetPosition?(this.actualPosition.tweenTo(this.position,this.positionSmoothingFactor),this.actualPosition.distanceTo(this.position)<1&&(this.smoothToNextTargetPosition=!1)):this.actualPosition.set(this.position),this.actualZoom=this.smoothZoom?hexagon.tween(this.actualZoom,this.zoom,this.zoomSmoothingFactor):this.zoom},e.prototype.getWorldRect=function(){return[this.actualPosition.x-this.drawing.width/(2*this.actualZoom),this.actualPosition.y-this.drawing.height/(2*this.actualZoom),this.actualPosition.x+this.drawing.width/(2*this.actualZoom),this.actualPosition.y+this.drawing.height/(2*this.actualZoom)]},e.prototype.getWorldX=function(t){return(t*this.drawing.dpr-this.drawing.width/2)/this.actualZoom+this.actualPosition.x},e.prototype.getWorldY=function(t){return(t*this.drawing.dpr-this.drawing.height/2)/this.actualZoom+this.actualPosition.y},e.prototype.screenPointToWorldPoint=function(t){var e;return e={x:(t.x*this.drawing.dpr-this.drawing.width/2)/this.actualZoom+this.actualPosition.x,y:(t.y*this.drawing.dpr-this.drawing.height/2)/this.actualZoom+this.actualPosition.y}},e.prototype.worldPointToScreenPoint=function(t){var e;return e={x:(t.x*this.drawing.dpr-this.actualPosition.x)*this.actualZoom+this.drawing.width/2,y:(t.y*this.drawing.dpr-this.actualPosition.y)*this.actualZoom+this.drawing.height/2}},e.prototype.calculateZoomForBoundingBox=function(t,e){return Math.min(this.drawing.width/((t[2]-t[0])*e),this.drawing.height/((t[3]-t[1])*e))},e.prototype.follow=function(t,e,i){var o;return this.smoothToNextTargetPosition=!0,t&&(this.mode="follow",this.followObject=t,this.followZoomOut=e,this.followContinualZoom=i,o=this.followObject.getBoundingBox(this.drawing.ctx))?this.zoom=this.calculateZoomForBoundingBox(o,e):void 0},e.prototype.stopFollowing=function(){return this.mode=null,this.followObject=null},e.prototype.show=function(t,e){var i;return this.smoothToNextTargetPosition=!0,t&&(i=t.getBoundingBox(this.drawing.ctx))?(this.zoom=this.calculateZoomForBoundingBox(i,e),this.position.x=(i[0]+i[2])/2,this.position.y=(i[1]+i[3])/2):void 0},e}(hx.EventEmitter),Drawing=function(t){function e(t,i){var o,s,n;null==i&&(i=!0),e.__super__.constructor.apply(this,arguments),o=hx.select(t),o.classed("hx-drawing",!0),this.canvas=o.append("canvas"),this.overlay=o.append("div"),n=o.node().clientWidth,s=o.node().clientHeight,this.dpr=null!=window.devicePixelRatio?window.devicePixelRatio:1,this.canvas.prop("width",n*this.dpr),this.canvas.prop("height",s*this.dpr),this.canvas.style("width",n+"px"),this.canvas.style("height",s+"px"),this.canvas.style("position","relative"),this.width=n*this.dpr,this.height=s*this.dpr,this.canvasNode=this.canvas.node(),this.ctx=this.canvasNode.getContext("2d"),this.overlay["class"]("hx-drawing-overlay"),this.overlay.style("width",n+"px"),this.overlay.style("height",s+"px"),this.defaultLayer=new Layer(this),this.layers=[this.defaultLayer],this.camera=new Camera(this),this.camera.pipe(this),this.globalAlpha=1,this.state={height:n,width:s},this.stats=null,this.selectedObjects=new hx.List,this.frame=0,i&&this.resume()}var i;return __extends(e,t),i=function(){var t;return t=!1,hx.loop(function(e){return function(){var i,o,s,n;for(e.stats&&e.stats.start(),e.camera.clearTransform(e.ctx),e.ctx.clearRect(0,0,e.width,e.height),e.camera.update(),e.camera.applyTransform(e.ctx),n=e.layers,o=0,s=n.length;s>o;o++)i=n[o],i.render(e.ctx);return e.stats&&(e.camera.clearTransform(e.ctx),e.stats.end(),e.stats.update(),e.stats.render()),e.emit("update",e.frame),e.frame++,t}}(this)),function(){return t=!0}},e.prototype.resume=function(){return this.stopFunc?void 0:this.stopFunc=i.call(this)},e.prototype.stop=function(){return this.stopFunc?(this.stopFunc(),this.stopFunc=void 0):void 0},e.prototype.find=function(t){var e,i,o,s,n;for(n=this.layers,o=0,s=n.length;s>o;o++)if(e=n[o],i=e.find(t))return i},e.prototype.findBy=function(t){var e,i,o,s,n;for(n=this.layers,o=0,s=n.length;s>o;o++)if(e=n[o],i=e.findBy(t))return i},e.prototype.createLayer=function(){var t;return t=new Layer(this),this.layers.push(t),t},e.prototype.showLayer=function(t){var e,i,o,s,n;for(s=this.layers,n=[],i=0,o=s.length;o>i;i++)e=s[i],n.push(e.visible=e===t);return n},e.prototype.follow=function(t,e,i){return null==e&&(e=1),null==i&&(i=!1),this.camera.follow(t,e,i)},e.prototype.stopFollowing=function(){return this.camera.stopFollowing},e.prototype.show=function(t,e){return null==e&&(e=1),this.camera.show(t,e)},e.prototype.enablePan=function(){return this.camera.panEnabled=!0},e.prototype.enableZoom=function(){return this.camera.zoomEnabled=!0},e.prototype.enableSelection=function(){return this.camera.selectionEnabled=!0},e.prototype.enablePerformanceGauge=function(){return this.stats=new PerformanceGauge(this)},e.prototype.enableSearchbox=function(){var t;return this.searchbox=this.overlay.append("div").classed("hx-drawing-searchbox",!0),t=this.searchbox.append("input").attr("placeholder","Search"),t.on("keypress",function(e){return function(i){return 13===i.which?e.emit("search",t.prop("value")):void 0}}(this))},e.prototype.create=function(t,e){return this.defaultLayer.create(t,e)},e.prototype["delete"]=function(t){var e,i,o,s,n;for(s=this.layers,n=[],i=0,o=s.length;o>i;i++)e=s[i],n.push(e["delete"](t));return n},e.prototype.deleteAll=function(){var t,e,i,o;for(o=this.layers,e=0,i=o.length;i>e;e++)t=o[e],t.deleteAll();return void 0},e.prototype.setGlobalAlpha=function(t){return this.globalAlpha=t},e.prototype.setFillColor=function(t){var e,i,o,s;return s=t.r,o=t.g,i=t.b,e=t.a*this.globalAlpha,this.ctx.fillStyle="rgba("+Math.floor(s)+","+Math.floor(o)+","+Math.floor(i)+","+e+")"},e.prototype.setStrokeColor=function(t){var e,i,o,s;return s=t.r,o=t.g,i=t.b,e=t.a*this.globalAlpha,this.ctx.strokeStyle="rgba("+Math.floor(s)+","+Math.floor(o)+","+Math.floor(i)+","+e+")"},e.prototype.setStrokeWidth=function(t){return this.ctx.lineWidth=t},e.prototype.setStrokeCap=function(t){return this.ctx.lineCap=t},e.prototype.getBoundingBox=function(){var t,e,i,o,s;if(this.layers.length>0){if(i=this.layers[0].getBoundingBox(this.ctx),this.layers.length>1)for(e=o=1,s=this.layers.length-1;s>=o;e=o+=1)t=this.layers[e].getBoundingBox(this.ctx),t&&(i?(t[0]<i[0]&&(i[0]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[2]>i[2]&&(i[2]=t[2]),t[3]>i[3]&&(i[3]=t[3])):i=t);return i}return null},e.prototype.select=function(t,e){var i,o,s,n;if(null==e&&(e=!1),e)this.selectedObjects.add(t);else{for(n=this.selectedObjects.values(),o=0,s=n.length;s>o;o++)i=n[o],i!==t&&(i.selected=!1,this.emit("unselect",i));this.selectedObjects=new hx.List([t])}return t.selected=!0,this.emit("select",t)},e.prototype.unselect=function(t){return this.selectedObjects.remove(t)?(t.selected=!1,this.emit("unselect",t)):void 0},e.prototype.unselectAll=function(){var t,e,i,o;for(o=this.selectedObjects.values(),e=0,i=o.length;i>e;e++)t=o[e],t.selected=!1,this.emit("unselect",t);return this.selectedObjects.clear()},e.prototype.selected=function(){return this.selectedObjects.values()},e}(hx.EventEmitter),hx.Drawing=Drawing,Layer=function(){function t(t){this.drawing=t,this.objects=[],this.visible=!0,this.alpha=1,this.alphaCurveFunction=null}var e,i;return i=function(t,e){return function(i){return 1-Math.abs(2*(Math.log(i)-t)/(e-t)-1)}},e=function(t,e){return function(i){return 1+Math.min(2*(Math.log(i)-t)/(e-t)-1,0)}},t.prototype.render=function(){var t,e,i,o,s;if(this.alphaCurveFunction&&(this.alpha=hx.clampUnit(this.alphaCurveFunction(this.drawing.camera.actualZoom)),this.visible=this.alpha>.01),this.visible){for(this.drawing.setGlobalAlpha(this.alpha),o=this.objects,s=[],e=0,i=o.length;i>e;e++)t=o[e],s.push(t.render(this.drawing.ctx,this.drawing,0,0));return s}},t.prototype.create=function(t,e){var i;return i=function(){switch(t){case"circle":return new Circle(e);case"rectangle":return new Rectangle(e);case"line":return new Line(e);case"grid":return new Grid(e);case"text":return new Text(e);case"shape":return new Shape(e);case"composite":return new Composite(e)}}(),i&&this.objects.push(i),i},t.prototype["delete"]=function(t){var e;return e=this.objects.indexOf(t),-1!==e?this.objects.splice(e,1):void 0},t.prototype.deleteAll=function(){return void(this.objects=[])},t.prototype.find=function(t){var e,i,o,s;for(s=this.objects,i=0,o=s.length;o>i;i++)if(e=s[i],e.id===t)return e},t.prototype.findBy=function(t){var e,i,o,s;for(s=this.objects,i=0,o=s.length;o>i;i++)if(e=s[i],t(e))return e},t.prototype.getBoundingBox=function(){var t,e,i,o,s;if(this.objects.length>0){if(i=this.objects[0].getBoundingBox(this.drawing.ctx),this.objects.length>1)for(e=o=1,s=this.objects.length-1;s>=o;e=o+=1)t=this.objects[e].getBoundingBox(this.drawing.ctx),t&&(i?(t[0]<i[0]&&(i[0]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[2]>i[2]&&(i[2]=t[2]),t[3]>i[3]&&(i[3]=t[3])):i=t);return i}return null},t.prototype.setAlphaCurve=function(t,o,s){return this.alphaCurveFunction=function(){switch(t){case"triangle":return i(o,s);case"ramp":return e(o,s)}}()},t}(),PerformanceGauge=function(){function t(t){this.drawing=t,this.position=new Point(3,3),this.fps=void 0,this.ms=void 0,this.lastEnd=void 0,this.frameStart=void 0,this.frameEnd=void 0}return t.prototype.start=function(){return this.frameStart=(new Date).getTime()},t.prototype.end=function(){return this.lastEnd=this.frameEnd,this.frameEnd=(new Date).getTime()},t.prototype.update=function(){var t,e;return t=1e3/(this.frameEnd-this.lastEnd),isNaN(t)||(this.fps=this.fps?hx.tween(this.fps,t,.05):t),e=this.frameEnd-this.frameStart,this.ms=this.ms?hx.tween(this.ms,e,.05):e},t.prototype.render=function(){return this.drawing.ctx.fillStyle="rgba(0, 0, 40, 1)",this.drawing.ctx.strokeStyle="#ffffff",this.drawing.ctx.lineCap="square",this.drawing.ctx.lineWidth=1,this.drawing.ctx.fillRect(this.position.x,this.position.y,70,42),this.drawing.ctx.strokeRect(this.position.x,this.position.y,70,42),this.drawing.ctx.font="10pt Helvetica,Arial",this.drawing.ctx.fillStyle="#ffffff",this.drawing.ctx.fillText("FPS: "+Math.round(this.fps),8+this.position.x,18+this.position.y),this.drawing.ctx.fillStyle=this.ms<17?"#ffffff":"#ff5555",this.drawing.ctx.fillText("MS: "+Math.round(this.ms),8+this.position.x,33+this.position.y)},t}(),Circle=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.position={x:this.addNumberProperty("position.x"),y:this.addNumberProperty("position.y")},this.fill={enabled:this.addDiscreteProperty("fill.enabled",!0),color:this.addColorProperty("fill.color")},this.outline={enabled:this.addDiscreteProperty("outline.enabled",!1),width:this.addNumberProperty("outline.width"),color:this.addColorProperty("outline.color")},this.radius=this.addNumberProperty("radius",10)}return __extends(e,t),e.prototype.render=function(t,e,i,o){var s;return s=e.camera.getWorldRect(),s[0]-=i,s[1]-=o,s[2]-=i,s[3]-=o,this.position.x.value+this.radius.value>s[0]&&this.position.x.value-this.radius.value<s[2]&&this.position.y.value+this.radius.value>s[1]&&this.position.y.value-this.radius.value<s[3]&&(t.beginPath(),t.arc(this.position.x.value,this.position.y.value,this.radius.value,0,2*Math.PI,!0),t.closePath(),this.fill.enabled.value&&(e.setFillColor(this.fill.color.value),t.fill()),this.outline.enabled.value&&(e.setStrokeColor(this.outline.color.value),e.setStrokeWidth(this.outline.width.value),t.stroke()),this.selected)?this.drawBoundingBox(t,e):void 0},e.prototype.getBoundingBox=function(){return[this.position.x.value-this.radius.value,this.position.y.value-this.radius.value,this.position.x.value+this.radius.value,this.position.y.value+this.radius.value]},e}(DrawingObject),Composite=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.position={x:this.addNumberProperty("position.x"),y:this.addNumberProperty("position.y")},this.angle=this.addNumberProperty("angle"),this.scale=this.addNumberProperty("scale",1),this.objectList=new hx.List,this.objectMap=new hx.Map}return __extends(e,t),e.prototype.set=function(t,i,o,s){var n,r,a,h;return this.properties.has(t)||hx.startsWith(t,"attr.")?e.__super__.set.call(this,t,i,o,s):(n=t.split("."),n.length>1?(a=n[0],h=n.slice(1).join("."),r=this.objectMap.get(a),r?r.set(h,i):console.warn("unknown property: ",t,Error().stack)):console.warn("unknown property: ",t,Error().stack)),this},e.prototype.get=function(t){var i,o,s,n;return this.properties.has(t)||hx.startsWith(t,"attr.")?e.__super__.get.call(this,t):(i=t.split("."),i.length>1&&(s=i[0],n=i.slice(1).join("."),o=this.objectMap.get(s))?o.get(n):void 0)},e.prototype.create=function(t,i){var o;return o=function(){switch(t){case"circle":return new Circle;case"rectangle":return new Rectangle;case"line":return new Line;case"grid":return new Grid;case"text":return new Text;case"shape":return new Shape;case"composite":return new e}}(),o&&(this.objectList.add(o),this.objectMap.set(i,o)),this},e.prototype["delete"]=function(t){return this.objectList["delete"](object),this.objectMap["delete"](t)},e.prototype.render=function(t,e,i,o){var s,n,r,a,h,l;if(this.objectList.size>0&&(s=this.getBoundingBox(t),n=e.camera.getWorldRect(),n[0]-=i,n[1]-=o,n[2]-=i,n[3]-=o,!s||s[2]>n[0]&&s[0]<n[2]&&s[3]>n[1]&&s[1]<n[3]))for(l=this.objectList.values(),a=0,h=l.length;h>a;a++)r=l[a],t.save(),t.translate(this.position.x.value,this.position.y.value),t.scale(this.scale.value,this.scale.value),t.rotate(this.angle.value),r.render(t,e,this.position.x.value+i,this.position.y.value+o),t.restore();return this.selected?this.drawBoundingBox(t,e):void 0},e.prototype.getBoundingBox=function(t){var e,i,o,s,n;if(this.objectList.size>0){if(o=this.objectList.get(0).getBoundingBox(t),this.objectList.size>1)for(i=s=1,n=this.objectList.size-1;n>=s;i=s+=1)e=this.objectList.get(i).getBoundingBox(t),e&&(o?(e[0]<o[0]&&(o[0]=e[0]),e[1]<o[1]&&(o[1]=e[1]),e[2]>o[2]&&(o[2]=e[2]),e[3]>o[3]&&(o[3]=e[3])):o=e);return o[0]+=this.position.x.value,o[1]+=this.position.y.value,o[2]+=this.position.x.value,o[3]+=this.position.y.value,o}},e}(DrawingObject),Grid=function(t){function e(){var t,i;e.__super__.constructor.apply(this,arguments),this.position={x:this.addNumberProperty("position.x"),y:this.addNumberProperty("position.y")},this.cellSize={x:this.addNumberProperty("cellSize.x"),y:this.addNumberProperty("cellSize.y")},this.gridSize={x:this.addNumberProperty("gridSize.x"),y:this.addNumberProperty("gridSize.y")},this.gridLines={color:this.addColorProperty("gridLines.color"),width:this.addNumberProperty("gridLines.width"),enabled:this.addDiscreteProperty("gridLines.enabled",!1)},t=function(){var t,e;for(e=[],i=t=0;15>=t;i=t+=1)e.push(new DrawingColor(Math.random(),Math.random()/2,0,.5));return e}(),this.cells={enabled:this.addDiscreteProperty("cells.enabled",!1),states:this.addDiscreteProperty("cells.states",void 0),palette:this.addDiscreteProperty("cells.palette",t)}}return __extends(e,t),e.prototype.render=function(t,e,i,o){var s,n,r,a,h,l,u,c,p,d,v,y,f,g,x,m,w,b,P,S,T;if(n=e.camera.getWorldRect(),n[0]-=i,n[1]-=o,n[2]-=i,n[3]-=o,y=Math.max(0,Math.floor((n[0]-this.position.x.value)/this.cellSize.x.value)),f=Math.max(0,Math.floor((n[1]-this.position.y.value)/this.cellSize.y.value)),h=Math.min(this.gridSize.x.value-1,Math.ceil((n[2]-this.position.x.value)/this.cellSize.x.value)),l=Math.min(this.gridSize.y.value-1,Math.ceil((n[3]-this.position.y.value)/this.cellSize.y.value)),h>=y&&l>=f){if(this.cells.enabled.value)for(x=m=f;l>=m;x=m+=1)for(v=this.cells.states.value[x],g=w=y;h>=w;g=w+=1)s=v[g],e.setFillColor(this.cells.palette.value[s]),t.fillRect(this.position.x.value+g*this.cellSize.x.value+1,this.position.y.value+x*this.cellSize.y.value+1,this.cellSize.x.value-1,this.cellSize.y.value-1);if(this.gridLines.enabled){for(t.beginPath(),e.setStrokeColor(this.gridLines.color.value),e.setStrokeWidth(this.gridLines.width.value),e.setStrokeCap("square"),p=this.position.x.value,d=this.position.y.value,r=this.cellSize.x.value,a=this.cellSize.y.value,u=this.gridSize.x.value,c=this.gridSize.y.value,g=b=y,S=h+1;S>=b;g=b+=1)t.moveTo(p+g*r+.5,d+.5),t.lineTo(p+g*r+.5,d+a*c+.5);for(x=P=f,T=l+1;T>=P;x=P+=1)t.moveTo(p+.5,d+x*a+.5),t.lineTo(p+r*u+.5,d+x*a+.5);t.closePath(),t.stroke()}if(this.selected)return this.drawBoundingBox(t,e)}},e.prototype.getBoundingBox=function(){return[this.position.x.value,this.position.y.value,this.position.x.value+this.gridSize.x.value*this.cellSize.x.value,this.position.y.value+this.gridSize.y.value*this.cellSize.y.value]},e}(DrawingObject),Line=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.start={x:this.addNumberProperty("start.x"),y:this.addNumberProperty("start.y")},this.end={x:this.addNumberProperty("end.x"),y:this.addNumberProperty("end.y")},this.color=this.addColorProperty("color"),this.width=this.addNumberProperty("width")}return __extends(e,t),e.prototype.render=function(t,e,i,o){var s,n;return s=e.camera.getWorldRect(),s[0]-=i,s[1]-=o,s[2]-=i,s[3]-=o,n=0===this.width.value?Math.min(1,.95/e.camera.actualZoom):this.width.value,(pointRectangleIntersection(this.start.x.value,this.start.y.value,s[0]-n,s[1]-n,s[2]+n,s[3]+n)||pointRectangleIntersection(this.end.x.value,this.end.y.value,s[0]-n,s[1]-n,s[2]+n,s[3]+n)||horizontalLineIntersection(this.start.x.value,this.start.y.value,this.end.x.value,this.end.y.value,s[0]-n,s[2]+n,s[1]-n)||horizontalLineIntersection(this.start.x.value,this.start.y.value,this.end.x.value,this.end.y.value,s[0]-n,s[2]+n,s[3]+n)||verticalLineIntersection(this.start.x.value,this.start.y.value,this.end.x.value,this.end.y.value,s[1]-n,s[3]+n,s[0]-n)||verticalLineIntersection(this.start.x.value,this.start.y.value,this.end.x.value,this.end.y.value,s[1]-n,s[3]+n,s[2]+n))&&(t.beginPath(),e.setStrokeColor(this.color.value),e.setStrokeWidth(n),t.moveTo(this.start.x.value,this.start.y.value),t.lineTo(this.end.x.value,this.end.y.value),t.closePath(),t.stroke(),this.selected)?this.drawBoundingBox(t,e):void 0},e.prototype.getBoundingBox=function(){return[Math.min(this.start.x.value,this.end.x.value),Math.min(this.start.y.value,this.end.y.value),Math.max(this.start.x.value,this.end.x.value),Math.max(this.start.y.value,this.end.y.value)]},e}(DrawingObject),Rectangle=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.position={x:this.addNumberProperty("position.x"),y:this.addNumberProperty("position.y")},this.fill={enabled:this.addDiscreteProperty("fill.enabled",!0),color:this.addColorProperty("fill.color")},this.outline={enabled:this.addDiscreteProperty("outline.enabled",!1),width:this.addNumberProperty("outline.width"),color:this.addColorProperty("outline.color")},this.width=this.addNumberProperty("width",10),this.height=this.addNumberProperty("height",10)}return __extends(e,t),e.prototype.render=function(t,e,i,o){var s;return s=e.camera.getWorldRect(),s[0]-=i,s[1]-=o,s[2]-=i,s[3]-=o,this.position.x.value+this.width.value>s[0]&&this.position.x.value<s[2]&&this.position.y.value+this.height.value>s[1]&&this.position.y.value<s[3]&&(this.fill.enabled.value&&(e.setFillColor(this.fill.color.value),t.fillRect(this.position.x.value,this.position.y.value,this.width.value,this.height.value)),this.outline.enabled.value&&(e.setStrokeColor(this.outline.color.value),e.setStrokeWidth(this.outline.width.value),t.strokeRect(this.position.x.value,this.position.y.value,this.width.value,this.height.value)),this.selected)?this.drawBoundingBox(t,e):void 0},e.prototype.getBoundingBox=function(){return[this.position.x.value,this.position.y.value,this.position.x.value+this.width.value,this.position.y.value+this.height.value]},e}(DrawingObject),Shape=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.position={x:this.addNumberProperty("position.x"),y:this.addNumberProperty("position.y")},this.fill={enabled:this.addDiscreteProperty("fill.enabled",!0),color:this.addColorProperty("fill.color")},this.outline={enabled:this.addDiscreteProperty("outline.enabled",!1),width:this.addNumberProperty("outline.width"),color:this.addColorProperty("outline.color")},this.curve=this.addDiscreteProperty("curve",[]),
this.type=""}return __extends(e,t),e.prototype.set=function(t,i,o,s){return"curve"===t&&(this.type="curve"),"polygon"===t&&(this.type="polygon",t="curve"),e.__super__.set.call(this,t,i,o,s)},e.prototype.get=function(t){return"polygon"===t&&(t="curve"),e.__super__.get.call(this,t)},e.prototype.render=function(t,e,i,o){var s,n,r,a,h,l,u,c,p,d,v;if(s=this.getBoundingBox(t),n=e.camera.getWorldRect(),n[0]-=i,n[1]-=o,n[2]-=i,n[3]-=o,s&&s[2]>n[0]&&s[0]<n[2]&&s[3]>n[1]&&s[1]<n[3]){if(t.beginPath(),"polygon"===this.type)for(d=this.curve.value,r=l=0,c=d.length;c>l;r=++l)h=d[r],0===r?t.moveTo(this.position.x.value+h[0],this.position.y.value+h[1]):t.lineTo(this.position.x.value+h[0],this.position.y.value+h[1]);if("curve"===this.type)for(v=this.curve.value,r=u=0,p=v.length;p>u;r=++u)a=v[r],0===r?t.moveTo(this.position.x.value+a[0],this.position.y.value+a[1]):t.quadraticCurveTo(this.position.x.value+this.curve.value[r-1][2],this.position.y.value+this.curve.value[r-1][3],this.position.x.value+a[0],this.position.y.value+a[1]);if(t.closePath(),this.outline.enabled.value&&(e.setStrokeColor(this.outline.color.value),e.setStrokeWidth(this.outline.width.value),t.stroke()),this.fill.enabled.value&&(e.setFillColor(this.fill.color.value),t.fill()),this.selected)return this.drawBoundingBox(t,e)}},e.prototype.getBoundingBox=function(){var t,e,i,o,s,n,r,a,h,l,u,c;if("polygon"===this.type){for(i=o=this.curve.value[0][0],s=n=this.curve.value[0][1],u=this.curve.value,t=r=0,h=u.length;h>r;t=++r)e=u[t],e[0]<i&&(i=e[0]),e[1]<s&&(s=e[1]),e[0]>o&&(o=e[0]),e[1]>n&&(n=e[1]);return[this.position.x.value+i,this.position.y.value+s,this.position.x.value+o,this.position.y.value+n]}if("curve"===this.type){for(i=o=this.curve.value[0][0],s=n=this.curve.value[0][1],c=this.curve.value,t=a=0,l=c.length;l>a;t=++a)e=c[t],e[0]<i&&(i=e[0]),e[1]<s&&(s=e[1]),e[0]>o&&(o=e[0]),e[1]>n&&(n=e[1]),e[2]<i&&(i=e[2]),e[3]<s&&(s=e[3]),e[2]>o&&(o=e[2]),e[3]>n&&(n=e[3]);return[this.position.x.value+i,this.position.y.value+s,this.position.x.value+o,this.position.y.value+n]}},e}(DrawingObject),Text=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.position={x:this.addNumberProperty("position.x"),y:this.addNumberProperty("position.y")},this.color=this.addColorProperty("color"),this.size=this.addNumberProperty("size",12),this.align={x:this.addDiscreteProperty("align.x","start"),y:this.addDiscreteProperty("align.y","top")},this.font=this.addDiscreteProperty("font","Helvetica,Arial"),this.text=this.addStringProperty("text")}return __extends(e,t),e.prototype.render=function(t,e,i,o){var s,n;return s=this.getBoundingBox(t),n=e.camera.getWorldRect(),n[0]-=i,n[1]-=o,n[2]-=i,n[3]-=o,s[2]>n[0]&&s[0]<n[2]&&s[3]>n[1]&&s[1]<n[3]&&(t.font="12px "+this.font.value,e.setFillColor(this.color.value),t.save(),t.scale(this.size.value/12,this.size.value/12),t.textAlign=this.align.x.value,t.textBaseline=this.align.y.value,t.fillText(this.text.value,this.position.x.value/(this.size.value/12),this.position.y.value/(this.size.value/12)),t.restore(),this.selected)?this.drawBoundingBox(t,e):void 0},e.prototype.getWidth=function(t){return void 0===this.textWidth&&(t.font="12px "+this.font.value,t.save(),t.setTransform(1,0,0,1,0,0),this.textWidth=t.measureText(this.text.value).width,t.restore()),this.textWidth},e.prototype.getBoundingBox=function(t){var e,i,o,s;switch(i=this.getWidth(t)*(this.size.value/12),e=this.size.value,this.align.x.value){case"start":o=0;break;case"end":o=i;break;case"center":o=i/2;break;default:o=0}switch(this.align.y.value){case"top":s=0;break;case"end":s=e;break;case"middle":s=e/2;break;default:s=0}return[this.position.x.value-o,this.position.y.value-s,this.position.x.value+i-o,this.position.y.value+e-s]},e}(DrawingObject);})();(function(){var Table,TableFeed,TableFeedModifiers,__hasProp={}.hasOwnProperty,__extends=function(e,t){function o(){this.constructor=e}for(var r in t)__hasProp.call(t,r)&&(e[r]=t[r]);return o.prototype=t.prototype,e.prototype=new o,e.__super__=t.prototype,e};TableFeed=function(e){function t(e,o,r){var n;switch(this.modifiers=o,this.extra=r,t.__super__.constructor.apply(this,arguments),n=this,this.sortedData=void 0,this.filteredData=void 0,!1){case!hx.isFunction(e):this.source=e;break;case!hx.isString(e):this.source=function(t,o){return hx.json(e,t,function(e,r){if(e)return o(void 0),n.emit("error",e);switch(t.type){case"header":return o(r.head);case"rowCount":return o(r.count);case"rows":return o(r.rows,r.processedSize)}})};break;default:this.source=function(t,o){switch(t.type){case"header":return o(e.head);case"rowCount":return o(e.body.length);case"rows":return n.getProcessedData(function(e){return o(e.slice(t.startRow,t.endRow),e.length)});case"data":return o(e)}}}this.modifiers.on("sort-change",function(e){return function(t){return e.sortedData=void 0,e.emit("sort-change",t)}}(this)),this.modifiers.on("filter-change",function(e){return function(t){return e.filteredData=void 0,e.emit("filter-change",t)}}(this)),this.modifiers.pipe(this,void 0,["change"])}var o;return __extends(t,e),o=function(e){return e.slice()},t.prototype.getFilteredData=function(e){return void 0===this.filteredData&&this.source({type:"data"},function(e){return function(t){var r,n,i,l,s,a,c,u,d,h,p,f,v,w,b,x,m;h=t.body,u=t.head,a=function(e){var t,o,r,n,i,l;for(r=e.toLowerCase(),l=u.columns,o=n=0,i=l.length;i>n;o=++n)if(t=l[o],t.value.toLowerCase()===r)return o;return void 0},c=!1,d={};for(i in e.modifiers.filters){n=e.modifiers.cellFilterValueLookup[i]||e.modifiers.cellValueLookup[i]||e.modifiers.defaultCellFilterValueLookup||e.modifiers.defaultCellValueLookup||function(e){return e},l=a(i),b=e.modifiers.filters[i];for(f in b)p=b[f],void 0!==p&&(c=!0,"string"==typeof p&&(p=p.split(" ").map(function(e){return e.trim()}).filter(function(e){return e})),null==d[f]&&(d[f]=[]),d[f].push({columnIndex:l,terms:p,cellLookup:n}))}if(c){for(s=function(e,t){var o,r,i,l,s,a,c,u,h,f;for(h=d[t],s=0,c=h.length;c>s;s++)if(r=h[s],o=r.columnIndex,n=r.cellLookup,i={caseSensitive:!1,searchValues:function(e){return e.columns?[n(e.columns[o])]:[n(e[o])]},sort:!1},hx.isArray(p))for(f=r.terms,a=0,u=f.length;u>a;a++)l=f[a],e=hx.filter[t](e,l,i);else e=hx.filter[t](e,p,i);return e},r=Object.keys(hx.filter),e.filteredData=o(h),m=[],v=0,w=r.length;w>v;v++)f=r[v],m.push((null!=(x=d[f])?x.length:void 0)>0?e.filteredData=s(e.filteredData,f):void 0);return m}return e.filteredData=h}}(this)),e(this.filteredData)},t.prototype.getSortedData=function(e){return void 0===this.filteredData&&(this.sortedData=void 0),this.getFilteredData(function(t){return function(r){var n,i;return void 0===t.sortedData&&(void 0!==t.modifiers.sortColumn&&void 0!==t.modifiers.sortDirection?(i=t.modifiers.sortColumn.toLowerCase(),n=t.modifiers.cellSortValueLookup[i]||t.modifiers.cellValueLookup[i]||t.modifiers.defaultCellSortValueLookup||t.modifiers.defaultCellValueLookup||function(e){return e},t.getColumnIndex(t.modifiers.sortColumn,function(e){var i,l;return l=t.modifiers.sortDirection?1:-1,t.sortedData=o(r),i=hx.sort.localeCompare(),t.sortedData.sort(function(t,o){return i(n((t.columns||t)[e]),n((o.columns||o)[e]))*l})})):t.sortedData=r),e(t.sortedData)}}(this))},t.prototype.getProcessedData=function(e){return this.getSortedData(e)},t.prototype.getHeader=function(e){return this.source({type:"header",extra:this.extra},e)},t.prototype.getRows=function(e,t,o){return this.source({type:"rows",startRow:e,endRow:t,filters:this.modifiers.filters,sortColumn:this.modifiers.sortColumn,sortDirection:this.modifiers.sortDirection,extra:this.extra},o)},t.prototype.getRowCount=function(e){return this.source({type:"rowCount",extra:this.extra},e)},t.prototype.getColumnIndex=function(e,t){return this.getHeader(function(o){var r,n,i,l,s,a;for(i=e.toLowerCase(),a=o.columns,n=l=0,s=a.length;s>l;n=++l)if(r=a[n],r.value.toLowerCase()===i)return void t(n);return t(void 0)})},t}(hx.EventEmitter),TableFeedModifiers=function(e){function t(){var e;t.__super__.constructor.apply(this,arguments),e=this,this.filters={},this.sortDirection=void 0,this.sortColumn=void 0,this.defaultCellValueLookup=void 0,this.defaultCellFilterValueLookup=void 0,this.defaultCellSortValueLookup=void 0,this.cellValueLookup={},this.cellFilterValueLookup={},this.cellSortValueLookup={}}var o;return __extends(t,e),o=function(e){switch(e){case"ascending":case"asc":case!0:return!0;case"descending":case"desc":case!1:return!1;default:return void 0}},t.prototype.sort=function(e,t,r){var n;return t=o(t),n=!1,1===arguments.length?(this.sortDirection=function(){switch(!1){case this.sortColumn===e:return!0;case this.sortDirection!==!0:return!1;case this.sortDirection!==!1:return void 0;default:return!0}}.call(this),this.sortColumn=e,n=!0):(this.sortDirection!==t||this.sortColumn!==e)&&(this.sortDirection=t,this.sortColumn=e,void 0===this.sortColumn&&(this.sortDirection=void 0),n=!0),n?(this.emit("sort-change",{column:this.sortColumn,direction:this.sortDirection}),this.emit("change",{callback:r})):void 0},t.prototype.filter=function(e,t,o,r){var n,i,l;return null==o&&(o="contains"),void 0!==e&&(null==(l=this.filters)[e]&&(l[e]={}),n=this.filters[e][o]!==t,n&&(i=this.filters[e][o],this.filters[e][o]=t,this.emit("filter-change",{column:e,type:o,filter:t,oldFilter:i}),this.emit("change",{callback:r}))),this},t.prototype.addFilter=function(e,t,o,r){var n,i,l,s,a;for(null==o&&(o="contains"),s=t.split(" "),i=0,l=s.length;l>i;i++)n=s[i],void 0!==(null!=(a=this.filters[e])?a[o]:void 0)?-1===this.filters[e][o].indexOf(n)&&this.filter(e,this.filters[e][o]+" "+n,o,r):this.filter(e,n,o,r);return this},t.prototype.removeFilter=function(e,t,o,r){var n,i,l,s,a,c,u,d;if(n=function(e){var o,r,n,i,l;for(r=e.split(" ").map(function(e){return e.toLowerCase()}),l=t.split(" ").map(function(e){return e.toLowerCase()}),n=0,i=l.length;i>n;n++)o=l[n],r=r.filter(function(e){return e!==o});return r=r.join(" "),""===r?void 0:r},0===arguments.length)for(l in this.filters){a=this.filters[l];for(i in a)s=a[i],this.filter(l,void 0,i,r)}else if(2===arguments.length||void 0!==o)if(null==o&&(o="contains"),void 0===e){c=this.filters;for(l in c)s=c[l],this.filter(l,n(s[o]),o,r)}else void 0!==this.filters[e]&&this.filters[e][o]&&this.filter(e,n(this.filters[e][o]),o,r);else if(void 0===e)for(l in this.filters){u=this.filters[l];for(o in u)s=u[o],this.filter(l,n(s),o,r)}else if(void 0!==this.filters[e]){d=this.filters[e];for(o in d)s=d[o],this.filter(e,n(s),o,r)}return this},t}(hx.EventEmitter),Table=function(e){function t(e,o){var l;null==o&&(o={}),t.__super__.constructor.apply(this,arguments),this.options=hx.merge(!1,{rowsPerPage:100,showSorts:!0,showFilters:!0,showSelection:!1,rowSelectable:!0,cellRenderers:{},alwaysMobile:!1,useResponsive:!0,noDataMessage:"No Data",defaultCellValueLookup:void 0,defaultCellFilterValueLookup:void 0,defaultCellSortValueLookup:void 0,cellValueLookup:{},cellFilterLookup:{},cellSortValueLookup:{},enabledFilters:["exact","startsWith","less","greater","excludes"]},o),l=this._={selectedRows:[]},l.container=hx.select(e).classed("hx-table-widget hx-layout hx-group hx-vertical",!0),l.tableWrapper=l.container.append("div")["class"]("hx-section hx-table-wrapper hx-no-margin"),l.tableMessage=l.container.append("div")["class"]("hx-section hx-table-message"),l.rowCountMessage=hx.select(document.createElement("div")),l.rowCountMessage.append("span"),l.rowCountMessage.append("a").text("(clear selection)").on("click",function(e){return function(t){return t.preventDefault(),e.clearSelection()}}(this)),l.paginatorContainer=l.container.append("div")["class"]("hx-section hx-table-paginator"),this.paginator=new hx.Paginator(l.paginatorContainer.node()),this.paginator.on("change",function(e){return function(t){return"user"===t.cause?n(e):void 0}}(this)),l.modifiers=new TableFeedModifiers,l.modifiers.defaultCellValueLookup=this.options.defaultCellValueLookup,l.modifiers.defaultCellFilterValueLookup=this.options.defaultCellFilterValueLookup,l.modifiers.defaultCellSortValueLookup=this.options.defaultCellSortValueLookup,l.modifiers.cellValueLookup=r(this.options.cellValueLookup),l.modifiers.cellFilterValueLookup=r(this.options.cellFilterValueLookup),l.modifiers.cellSortValueLookup=r(this.options.cellSortValueLookup),l.feedChange=function(e){return function(t){return n(e,t),e.emit("change")}}(this),l.sortChange=function(e){return function(t){var o,r,n,s;return l.rendered&&(l.useMobileView||(s=l.header.columns.map(function(e){return e.value.toLowerCase()}),r=s.indexOf(t.column.toLowerCase()),-1!==r&&(i(l.tableWrapper.selectAll(".hx-table-sort-icon")),o=l.tableWrapper.select(".hx-table-header-sticky").selectAll(".hx-table-sort-icon"),n=o.node(r),i(hx.select(n),t.direction))),e.clearSelection()),e.paginator.setPage(1),e.emit("sort-change",t)}}(this),l.filterChange=function(e){return function(t){return e.paginator.setPage(1),e.clearSelection(),e.emit("filter-change",t)}}(this)}var o,r,n,i,l;return __extends(t,e),r=function(e){var t,o,r;o={};for(t in e)__hasProp.call(e,t)&&(r=e[t],o[t.toLowerCase()]=r);return o},t.prototype.setData=function(e,t,o,r,i){var l,s;return l=this._,null!=(s=l.feed)&&s.deregisterAll(),l.modifiers.deregisterAll(),o&&l.modifiers.sort(),r&&l.modifiers.removeFilter(),l.feed=new TableFeed(e,l.modifiers,t),l.feed.on("change",function(e){return l.feedChange(e.callback)}),l.feed.on("sort-change",l.sortChange),l.feed.on("filter-change",l.filterChange),l.newSource=!0,l.selectedRows=[],this.paginator.setPage(1),n(this,i),this},t.prototype.render=function(e){return n(this,e)},t.prototype.filter=function(e,t,o,r){return this._.modifiers.filter(e,t,o,r)},t.prototype.addFilter=function(e,t,o,r){return this._.modifiers.addFilter(e,t,o,r)},t.prototype.removeFilter=function(e,t,o,r){return this._.modifiers.removeFilter(e,t,o,r)},t.prototype.sort=function(e,t,o){return this._.modifiers.sort(e,t,o)},t.prototype.getSelected=function(){var e,t,o,r,n;for(r=this._.selectedRows,n=[],t=0,o=r.length;o>t;t++)e=r[t],e&&n.push(e);return n},t.prototype.clearSelection=function(){var e;return e=this._,e.tableWrapper.selectAll(".hx-table-row-selected").classed("hx-table-row-selected",!1),e.selectedRows=e.selectedRows.map(function(e){return!1}),l(this),this.emit("clearselection")},i=function(e,t){return e.classed("fa-sort-asc",t===!0).classed("fa-sort-desc",t===!1).classed("fa-unsorted",void 0===t)},l=function(e){var t,o,r,n,i,l,s,a;for(s=e._,l=s.selectedRows.filter(function(e){return e}).length,l>0?(void 0!==s.rowCount?s.rowCountMessage.select("span").text(l+" of "+s.rowCount+" rows selected "):(n=l>1?"s":"",s.rowCountMessage.select("span").text(l+" row"+n+" selected ")),s.tableMessage.node().appendChild(s.rowCountMessage.node())):s.tableMessage.text(""),r=0,i=s.startRowIndex,t=i+s.rows.length,o=a=i;t>=a;o=a+=1)s.selectedRows[o]&&r++;return s.tableWrapper.selectAll("thead").select("tr").classed("hx-table-row-selected",r>0)},o=function(e,t,o,r){var n,i,l,s,a,c,u;return u=r._,l={},s={},a={},c=function(e){var t,n,i,c,d,h,p,f,v,w,b,x,m,g;if(n=this,i=hx.select(e).classed("hx-table-filter-dropdown",!0),t=function(e,t){var i,c,d,h,p;return d=void 0,p=function(e){return a[t]=l[t].value(),u.modifiers.filter(o,e,t)},"contains"!==t?(h="greater"===t||"less"===t?t+" than":"startsWith"===t?"Starts with":t,h=h.charAt(0).toUpperCase()+h.slice(1),c=h+" filters..."):c="Filters...",s[t]=e.append("div").classed("hx-table-input-group hx-input-group",!0),l[t]=s[t].append("input").attr("placeholder",c).value(a[t]),"regex"===t?l[t].on("input",function(e){return function(){return clearTimeout(d),d=setTimeout(function(){var e,o,r;if(r=l[t].value(),l[t].style("border-color",""),r.length>0){try{o=new RegExp(r)}catch(n){e=n}return e?l[t].style("border-color","red"):p(o)}return p()},200)}}(this)):l[t].on("input",function(e){return clearTimeout(d),d=setTimeout(function(){return p(l[t].value())},200)}).on("keydown",function(e){var t;return t=e.keyCode?e.keyCode:e.which,27===t&&p(),13===t||27===t?n.hide():void 0}),i=s[t].append("button")["class"]("hx-btn hx-btn-negative"),i.append("i")["class"]("fa fa-times"),i.on("click",function(){return l[t].value(""),p(),0===r.options.enabledFilters.length?n.hide():void 0})},t(i,"contains"),r.options.enabledFilters.length>0){for(f=!1,p=function(e,t){var o;return o=e?"Less":"More",h.text(o),t?d.style("display",e?"block":"none"):d.morph()["with"](e?"expand":"collapse",150).go(),f=e},h=i.append("div")["class"]("hx-table-more-filters-link").append("a"),d=i.append("div")["class"]("hx-table-more-filters"),p(!1,!0),h.on("click",function(){return p("none"===d.style("display"))}),v=u.modifiers.filters[o],x=r.options.enabledFilters,g=[],w=0,b=x.length;b>w;w++)c=x[w],"contains"!==c?((null!=(m=a[c])?m.length:void 0)>0&&f===!1&&p(!0,!0),g.push(t(d,c))):g.push(void 0);return g}},n=u.useMobileView?"lblt":"rbrt",i=new hx.Dropdown(e,c,"",n,0),i.on("show",function(){return u.filterDropdown=i,l.contains.node().focus()}),hx.select(t).on("click",function(e){return e.stopPropagation(),i.toggle()})},n=function(e,t){var n,s,a,c,u,d,h,p,f,v,w,b,x,m,g,y,C,k,L,R,D,S,V,_;return _=e._,_.modifiers.defaultCellValueLookup=e.options.defaultCellValueLookup,_.modifiers.defaultCellFilterValueLookup=e.options.defaultCellFilterValueLookup,_.modifiers.defaultCellSortValueLookup=e.options.defaultCellSortValueLookup,_.modifiers.cellValueLookup=r(e.options.cellValueLookup),_.modifiers.cellFilterValueLookup=r(e.options.cellFilterValueLookup),_.modifiers.cellSortValueLookup=r(e.options.cellSortValueLookup),_.lastRowSelected,_.shiftWasDown=!1,k=e.options.showSelection,g=null!=e.options.collapsibleRow,C=e.options.rowSelectable&&k&&!g,D=e.options.showSorts,s=e.options.showFilters,_.useMobileView=e.options.alwaysMobile?!0:e.options.useResponsive?_.container.width()<480:!1,n=function(e){return _.container.classed("hx-table-loading",!0),setTimeout(e,0)},u=function(e){return _.feed.getHeader(function(t){return _.header=t,e()})},d=function(e){return _.feed.getRowCount(function(t){return _.rowCount=t,0===t&&(k=!1,g=!1,C=!1,D=!1,s=!1),e()})},V=function(t){var o;return void 0===_.processedSize?(e.paginator.setPageCount(void 0),_.paginatorContainer.style("display","")):(o=Math.ceil(_.processedSize/e.options.rowsPerPage),o>1?(e.paginator.setPageCount(o),_.paginatorContainer.style("display","")):_.paginatorContainer.style("display","none")),t()},c=function(t){var o,r;return o=e.paginator.getPage()-1||0,r=e.options.rowsPerPage,_.feed.getRows(o*r,(o+1)*r,function(e,o){return _.rows=e,_.processedSize=o,t()})},p=function(e){var t;return _.newSource&&(_.tableWrapper.selectAll("table").remove(),t=_.tableWrapper.append("table")["class"]("hx-table hx-table-non-sticky"),t.append("thead").append("tr")["class"]("hx-table-header-row"),t.append("tbody"),t=_.tableWrapper.append("table")["class"]("hx-table hx-table-header-sticky"),t.append("thead").append("tr")["class"]("hx-table-header-row")),e()},y=function(e){var t;return t=e.append("th")["class"]("hx-table-cell hx-table-selection"),t.append("i")["class"]("fa fa-check"),t.node()},h=function(e,t){var o,r,n,i;return 0===t&&k?y(this):(o=this.append("th"),r=o.append("div"),n=r.append("span")["class"]("hx-table-header-left"),i=r.append("span")["class"]("hx-table-header-right"),n.append("span")["class"]("hx-table-header-name"),n.append("i")["class"]("hx-table-sort-icon fa fa-unsorted"),i.append("i")["class"]("fa fa-search"),o.node())},v=function(e){var t,o,r,n,i,l,a,c,u;return a=function(e,t,o){return 0!==o&&k||!k?(this.select(".hx-table-header-name").text(e.value),this.classed("hx-table-header-sort",D),this.classed("hx-table-header-filter",s)):void 0},i=function(e,t){var o;return o=this.append("th"),o.append("div")["class"]("hx-table-header-grouped-cell"),o.node()},l=function(e,t,o,r,n){return k&&e.unshift(void 0),hx.select(t).view("th").enter(i).update(function(e){var t;return null!=e&&(t=e[1]?e[1]:0===o?e[0]:void 0,this.attr("colspan",e[2]),this.select(".hx-table-header-grouped-cell").text(t)),e}).apply(e),t},_.header.columns.some(function(e){return null!=(null!=e?e.groups:void 0)})&&(n=_.header.columns,o=n.map(function(e){var t;return 1*((null!=e&&null!=(t=e.groups)?t.length:void 0)||0)}),t=hx.max(o),r=function(){u=[];for(var e=0;t>=0?t>e:e>t;t>=0?e++:e--)u.push(e);return u}.apply(this).map(function(e){return n.map(function(o){var r,n;if(null!=(null!=o?o.groups:void 0)){for(r=o.groups.slice(0),n=r[0];r.length<t;)r.unshift("");return[r.slice(0,+e+1||9e9).toString(),r[e]]}return["",""]})}),c=r.map(function(e){var t,o;return e.reduce(function(e,t){return t[0]===e[e.length-1][0]?(e[e.length-1][2]+=1,e):e.concat([[t[0],t[1],1]])},[[null!=(t=e[0])?t[0]:void 0,null!=(o=e[0])?o[1]:void 0,0]])}),_.tableWrapper.select("table").select("thead").view(".hx-table-header-group-row","tr").update(function(e,o,r){return l(e,o,r,t,c)}).apply(c)),n=k?[void 0].concat(_.header.columns):_.header.columns,_.tableWrapper.select("table").select("thead").select(".hx-table-header-row").view("th").enter(h).update(a).apply(n),e()},m=function(t){var r,n,i,a,c;return a=function(t,r){var n,i,s;return n=h.call(this,t,r),0===r&&k?hx.select(n).on("click",function(t){var o,r;return t.stopPropagation(),r=hx.select(n.parentNode),o=r.classed("hx-table-row-selected"),r.classed("hx-table-row-selected",!o),e._.lastRowSelected=void 0,L(0,e._.rows.length-1),l(e)}):(i=hx.select(n).select(".hx-table-header-left"),s=hx.select(n).select(".hx-table-header-right"),o(n,s.node(),t.value.toLowerCase(),e)),n},c=function(e,t,o){return 0===o&&k&&k||(this.select(".hx-table-header-name").text(e.value),this.classed("hx-table-header-sort",D),this.classed("hx-table-header-filter",s)),this.select(".hx-table-header-left").on("click",function(){return D?_.modifiers.sort(e.value):void 0})},i=_.tableWrapper.select(".hx-table-header-sticky"),i.style("top",_.tableWrapper.node().scrollTop+"px"),n=k?[void 0].concat(_.header.columns):_.header.columns,i.select("thead").select(".hx-table-header-row").view("th").enter(a).update(c).apply(n),i.selectAll(".hx-table-header-group-row").remove(),r=_.tableWrapper.selectAll(".hx-table-header-group-row"),r.empty()||r.each(function(e){return i.select(".hx-table-header-row").insertBefore(e.cloneNode(!0))}),_.tableWrapper.on("scroll",function(e){return i.style("top",_.tableWrapper.node().scrollTop+"px")}),t()},x=function(e){return _.useMobileView?(_.tableWrapper.selectAll("thead").remove(),e()):v(function(){return m(function(){return e()})})},R=function(t,o,r,n,i,s){var a,c,u;return n&&null!=_.lastRowSelected?(_.shiftWasDown=!0,L(_.lastRowSelected,r),_.lastRowSelected=r):(_.shiftWasDown=!1,a=t.classed("hx-table-row-selected"),null!=r&&(_.lastRowSelected=r),c=null!=i?!i:t.classed("hx-table-row-selected"),!c!==a?(u=_.rows[r],c?delete _.selectedRows[o]:_.selectedRows[o]=u,e.has("rowselect")&&e.emit("rowselect",{rowData:u,selected:!c})):_.selectedRows[o]=void 0,t.classed("hx-table-row-selected",!c)),void(s||l(e))},L=function(t,o,r){var n,i,s,a,c,u,d,h,p;for(s=o,t>o&&(o=t,t=s,s=o),c=_.tableWrapper.select("tbody").selectAll("tr").nodes.map(hx.select),n=[],i=d=t;o>=d;i=d+=1)a=_.startRowIndex+i,n.push({row:c[i],index:a,isSelected:void 0!==_.selectedRows[a]});for(null==r&&n.some(function(e){return!e.isSelected&&e.index!==_.lastRowSelected})&&(r=!0),null==r&&_.shiftWasDown&&(r=!1),h=0,p=n.length;p>h;h++)u=n[h],(u.index!==_.lastRowSelected||_.shiftWasDown)&&R(u.row,u.index,u.index-_.startRowIndex,!1,r,!0);return void l(e)},f=function(t){var o,r,n,i,s,a,c,u,d,h,p,f;i=e.options.defaultCellRenderer||function(e,t,o){return this.text(e)},d=function(e,t,o,r){var n,i;return n=_.startRowIndex+r,i=hx.select(t.parentNode),i.classed("hx-table-row-selected",!!_.selectedRows[n]),this.on("click",function(e){return e.stopPropagation(),R(i,n,r,e.shiftKey)})},a={},f=e.options.cellRenderers;for(s in f)p=f[s],a[s.toLowerCase()]=p;return c=_.header.columns.map(function(e){return a[e.value.toLowerCase()]||i}),k&&(c=[d].concat(c)),r=function(e,t){return 0===t&&k?y(this,e,t):this.append("td")["class"]("hx-table-cell").node()},n=function(e,t,o,r){return c[o].call(this,e,t,o,r)},u=function(t,o,i){var l,s,a,c,u,d,h;return d=i,_.startRowIndex=(e.paginator.getPage()-1)*e.options.rowsPerPage,c=t.columns?t.columns:t,u=k?[void 0].concat(c):c,this.view(".hx-table-cell").enter(r).update(function(e,t,o){return n.call(this,e,t,o,d)}).apply(u),C&&this.on("click",function(e){return function(t){return t.stopPropagation(),R(e,_.startRowIndex+i,d,t.shiftKey)}}(this)),g?(a=!1,l=function(o){var r,n,i,l,s;return n=hx.select(document.createElement("tr")).classed("hx-collapsible-content-row",!0),i=hx.select(document.createElement("tr")).classed("hx-collapsible-content-row-hidden",!0),k&&n.append("th"),r=n.append("td").attr("colspan","99").style("padding","10px").append("div").classed("hx-collapsible-content",!0),l=o.nextElementSibling,s=o.parentNode,l?(s.insertBefore(i.node(),l),s.insertBefore(n.node(),l)):(a=!0,n.classed("hx-lastrow",!0),s.appendChild(i.node()),s.appendChild(n.node())),e.options.collapsibleRow(r.node(),t),{contentRow:n,hiddenRow:i,visible:!1}},h=function(){var e;return e=s,a&&hx.select(o).classed("hx-lastrow",e.visible),e.visible?(e.visible=!1,e.contentRow.style("display","none"),e.hiddenRow.style("display","none")):(e.visible=!0,e.contentRow.style("display",""),e.hiddenRow.style("display",""))},s=void 0,this.on("click",function(o){return function(r){return null==s&&(s=l(o.node())),h(),e.has("rowcollapsible")?e.emit("rowcollapsible",{rowData:t,isOpen:s.visible}):void 0}}(this))):void 0},_.tableWrapper.select(".hx-table-non-sticky").classed("hx-table-mobile",!1),_.tableWrapper.selectAll(".hx-collapsible-content-row").remove(),_.tableWrapper.selectAll(".hx-collapsible-content-row-hidden").remove(),_.rows.length>0?(o=_.tableWrapper.select(".hx-table-non-sticky").select("tbody"),o.select(".hx-table-no-data").remove(),o.view("tr","tr").update(u).apply(_.rows)):(h=_.tableWrapper.select(".hx-table-non-sticky"),h.select("tbody").remove(),h.append("tbody").append("tr")["class"]("hx-table-no-data").append("td").attr("colspan",99).text(e.options.noDataMessage)),l(e),t()},w=function(t){var r,n,a,c,u,d,h,p,f;return n=e.options.defaultCellRenderer||function(e,t,o){return this.text(e)},a=_.header.columns.map(function(t){return e.options.cellRenderers[t.value.toLowerCase()]||n}),r=function(e,t,o,r){return a[o].call(this,e,t,o,r)},c=function(t,r,n){var i,l,s,a,c;return a=this.append("tr")["class"]("hx-table-responsive-row"),0===r&&a.classed("hx-table-responsive-row-first",!0),c=a.append("th"),i=c.append("div"),s=i.append("span")["class"]("hx-table-header-right"),l=i.append("span")["class"]("hx-table-header-left"),l.append("i")["class"]("hx-table-sort-icon fa"),l.append("span")["class"]("hx-table-header-name"),s.append("i")["class"]("fa fa-search"),o(s.node(),s.node(),t[0].toLowerCase(),e),a.append("td"),a.node()},u=function(e,t,o,n){var l,a,c;return a=this.select("td"),a.attr("rowspan",""),a.style("display",""),r.call(a,e[1],a.node(),o,n),c=this.select("th"),this.select(".hx-table-header-name").text(e[0]),c.classed("hx-table-header-sort",D&&0===n),c.classed("hx-table-header-filter",s&&0===n),this.select(".hx-table-header-left").on("click",function(t){return D?(t.stopPropagation(),_.modifiers.sort(e[0])):void 0}),l=_.modifiers.sortColumn===e[0]?_.modifiers.sortDirection:void 0,i(this.select(".hx-table-sort-icon"),l)},d=function(t,o,r,n){var l,a,c;return a=this.select("td"),0===r?(a.text(e.options.noDataMessage),a.style("display",""),a.attr("rowspan",_.header.columns.length+1)):(a.text(""),a.style("display","none")),c=this.select("th"),this.select(".hx-table-header-name").text(t),c.classed("hx-table-header-sort",D&&0===n),c.classed("hx-table-header-filter",s&&0===n),this.select(".hx-table-header-left").on("click",function(e){return D?(e.stopPropagation(),_.modifiers.sort(t[0])):void 0}),l=_.modifiers.sortColumn===t[0]?_.modifiers.sortDirection:void 0,i(this.select(".hx-table-sort-icon"),l)},h=function(){var e,t;return e=this.append("tbody"),k&&(t=e.append("tr").append("th")["class"]("hx-table-selection").attr("rowspan",_.header.columns.length+1),t.append("i")["class"]("fa fa-check")),e.node()},p=function(t,o,r){var n,i,l,s,a;return l=_.header.columns.map(function(e){return e.value}),s=r,_.startRowIndex=(e.paginator.getPage()-1)*e.options.rowsPerPage,this.classed("hx-table-no-data",void 0===t),void 0===t?this.view(".hx-table-responsive-row").enter(function(e,t){return c.call(this,e,t,s)}).update(function(e,t,o){return d.call(this,e,t,o,s)}).apply(l):this.view(".hx-table-responsive-row").enter(function(e,t){return c.call(this,e,t,s)}).update(function(e,t,o){return u.call(this,e,t,o,s)}).apply(hx.zip([l,t])),k&&this.select(".hx-table-selection").on("click",function(e){return function(o){return void 0!==t?(o.stopPropagation(),R(e,_.startRowIndex+r,s,o.shiftKey)):void 0}}(this)),C&&this.on("click",function(e){return function(o){return void 0!==t?(o.stopPropagation(),R(e,_.startRowIndex+r,s,o.shiftKey)):void 0}}(this)),g?(n=function(o){var r,n,i;return n=hx.select(document.createElement("tr")).classed("hx-collapsible-content-row",!0),i=hx.select(document.createElement("tr")).classed("hx-collapsible-content-row-hidden",!0),n.append("th"),k&&n.append("th"),r=n.append("td").attr("colspan","99").style("padding","10px").append("div").classed("hx-collapsible-content",!0),n.classed("hx-lastrow",!0),o.appendChild(i.node()),o.appendChild(n.node()),e.options.collapsibleRow(r.node(),t),{contentRow:n,hiddenRow:i,visible:!1}},a=function(e){return function(){var t,o;return t=i,o=e.selectAll(".hx-table-responsive-row"),hx.select(o.node(o.size()-1)).classed("hx-lastrow",t.visible),t.visible?(t.visible=!1,t.contentRow.style("display","none"),t.hiddenRow.style("display","none")):(t.visible=!0,t.contentRow.style("display",""),t.hiddenRow.style("display",""))}}(this),i=void 0,this.on("click",function(o){return function(r){var l;return null!=i&&(l=r.target.contains(i.contentRow.node())),!l&&(null==i&&(i=n(o.node())),a(),e.has("rowcollapsible"))?e.emit("rowcollapsible",{rowData:t,isOpen:i.visible}):void 0}}(this))):void 0},_.tableWrapper.select(".hx-table-non-sticky").classed("hx-table-mobile",!0),f=_.rows.length>0?_.rows:[void 0],_.tableWrapper.on("scroll",function(e){return null!=_.filterDropdown?(_.filterDropdown.hide(),_.filterDropdown=void 0):void 0}),_.tableWrapper.select(".hx-table-non-sticky").select("tbody").remove(),_.tableWrapper.select(".hx-table-non-sticky").view("tbody").enter(h).update(p).apply(f),l(e),t()},b=function(e){return _.useMobileView?w(e):f(e)},a=function(e){var t,o;return o=_.tableWrapper.select(".hx-table-non-sticky").style("width"),_.tableWrapper.select(".hx-table-header-sticky").style("width",o),t=_.tableWrapper.select(".hx-table-non-sticky").select("thead").select(".hx-table-header-row").selectAll("th").style("width"),_.tableWrapper.select(".hx-table-header-sticky").select("thead").select(".hx-table-header-row").selectAll("th").each(function(e,o){return hx.select(e).style("width",t[o])}),e()},S=function(e){return _.newSource=!1,_.container.classed("hx-table-loading",!1),_.rendered=!0,e()},n(function(){return u(function(){return d(function(){return c(function(){return V(function(){return p(function(){return b(function(){return x(function(){return a(function(){return S(function(){return e.emit("render"),"function"==typeof t?t():void 0})})})})})})})})})}),e},t}(hx.EventEmitter),hx.Table=Table;})();(function(){var setupFastClick;hx.supports("touch")&&(setupFastClick=function(t,e){var n,u,r,a,c,i,o;return o=n=r=null,a=10,u=function(t){var e,n;return e=t.originalEvent||t,n=e.touches||e.targetTouches,n?[n[0].pageX,n[0].pageY]:void 0},c=void 0,i=void 0,t.addEventListener("touchstart",function(t){var e;return t.touches&&t.touches.length>1||t.targetTouches&&t.targetTouches.length>1?!1:(e=u(t),c=e[0],i=e[1],e)}),t.addEventListener("touchmove",function(t){var e;return!n&&(e=u(t),e&&(Math.abs(i-e[1])>a||Math.abs(c-e[0])>a))?n=!0:void 0}),t.addEventListener("touchend",function(t){return clearTimeout(r),r=setTimeout(function(){return o=!1,n=!1},1e3),t.which&&t.which>1||t.shiftKey||t.altKey||t.metaKey||t.ctrlKey?void 0:(t.preventDefault(),n||o&&o!==t.type?void(n=!1):(o=t.type,e.emit("click",t)))})},hx.select.addEventAugmenter({name:"click",setup:setupFastClick}));})();(function(){var Form,__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var n in e)__hasProp.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};Form=function(t){function e(t){this.selector=t,e.__super__.constructor.apply(this,arguments),this.formId="form-"+hx.randomId()+"-",this.properties=new hx.Map,hx.select(this.selector).classed("hx-form",!0).on("keypress",function(t){var e;return e=hx.select(t.target||t.srcElement),13===t.keyCode&&"submit"!==e.attr("type")?t.preventDefault():void 0})}return __extends(e,t),e.prototype.add=function(t,e,r,n){var o,i,u,a,p;return u=this.formId+t.split(" ").join("-"),o=hx.select(this.selector).append("div"),o.append("label").attr("for",u).text(t),p=o.append(r).attr("id",u),i=n.call(p)||{},null!=i.key?(a=i.key,delete i.key,this.properties.set(a,{type:e,node:p.node(),extras:i})):this.properties.set(t,{type:e,node:p.node(),extras:i}),this},e.prototype.addText=function(t,e){return null==e&&(e={}),null==e.type&&(e.type="text"),null==e.attrs&&(e.attrs=[]),this.add(t,"text","input",function(){var t,r,n,o,i;for(r=this.attr("type",e.type),null!=e.autoCompleteData&&"password"!==e.type&&"number"!==e.type&&new hx.AutoComplete(r.node(),e.autoCompleteData,null!=e.autoCompleteOptions?e.autoCompleteOptions:e.autoCompleteOptions=void 0),null!=e.placeholder&&r.attr("placeholder",e.placeholder),e.required&&r.attr("required",e.required),i=e.attrs,n=0,o=i.length;o>n;n++)t=i[n],r.attr(t.type,t.value);return null!=e.validator&&(r.node().oninput=function(t){return function(t){return t.target.setCustomValidity(e.validator(t)||"")}}(this)),{required:e.required,key:e.key}})},e.prototype.addEmail=function(t,e){return null==e&&(e={}),e.type="email",this.addText(t,e)},e.prototype.addUrl=function(t,e){return null==e&&(e={}),e.type="url",this.addText(t,e)},e.prototype.addNumber=function(t,e){return null==e&&(e={}),e.type="number",e.attrs=[{type:"step",value:e.step}],null!=e.min&&e.attrs.push({type:"min",value:e.min}),null!=e.max&&e.attrs.push({type:"max",value:e.max}),this.addText(t,e)},e.prototype.addPassword=function(t,e){return null==e&&(e={}),e.type="password",this.addText(t,e)},e.prototype.addSelect=function(t,e,r){return null==r&&(r={}),this.add(t,"select","select",function(){var t,n,o;for(n=0,o=e.length;o>n;n++)t=e[n],this.append("option").text(t);return"boolean"==typeof r.required&&(this.prop("selectedIndex",-1),r.required===!0&&this.attr("required",!0)),{required:r.required,key:r.key}})},e.prototype.addCheckbox=function(t,e){return null==e&&(e={}),this.add(t,"checkbox","input",function(){return this.attr("type","checkbox"),null!=e.required&&this.attr("required",e.required),{required:e.required,key:e.key}})},e.prototype.addRadio=function(t,e,r){var n;return null==r&&(r={}),n=this,this.add(t,"radio","div",function(){var o,i,u,a,p,s,d;for(i=n.formId+t.split(" ").join("-"),o=0,s=0,d=e.length;d>s;s++)p=e[s],a=this.append("div")["class"]("hx-radio-container"),u=a.append("input").attr("type","radio").attr("name",i).attr("id",i+"-"+o).value(p),null!=r.required&&u.attr("required",r.required),a.append("label").attr("for",i+"-"+o).text(p),o+=1;return{required:r.required,key:r.key}})},e.prototype.addSubmit=function(t,e){return hx.select(this.selector).append("button").attr("type","submit")["class"]("hx-btn hx-positive hx-form-submit").html('<i class="'+e+'"></i> '+t).on("click",function(t){return function(e){return hx.select(t.selector).node().checkValidity()||13===e.keyCode?(e.preventDefault(),t.submit()):void 0}}(this)),this},e.prototype.addTagInput=function(t,e){var r;return null==e&&(e={}),r=this,this.add(t,"tagInput","div",function(){var t,r;return t=e.classifier,r=e.validator,{tagInput:new hx.TagInput(this.node(),t,r),key:e.key}}),this},e.prototype.getData=function(){var t;return t={},this.properties.forEach(function(e,r){var n;return n=function(){switch(r.type){case"checkbox":return hx.select(r.node).prop("checked");case"radio":return hx.select(r.node).select("input:checked").value();case"tagInput":return r.extras.tagInput.tags();default:return hx.select(r.node).value()}}(),t[e]=n}),t},e.prototype.submit=function(){return this.emit("submit",this.getData())},e.prototype.fill=function(t){var e,r,n,o,i;i=[];for(e in t)if(__hasProp.call(t,e))if(o=t[e],this.properties.has(e))switch(n=this.properties.get(e),r=n.node,n.type){case"checkbox":i.push(hx.select(r).prop("checked",o));break;case"radio":i.push(hx.select(r).selectAll("input").filter(function(t){return hx.select(t).value()===o}).prop("checked",!0));break;case"tagInput":i.push(o.forEach(function(t){return n.extras.tagInput.add(t)}));break;default:i.push(hx.select(r).value(o))}else i.push(void 0);return i},e.prototype.render=function(t){},e}(hx.EventEmitter),hx.Form=Form;})();(function(){var Paginator,__hasProp={}.hasOwnProperty,__extends=function(t,e){function n(){this.constructor=t}for(var o in e)__hasProp.call(e,o)&&(t[o]=e[o]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};Paginator=function(t){function e(t){var a,s,r;e.__super__.constructor.apply(this,arguments),a=hx.select(t).classed("hx-paginator",!0),r=this,a.append("button")["class"]("hx-btn "+hx.theme.paginator.arrowButton).html('<i class="fa fa-step-backward"></i>').on("click",function(){return void 0===r.pageCount?o(r,r.selected-1,"user"):o(r,0,"user")}),s=a.append("span")["class"]("hx-input-group"),this.view=s.view(".hx-btn","button").update(function(t,e,n){return this.text(t.value).classed(hx.theme.paginator.defaultButton,!t.selected).classed(hx.theme.paginator.selectedButton,t.selected).classed("hx-no-border",!0).on("click",function(){return o(r,t.value,"user")})}),a.append("button")["class"]("hx-btn "+hx.theme.paginator.arrowButton).html('<i class="fa fa-step-forward"></i>').on("click",function(){return void 0===r.pageCount?o(r,r.selected+1,"user"):o(r,r.pageCount,"user")}),this.visibleCount=10,this.pageCount=10,this.selected=1,n(this)}var n,o;return __extends(e,t),n=function(t){var e,n,o;return void 0===t.pageCount?e=[{value:t.selected,selected:!0}]:(o=Math.max(1,t.selected-Math.floor(t.visibleCount/2)),n=Math.min(o+t.visibleCount,t.pageCount+1),o=Math.max(1,n-t.visibleCount),e=hx.range(n-o).map(function(e){return{value:o+e,selected:t.selected===o+e}})),t.view.apply(e)},o=function(t,e,o){var a;return a=void 0===t.pageCount?Math.max(e,1):hx.clamp(1,t.pageCount,e),a!==t.selected?(t.selected=a,n(t),t.emit("change",{cause:o,selected:t.selected})):void 0},e.prototype.setPage=function(t){return o(this,t,"api"),this},e.prototype.getPage=function(){return this.selected},e.prototype.setPageCount=function(t){return this.pageCount=t,n(this),this},e.prototype.setVisibleCount=function(t){return this.visibleCount=t,n(this),this},e}(hx.EventEmitter),hx.Paginator=Paginator;})();(function(){var Axis,BandSeries,BarSeries,DateScale,DiscreteScale,Graph,Label,LabelMeta,LineSeries,LinearScale,PieChart,ScatterSeries,Series,StandardLabel,StraightLineSeries,arcCurve,axisPadding,boundLabel,extent,extent2,feather,graph,inefficientSearch,labelOffset,pie,plot,splitAndFeather,splitData,stackSegments,svgCurve,tickSize,updatePath,__hasProp={}.hasOwnProperty,__extends=function(t,e){function i(){this.constructor=t}for(var a in e)__hasProp.call(e,a)&&(t[a]=e[a]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};svgCurve=function(t,e){var i,a,r,s;if(t.length>1){for(r=new Array(t.length),r[0]="M"+t[0].x+","+t[0].y,a=t.length-1,i=s=1;a>=1?a>=s:s>=a;i=a>=1?++s:--s)r[i]="L"+t[i].x+","+t[i].y;return e?r.join("")+"z":r.join("")}return""},arcCurve=function(t,e,i,a,r,s,n,h){var l,o,c,u,x,p;return l=function(t,e){return t/e},u=function(i,a,h){var c,u,x,d,g,y,f;for(d=l(n,h),u=Math.abs(a-i),f=[],c=y=i;a>=i?a>=y:y>=a;c=a>=i?++y:--y)x=p-d,g=x>0?r+d/2+c/u*x:s-d/2-c/u*x,g=hx.clamp(r,s,g),f.push(o.push({x:t+h*Math.cos(g),y:e+h*Math.sin(g)}));return f},p=s-r,c=Math.min(100,Math.max(3,Math.floor(p*Math.sqrt(a))-1)),o=[],n>=i?(x=Math.max(n,i)/(2*Math.sin(2*Math.PI/h)),o.push({x:t+x*Math.cos((r+s)/2),y:e+x*Math.sin((r+s)/2)})):u(0,c,i),u(c,0,a),svgCurve(o,!0)},extent=function(t,e){var i,a,r,s,n;if(t.length>0){for(r=e(t[0]),a=e(t[0]),s=0,n=t.length;n>s;s++)i=t[s],r=hx.min([r,e(i)]),a=hx.max([a,e(i)]);return[r,a]}return void 0},extent2=function(t,e,i){var a,r,s,n,h;if(t.length>0){for(s=e(t[0]),r=e(t[0]),n=0,h=t.length;h>n;n++)a=t[n],s=hx.min([s,e(a),i(a)]),r=hx.max([r,e(a),i(a)]);return[s,r]}return void 0},feather=function(t,e){var i,a,r,s,n;if(null==e&&(e=200),e>0){if(r=t.length,r>e){for(a=new Array(e),i=s=0,n=e-1;n>=0?n>=s:s>=n;i=n>=0?++s:--s)a[i]=t[Math.floor(i*(r-1)/(e-1))];return a}return t.slice(0)}return[]},splitData=function(t,e){var i,a,r,s,n,h,l;for(null==e&&(e=function(){}),n=t.length,s=[],a=void 0,i=!0,h=0,l=t.length;l>h;h++)r=t[h],hx.defined(r)?(i&&(a=[],s.push(a),i=!1),a.push(r)):i=!0;return s.filter(function(t){return t.length>0})},splitAndFeather=function(t,e,i){var a,r,s,n,h,l;for(null==i&&(i=function(){}),r=e/t.length,h=splitData(t,i),l=[],s=0,n=h.length;n>s;s++)a=h[s],l.push(feather(a,Math.floor(a.length*r)));return l},stackSegments=function(t,e,i){var a,r,s,n,h,l;for(r=[],s=0,a=h=0,l=t.length;l>h;a=++h)n=t[a],r.push({y0:s,y1:s+n.value,yname:e[a],y:n.value,data:n,x:i}),s+=n.value;return r},inefficientSearch=function(t,e,i,a){var r,s,n;for(r=s=0,n=t.length-1;n>s;r=s+=1)if(a(t[r])<=e&&e<=a(t[r+1]))return i?Math.abs(a(t[r])-e)<Math.abs(a(t[r+1])-e)?r:r+1:r;return-1},boundLabel=function(t,e){return t.bounding=e.plotArea,t},Series=function(){function t(){this.data=null,this.axis=null,this.label=new StandardLabel,this.name=null}return t.prototype.setData=function(t){return this.data=t},t.prototype.getX=function(t){var e,i;return hx.isString(t)?(e=hx.find(this.data,function(e){return e.y===t}),hx.defined(e)?e.x:void 0):(i=inefficientSearch(this.data,t,!0,function(t){return t.y}),this.data[i].x)},t.prototype.getY=function(t){var e,i,a,r,s,n;return hx.isString(t)?(e=hx.find(this.data,function(e){return e.x===t}),hx.defined(e)?e.y:void 0):(i=inefficientSearch(this.data,t,!1,function(t){return t.x}),i>=0&&i<this.data.length-1?(a=this.data[i].x,r=this.data[i+1].x,s=this.data[i].y,n=this.data[i+1].y,s+(n-s)*(t-a)/(r-a)):t>this.data[this.data.length-1].x?this.data[this.data.length-1].y:this.data[0].y)},t.prototype.setLabel=function(t){return this.label=t},t.prototype.getLabelMeta=function(t,e){},t.prototype.updateSvg=function(t){},t}(),Axis=function(){function t(t,e){this.xScaleType=null!=t?t:"linear",this.yScaleType=null!=e?e:"linear",this.xVisible=!0,this.xFormatter=hx.format.si(2),this.xTickRotation=0,this.xMin="auto",this.xMax="auto",this.xDiscretePadding=.1,this.xDiscreteLabels=void 0,this.xTickSpacing=50,this.xTitle=null,this.xScalePaddingMin=0,this.xScalePaddingMax=0,this.xTicksAll=!1,this.xGridLines=!0,this.xNthTickVisible=1,this.yVisible=!0,this.yFormatter=hx.format.si(2),this.yMin="auto",this.yMax="auto",this.yDiscretePadding=.1,this.yDiscreteLabels=void 0,this.yTickSpacing=50,this.yTitle=null,this.yScalePaddingMin=0,this.yScalePaddingMax=0,this.yTicksAll=!1,this.yGridLines=!0,this.yNthTickVisible=1,this.series=new hx.List,this.xScale=new LinearScale(0,1,0,1),this.yScale=new LinearScale(0,1,0,1),this.graph=null,this.xAxisSize=50,this.yAxisSize=50,this.xTitleHeight=0,this.yTitleHeight=0}var e,i;return i=function(t){return t instanceof BarSeries||t instanceof LineSeries},t.prototype.addSeries=function(t,e){return null==t&&(t="line"),null==e&&(e=""),hx.isString(t)&&(t=function(){switch(t){case"line":return new LineSeries;case"band":return new BandSeries;case"bar":return new BarSeries;case"scatter":return new ScatterSeries;case"straight-line":return new StraightLineSeries;default:return void console.error(t+" is not a valid series type")}}(),void 0!==t&&(t.name=e)),void 0!==t?(this.series.add(t),t.axis=this,t):void 0},t.prototype.removeSeries=function(t){return this.series.remove(t),t.axis=null},t.prototype.setupAxisSvg=function(t){var e,i,a;return e=hx.select(t).append("g")["class"]("hx-axis-grid"),i=hx.select(t).append("g")["class"]("hx-x-axis"),i.append("g")["class"]("hx-axis-scale"),a=hx.select(t).append("g")["class"]("hx-y-axis"),a.append("g")["class"]("hx-axis-scale")},e=function(t,e,i){return t+(e||1)*i},t.prototype.tagSeries=function(){var t,e,i,a,r,s,n,h,l,o,c;for(t=function(t){var e,i,a,r,s,n,h,l,o,c,u,x,p,d,g,y,f,v;for(a=new hx.Map,l=0,x=t.length;x>l;l++)n=t[l],a.has(n.group)||a.set(n.group,new hx.List),a.get(n.group).add(n);for(s=0,h=a.size,h+=a.has(void 0)?a.get(void 0).size-1:0,y=a.entries(),o=0,p=y.length;p>o;o++)if(e=y[o],i=e[0],"undefined"===i)for(f=e[1].entries(),r=c=0,d=f.length;d>c;r=++c)n=f[r],n.groupId=s,s++,n.seriesId=0,n.groupSize=1,n.typeSize=h;else{for(v=e[1].entries(),r=u=0,g=v.length;g>u;r=++u)n=v[r],n.groupId=s,n.seriesId=r,n.groupSize=e[1].size,n.typeSize=h;s++}return s},a=new hx.Map,l=this.series.entries(),r=0,n=l.length;n>r;r++)e=l[r],a.has(e.type)||a.set(e.type,new hx.List),a.get(e.type).add(e);for(o=a.entries(),c=[],s=0,h=o.length;h>s;s++)i=o[s],c.push(t(i[1].entries()));return c},t.prototype.preupdateXAxisSvg=function(t){var i,a,r,s,n,h,l,o,c,u,x,p,d,g;switch(o=this,this.xScaleType){case"linear":this.xScale=(new LinearScale).range(0,this.graph.width);break;case"discrete":this.xScale=new DiscreteScale(this.xDiscretePadding).range(0,this.graph.width);break;case"log":this.xScale=(new LogScale).range(0,this.graph.width);break;case"date":this.xScale=(new DateScale).range(0,this.graph.width)}return"discrete"===this.xScaleType?(n=function(){var t,e,i,a,r,n;if(this.xDiscreteLabels)return this.xDiscreteLabels;for(u=new hx.Set,r=this.series.entries(),t=0,i=r.length;i>t;t++)for(c=r[t],n=c.data,e=0,a=n.length;a>e;e++)s=n[e],u.add(s.x);return u.values()}.call(this),this.xScale.domain(n)):(g=function(){var t,e,i,a;for(i=this.series.entries(),a=[],t=0,e=i.length;e>t;t++)l=i[t],a.push(l instanceof StraightLineSeries?l.data.dx||l.data.dy||!l.data.x?void 0:[l.data.x,l.data.x]:extent(l.data,function(t){return t.x}));return a}.call(this),g=g.filter(hx.identity),d=hx.min(g.map(function(t){return t[0]})),p=hx.max(g.map(function(t){return t[1]})),d="auto"===this.xMin?d:this.xMin,p="auto"===this.xMax?p:this.xMax,"auto"===this.xMin&&(d=e(d,p-d,-this.xScalePaddingMin)),"auto"===this.xMax&&(p=e(p,p-d,this.xScalePaddingMax)),this.xScale.domain(d,p)),x=0,this.xVisible&&(r=hx.select(t).select(".hx-x-axis"),a=this.xTickRotation,i=a/180*Math.PI,h=function(t){return function(e){var i,a,r,n,h,l;if(o.xTicksAll){for(u=new hx.Set,h=t.series.entries(),i=0,r=h.length;r>i;i++)for(c=h[i],l=c.data,a=0,n=l.length;n>a;a++)s=l[a],u.add(s.x);return u.values().map(function(t){return[t,e.apply(t)]})}return e.ticks(o.xTickSpacing)}}(this),r.select(".hx-axis-scale").view(".hx-axis-view","g").update(function(t){return this.view(".hx-tick","g").update(function(t){return this.view(".hx-tick-text-x","text").update(function(t){var e,r;return this.text(o.xFormatter(t)),e=this.node().getBBox(),r=e.height*Math.cos(i)+e.width*Math.sin(i),x=Math.max(x,r),0===i?this.attr("transform","translate("+-e.width/2+","+labelOffset+")").style("dominant-baseline","hanging"):this.attr("transform","translate(0,"+labelOffset+") rotate("+a+")")}).apply(t[0])}).apply(h(t))}).apply(this.xScale),this.xTitle&&(r.view(".hx-axis-title","text").update(function(t){return t.xTitleHeight=this.text(t.xTitle).height()}).apply(this),x+=this.xTitleHeight),x+=labelOffset+axisPadding),this.xAxisSize=x},t.prototype.preupdateYAxisSvg=function(t,a){var r,s,n,h,l,o,c,u,x,p,d,g,y,f,v,S,m,M,b,w,T,k,A,L,P,_,z,C;switch(c=this,l=this.graph.height-a,this.yScaleType){case"linear":this.yScale=(new LinearScale).range(l,0);break;case"discrete":this.yScale=new DiscreteScale(this.yDiscretePadding).range(l,0);break;case"log":this.yScale=(new LogScale).range(l,0);break;case"date":this.yScale=(new DateScale).range(l,0)}if("discrete"===this.yScaleType)n=function(){var t,e,i,a,r,n;if(this.yDiscreteLabels)return this.yDiscreteLabels;for(x=new hx.Set,r=this.series.entries(),t=0,i=r.length;i>t;t++)for(u=r[t],n=u.data,e=0,a=n.length;a>e;e++)s=n[e],x.add(s.y);return x.values()}.call(this),this.yScale.domain(n);else{for(m=void 0,S=void 0,f=hx.groupBy(this.series.entries(),function(t){return t.type}),p=f.map(function(t){return{type:t[0],group:hx.groupBy(t[1],function(t){return i(t)?t.group:void 0})}}),T=0,L=p.length;L>T;T++)for(y=p[T],z=y.group,k=0,P=z.length;P>k;k++)if(h=z[k],u=h[1],"undefined"===h[0])M=function(){var t,e,i,a;for(i=this.series.entries(),a=[],t=0,e=i.length;e>t;t++)o=i[t],a.push(o instanceof StraightLineSeries?o.data.dx||o.data.dy||!o.data.y?void 0:[o.data.y,o.data.y]:o instanceof BandSeries?extent2(o.data,function(t){return t.y1},function(t){return t.y2}):extent(o.data,function(t){return t.y}));return a}.call(this),M=M.filter(function(t){return null!=t}),w=hx.min(M.map(function(t){return t[0]})),b=hx.max(M.map(function(t){return t[1]})),(void 0===m||m>w)&&(m=w),(void 0===S||b>S)&&(S=b);else for(g=u[u.length-1],m=void 0===m?0:Math.min(m,0),S=void 0===S?0:Math.max(S,0),C=g.data,A=0,_=C.length;_>A;A++)s=C[A],d=this.getYStack(g.type,g.group,s.x,g.seriesId+1,this.yScale.domainMin),(void 0===m||m>d)&&(m=d),(void 0===S||d>S)&&(S=d);m="auto"===this.yMin?m:this.yMin,S="auto"===this.yMax?S:this.yMax,"auto"===this.yMin&&(m=e(m,S-m,-this.yScalePaddingMin)),"auto"===this.yMax&&(S=e(S,S-m,this.yScalePaddingMax)),this.yScale.domain(m,S)}return v=0,this.yVisible&&(r=hx.select(t).select(".hx-y-axis"),r.select(".hx-axis-scale").view(".hx-axis-view","g").update(function(t){return this.view(".hx-tick","g").update(function(t){return this.view(".hx-tick-text-y","text").update(function(t){var e;return e=this.text(c.yFormatter(t)).attr("x",-labelOffset).width(),e>v?v=e:void 0}).apply(t[0])}).apply(t.ticks(c.yTickSpacing))}).apply(this.yScale),this.yTitle&&(r.view(".hx-axis-title","text").update(function(t){return t.yTitleHeight=this.text(t.yTitle).attr("transform","rotate(90)").width()}).apply(this),v+=this.yTitleHeight),v+=labelOffset+axisPadding),this.yAxisSize=v},t.prototype.updateAxisSvg=function(t,e,i,a,r){var s,n,h,l,o;switch(l=this,o=this.graph.width,h=this.graph.height,this.xScaleType){case"linear":case"date":this.xScale.range(a,o);break;case"discrete":this.xScale.range(a,o);break;case"log":this.xScale.range(a,o)}switch(this.yScaleType){case"linear":case"date":this.yScale.range(h-r,0);break;case"discrete":this.yScale.range(h-r,0);break;case"log":this.yScale.range(h-r,0)}return n=hx.select(t).select(".hx-axis-grid"),this.xVisible&&(this.xGridLines&&n.view(".hx-vertical-grid-line","line").update(function(t){return this.attr("x1",t[1]).attr("x2",t[1]).attr("y1",l.yScale.rangeMax).attr("y2",l.yScale.rangeMin)}).apply(this.xScale.ticks(l.xTickSpacing)),s=hx.select(t).select(".hx-x-axis").attr("transform","translate(0,"+(h-i-this.xAxisSize)+")"),s.select(".hx-axis-scale").view(".hx-axis-view","g").update(function(t){return this.view(".hx-axis-line","line").update(function(t){return this.attr("x1",t.rangeMin).attr("x2",t.rangeMax)}).apply(t),this.view(".hx-tick","g").update(function(t,e,i){return this.attr("transform","translate("+t[1]+",0)"),this.view(".hx-tick-line","line").update(function(t){return this.attr("y1",0).attr("y2",tickSize)}).apply(this),this.view(".hx-tick-text-x","text").update(function(t){return this.text(i%l.xNthTickVisible===0?l.xFormatter(t):"")}).apply(t[0])}).apply(t.ticks(l.xTickSpacing))}).apply(this.xScale),this.xTitle&&s.view(".hx-axis-title","text").update(function(t){return this.attr("transform","translate("+(o+a)/2+", "+(t.xAxisSize-t.xTitleHeight/2-axisPadding/2)+")").text(l.xTitle)}).apply(this)),this.yVisible&&(this.yGridLines&&n.view(".hx-horizontal-grid-line","line").update(function(t){return this.attr("y1",t[1]).attr("y2",t[1]).attr("x1",l.xScale.rangeMax).attr("x2",l.xScale.rangeMin)}).apply(this.yScale.ticks(l.yTickSpacing)),s=hx.select(t).select(".hx-y-axis").attr("transform","translate("+(e+this.yAxisSize)+",0)"),s.select(".hx-axis-scale").view(".hx-axis-view","g").update(function(t){return this.view(".hx-axis-line","line").update(function(t){return this.attr("y1",t.rangeMin).attr("y2",t.rangeMax)}).apply(t),this.view(".hx-tick","g").update(function(t,e,i){return this.attr("transform","translate(0,"+t[1]+")"),this.view(".hx-tick-line","line").update(function(t){return this.attr("x1",-tickSize).attr("x2",0)}).apply(this),this.view(".hx-tick-text-y","text").update(function(t){return this.attr("x",-labelOffset).text(i%l.yNthTickVisible===0?l.yFormatter(t):"")}).apply(t[0])}).apply(t.ticks(l.yTickSpacing))}).apply(this.yScale),this.yTitle)?s.view(".hx-axis-title","text").update(function(t){return this.attr("transform","translate("+(-t.yAxisSize+t.yTitleHeight/2+axisPadding/2)+", "+(h-r)/2+") rotate(-90)").text(l.yTitle)}).apply(this):void 0},t.prototype.updateDataSvg=function(t,e){var i,a,r,s,n,h,l,o;for(i=[],s=[],hx.select(t).view(".hx-series","g").update(function(t,e){return i.push(e)}).apply(this.series.entries()),hx.select(e).view(".hx-series","g").update(function(t,e){return s.push(e)}).apply(this.series.entries()),l=this.series.entries(),o=[],a=n=0,h=l.length;h>n;a=++n)r=l[a],o.push(r.updateSvg(i[a],s[a]));return o},t.prototype.getLabelPositions=function(t,e){var i,a;return i=hx.flatten(function(){var i,r,s,n;for(s=this.series.entries(),n=[],i=0,r=s.length;r>i;i++)a=s[i],n.push(a.getLabelMetas(t,e));return n}.call(this)),i.filter(function(t){return t})},t.prototype.getXStack=function(t,e,i,a,r){var s,n,h,l,o,c,u;if(null==r&&(r=0),e){for(h=Math.max(this.xScale.domainMin,0),u=this.series.entries(),s=o=0,c=u.length;c>o;s=++o)n=u[s],n.seriesId<a&&n.group===e&&n.type===t&&(l=n.getX(i),hx.defined(ys)&&(h+=l));return h}return Math.max(r,0)},t.prototype.getYStack=function(t,e,i,a,r){var s,n,h,l,o,c,u;if(null==r&&(r=0),e){for(h=Math.max(this.yScale.domainMin,0),u=this.series.entries(),s=o=0,c=u.length;c>o;s=++o)n=u[s],n.seriesId<a&&n.group===e&&n.type===t&&(l=n.getY(i),hx.defined(l)&&(h+=l));return h}return Math.max(r,0)},t}(),hx.Axis=Axis,tickSize=6,labelOffset=tickSize+4,axisPadding=4,Graph=function(){function t(t){var i,a,r;this.selector=t,this.axes=new hx.List,r=hx.randomId(),this.svgTarget=hx.select(this.selector).append("svg").attr("class","hx-graph"),a=this.svgTarget.append("defs"),this.axesTarget=this.svgTarget.append("g").attr("class","hx-axes"),this.plotTarget=this.svgTarget.append("g").attr("class","hx-plot"),this.labelTarget=this.svgTarget.append("g").attr("class","hx-label"),i=a.append("clipPath").attr("id","clip-series-"+r),this.clipRect=i.append("rect"),this.plotTarget.attr("clip-path","url(#clip-series-"+r+")"),this.labelsView=this.labelTarget.view(".hx-plot-label","g").update(function(t,e){return t.render(e)}),this.svgTarget.on("pointermove",function(t){return function(i){var a,r;return a=Math.round(i.x-t.svgTarget.box().left),r=Math.round(i.y-t.svgTarget.box().top),e.call(t,a,r)}}(this)),this.svgTarget.on("pointerleave",function(t){return function(e){return t.labelsView.apply([])}}(this))}var e;return t.prototype.addAxis=function(){var t;return t=arguments.length>=2?new Axis(arguments[0],arguments[1]):1===arguments.length?hx.isString(arguments[0])?new Axis(arguments[0],arguments[0]):arguments[0]:new Axis("linear","linear"),t.graph=this,this.axes.add(t),t},t.prototype.removeAxis=function(t){return this.axes.remove(t),t.graph=null},t.prototype.render=function(){var t,e,i,a,r,s,n,h,l;return n=hx.select(this.selector).style("width"),e=hx.select(this.selector).style("height"),this.width=Number(n.slice(0,-2)),this.height=Number(e.slice(0,-2)),a=Number(this.svgTarget.style("width").slice(0,-2)),i=Number(this.svgTarget.style("height").slice(0,-2)),this.svgTarget.attr("viewBox","0 0 "+a+" "+i),this.axes.forEach(function(t){return t.tagSeries()}),t=function(t){var e;return e=this.append("g")["class"]("hx-axis").node(),t.setupAxisSvg(e),e},r=0,this.axesTarget.view(".hx-axis","g").enter(t).update(function(t,e){return t.preupdateXAxisSvg(e),r+=t.xAxisSize}).apply(this.axes.entries()),s=0,this.axesTarget.view(".hx-axis","g").enter(t).update(function(t,e){return t.preupdateYAxisSvg(e,r),s+=t.yAxisSize}).apply(this.axes.entries()),h=0,l=0,this.axesTarget.view(".hx-axis","g").enter(t).update(function(t,e){return t.updateAxisSvg(e,l,h,s,r),h+=t.xAxisSize,l+=t.yAxisSize}).apply(this.axes.entries()),this.plotArea={x1:l,y1:0,x2:this.width,y2:this.height-h},this.plotTarget.view(".hx-axis-data","g").enter(function(){var t;return t=this.append("g")["class"]("hx-axis-data"),t.append("g")["class"]("hx-graph-fill-layer"),t.append("g")["class"]("hx-graph-sparse-layer"),t.node()}).update(function(t,e){return t.updateDataSvg(this.select(".hx-graph-fill-layer").node(),this.select(".hx-graph-sparse-layer").node())}).apply(this.axes.entries()),this.clipRect.attr("x",this.plotArea.x1).attr("y",this.plotArea.y1).attr("width",this.plotArea.x2-this.plotArea.x1).attr("height",this.plotArea.y2-this.plotArea.y1)},e=function(t,e){var i,a,r,s,n,h,l,o,c,u,x;if(t=hx.clamp(this.plotArea.x1,this.plotArea.x2,t),e=hx.clamp(this.plotArea.y1,this.plotArea.y2,e),h=hx.flatten(function(){var a,r,s,n;for(s=this.axes.entries(),n=[],a=0,r=s.length;r>a;a++)i=s[a],n.push(i.getLabelPositions(t,e));return n}.call(this)),h=h.filter(function(t){return function(e){var i,a;return t.plotArea.x1<=(i=e.x)&&i<=t.plotArea.x2&&t.plotArea.y1<=(a=e.y)&&a<=t.plotArea.y2}}(this)),l=!0){for(r=void 0,a=void 0,u=0,x=h.length;x>u;u++)n=h[u],o=n.x-t,c=n.y-e,s=o*o+c*c,(void 0===a||a>s)&&(r=n,a=s);return this.labelsView.apply(r?boundLabel(r,this):[])}return this.labelsView.apply(h.map(function(t){return function(e){return boundLabel(e,t)}}(this)))},t}(),hx.Graph=Graph,Label=function(){function t(){this.formatters={},this.interpolate=!1}return t.prototype.render=function(t,e){},t}(),LabelMeta=function(){function t(t,e,i,a){this.labelType=t,this.name=e,this.x=i,this.y=a,this.values=[]}return t.prototype.render=function(t){return this.labelType.render(t,this)},t}(),LinearScale=function(){function t(t,e,i,a){var r;this.domainMin=null!=t?t:0,this.domainMax=null!=e?e:10,this.rangeMin=null!=i?i:0,this.rangeMax=null!=a?a:10,r=this.domainMax-this.domainMin,this.factor=0!==r?(this.rangeMax-this.rangeMin)/r:1}return t.prototype.apply=function(t){return this.rangeMin+(t-this.domainMin)*this.factor},t.prototype.inverse=function(t){return this.domainMin+(t-this.rangeMin)/this.factor},t.prototype.domain=function(t,e){var i;return this.domainMin=t,this.domainMax=e,i=this.domainMax-this.domainMin,this.factor=0!==i?(this.rangeMax-this.rangeMin)/i:1,this},t.prototype.range=function(t,e){var i;return this.rangeMin=t,this.rangeMax=e,i=this.domainMax-this.domainMin,this.factor=0!==i?(this.rangeMax-this.rangeMin)/i:1,this},t.prototype.ticks=function(t){var e,i,a,r,s,n,h,l,o,c,u;switch(a=this.domainMax-this.domainMin,o=Math.abs(this.rangeMax-this.rangeMin)/t,l=Math.pow(10,Math.floor(Math.log(a/o)/Math.LN10)),s=a/(o*l),!1){case!(s>=7.5):l*=10;break;case!(s>=3):l*=5;break;case!(s>=1.25):l*=2}for(r=Math.ceil(this.domainMin/l)*l,i=(Math.floor(this.domainMax/l)+.5)*l,h=(i-r)/l,u=[],n=c=0;h>=0?h>c:c>h;n=h>=0?++c:--c)e=r+n*l,u.push([e,this.apply(e)]);return u},t}(),DiscreteScale=function(){function t(t){this.bandPadding=null!=t?t:.1,this.domainCategories=[],this.rangeMin=0,this.rangeMax=10}return t.prototype.apply=function(t){var e;return e=this.domainCategories.indexOf(t),-1!==e?this.rangeMin+e/this.domainCategories.length*(this.rangeMax-this.rangeMin)+this.tickOffset()+this.tickWidth()/2:void 0},t.prototype.inverse=function(t){var e;return e=Math.floor((t-this.tickOffset()-this.rangeMin)/(this.rangeMax-this.rangeMin)*this.domainCategories.length),e>=0&&e<this.domainCategories.length?this.domainCategories[e]:void 0},t.prototype.domain=function(t){return this.domainCategories=t,this},t.prototype.range=function(t,e){return this.rangeMin=t,this.rangeMax=e,this},t.prototype.ticks=function(t){var e,i,a,r,s;for(null==t&&(t=50),r=this.domainCategories,s=[],i=0,a=r.length;a>i;i++)e=r[i],s.push([e,this.apply(e)]);return s},t.prototype.tickWidth=function(){return(this.rangeMax-this.rangeMin)/this.domainCategories.length*(1-this.bandPadding)},t.prototype.tickOffset=function(){return(this.rangeMax-this.rangeMin)/this.domainCategories.length*this.bandPadding/2},t}(),DateScale=function(t){function e(t,i,a,r){this.domainMin=t,this.domainMax=i,this.rangeMin=a,this.rangeMax=r,e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.ticks=function(t){var e,i,a,r,s,n,h,l,o,c,u,x,p,d,g;for(p=[1,2,5,10,25,50,100,250,500,1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],r=this.domainMax-this.domainMin,e=function(t){var e,i,a;for(i=0,a=p.length;a>i;i++)if(e=p[i],e>=t)return e;return 1},u=Math.abs(this.rangeMax-this.rangeMin)/t,o=Math.pow(10,Math.floor(Math.log(r/u)/Math.LN10)),n=r/(u*o),o*=n>=7.5?10:n>=3?5:n>=2?3:n>=1.25?2:n>=1.025?1.5:1,s=Math.ceil(this.domainMin/o)*o,a=Math.floor(this.domainMax/o)*o,c=function(t,e){return e?Math.ceil(t/x)*x:Math.floor(t/x)*x},x=e(o),o=c(o,!0),s=c(s),s<this.domainMin&&(s+=o),l=(a-s)/o,g=[],h=d=0;l>=0?l>=d:d>=l;h=l>=0?++d:--d)i=s+h*o,g.push([i,this.apply(i)]);return g},e}(LinearScale),BandSeries=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.color=hx.color(hx.theme.plot.colors[2]).alpha(.2).toString(),this.feather=200}var i,a;return __extends(e,t),a=function(t,e){var i,a,r,s;for(s=[],a=0,r=t.length;r>a;a++)i=t[a],s.push({x:e.xScale.apply(i.x),y:e.yScale.apply(i.y)});return s},e.prototype.updateSvg=function(t){var e,i,r,s;return s=this,e=function(){var t,e,s,n;for(s=splitAndFeather(this.data,this.feather,function(t){return void 0!==t.y1&&void 0!==t.y2}),n=[],t=0,e=s.length;e>t;t++)i=s[t],r=i.map(function(t){return{x:t.x,y:t.y1}}).concat(i.reverse().map(function(t){return{x:t.x,y:t.y2}})),n.push(svgCurve(a(r,this.axis),!0));return n}.call(this),hx.select(t).view(".hx-series-data","path","hx-series-area").update(function(t){return this.attr("d",t).attr("fill",s.color)}).apply(e)},e.prototype.getLabelMetas=function(t,e){var a,r,s;return this.label?(a=!1,s=i(this.label,this.data,this.axis,t,this.color,this,a,function(t){return t.y1}),r=i(this.label,this.data,this.axis,t,this.color,this,a,function(t){return t.y2}),s.concat(r)):[void 0]},i=function(t,e,i,a,r,s,n,h){var l,o,c,u,x,p,d,g;return l=inefficientSearch(e,a,!n,function(t){return i.xScale.apply(t.x)}),-1!==l?(n?l>=0&&l<e.length&&(c=i.xScale.apply(e[l].x),u=i.xScale.apply(e[l+1].x),p=i.yScale.apply(h(e[l])),d=i.yScale.apply(h(e[l+1])),x=a,g=p+(d-p)*(a-c)/(u-c)):(x=i.xScale.apply(e[l].x),g=i.yScale.apply(h(e[l]))),o=new LabelMeta(t,s.name,x,g),o.color=r,o.values.push({name:s.axis.xTitle,value:e[l].x,formatter:t.formatters[s.axis.xTitle]||s.axis.xFormatter}),o.values.push({name:s.axis.yTitle,value:h(e[l]),formatter:t.formatters[s.axis.yTitle]||s.axis.yFormatter}),[o]):[void 0]},e}(Series),BarSeries=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.color=hx.theme.plot.colors[1],this.type="bar",this.group=void 0}return __extends(e,t),e.prototype.updateSvg=function(t){var e,i;return i=this,e=this.axis,hx.select(t).view(".hx-series-data","rect").update(function(t){var a,r,s,n;return"discrete"===e.xScaleType?(r=e.xScale.tickWidth()/i.typeSize,s=e.xScale.apply(t.x)-r*i.typeSize/2+i.groupId*r,a=Math.abs(e.yScale.apply(t.y)-e.yScale.apply(0)),n=e.yScale.apply(e.getYStack(i.type,i.group,t.x,i.seriesId)),t.y>0&&(n-=a)):(r=Math.abs(e.xScale.apply(t.x)-e.xScale.apply(0)),s=e.xScale.apply(e.getXStack(i.type,i.group,t.y,i.seriesId)),a=Math.abs(e.yScale.tickWidth()/i.typeSize),n=e.yScale.apply(t.y)-a*i.typeSize/2+i.groupId*a,t.y>0&&(n-=a)),this.attr("class","hx-series-data hx-series-bar").attr("y",n).attr("x",s).attr("height",a).attr("width",r).style("fill",t.color||i.color)}).apply(this.data)},e.prototype.getLabelMetas=function(t,e){var i,a,r,s,n,h,l,o,c,u;return this.label?(c=this.axis.xScale.inverse(t),u=this.axis.yScale.inverse(e),i=hx.find(this.data,function(t){return t.x===c}),i?(o=this.axis.xScale.tickWidth()/this.typeSize,a=this.axis.xScale.apply(i.x)-o*this.typeSize/2+this.groupId*o,s=Math.abs(this.axis.yScale.apply(i.y)-this.axis.yScale.apply(0)),r=this.axis.yScale.apply(this.axis.getYStack(this.type,this.group,i.x,this.seriesId)),i.y>0&&(r-=s),null!=c&&null!=u&&null!=i?(l=Math.min(r,this.axis.yScale.apply(0)),n=Math.max(r,r+s),u=hx.clamp(l,n,this.axis.yScale.apply(u)),h=new LabelMeta(this.label,this.name,a+o/2,u),h.color=i.color||this.color,h.values.push({name:this.axis.xTitle,value:c,formatter:this.label.formatters[this.axis.xTitle]||this.axis.xFormatter}),h.values.push({name:this.axis.yTitle,value:i.y,formatter:this.label.formatters[this.axis.yTitle]||this.axis.yFormatter}),[h]):[void 0]):[void 0]):[void 0]},e}(Series),updatePath=function(t,e,i,a,r){return hx.select(t).view(".hx-series-data","g").update(function(t){return this.attr("class","hx-series-data hx-series-line").view(e,a).update(r).apply(t)}).apply(i)},LineSeries=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.type="line",this.stroke=!0,this.color=hx.theme.plot.colors[0],this.fill=!1,this.fillColor=void 0,this.feather=200,this.markers=!1,this.markerRadius=2,this.markerColor=void 0}var i;return __extends(e,t),i=function(t,e){var i,a,r,s;for(s=[],a=0,r=t.length;r>a;a++)i=t[a],s.push({x:e.xScale.apply(i.x),y:e.yScale.apply(i.y)});return s},e.prototype.updateSvg=function(t,e){var a,r,s,n,h,l,o,c,u,x;return x=this,s=this.axis,l=splitAndFeather(this.data,this.feather,function(t){return void 0!==t.y}),a=function(t,e){var i,a,r,n;for(n=[],a=0,r=t.length;r>a;a++)i=t[a],n.push({x:i.x,y:s.getYStack(x.type,x.group,i.x,x.seriesId)+(e?0:i.y)});return n},this.fill&&(c=Math.max(Math.min(this.axis.yScale.domainMax,0),this.axis.yScale.domainMin),o=function(){var t,e,i;for(i=[],t=0,e=l.length;e>t;t++)h=l[t],i.push(a(h).concat(a(h.reverse(),!0)));return i}(),r=function(){var t,e,a;for(a=[],t=0,e=o.length;e>t;t++)h=o[t],a.push(svgCurve(i(h,this.axis),!0));return a}.call(this),updatePath(t,".hx-series-line-fill",r,"path",function(t){return this.attr("d",t).attr("fill",x.fillColor||hx.color(x.color).alpha(.2).toString("rgba"))})),this.stroke&&(n="discrete"!==this.axis.yScaleType?function(){var t,e,r;for(r=[],t=0,e=l.length;e>t;t++)h=l[t],r.push(svgCurve(i(a(h),this.axis)));return r}.call(this):function(){var t,e,a;for(a=[],t=0,e=l.length;e>t;t++)h=l[t],a.push(svgCurve(i(h,this.axis)));return a}.call(this),updatePath(e,".hx-series-line-stroke",n,"path",function(t){return this.attr("d",t).attr("stroke",x.color)})),this.markers?(u="discrete"!==this.axis.yScaleType?a(hx.flatten(l)):hx.flatten(l),updatePath(e,".hx-series-line-markers",i(u,this.axis),"circle",function(t){return this.attr("cx",t.x).attr("cy",t.y).attr("r",x.markerRadius).attr("fill",x.markerColor||x.color)})):void 0},e.prototype.getLabelMetas=function(t,e){var i,a,r,s,n,h,l,o,c,u,x;return this.label?(s=inefficientSearch(this.data,t,!this.label.interpolate,function(t){return function(e){return t.axis.xScale.apply(e.x)}}(this)),-1!==s?(this.label.interpolate?s>=0&&s<this.data.length&&(h=this.axis.xScale.apply(this.data[s].x),l=this.axis.xScale.apply(this.data[s+1].x),a=this.axis.getYStack(this.type,this.group,this.data[s].x,this.seriesId),r=this.axis.getYStack(this.type,this.group,this.data[s+1].x,this.seriesId),c=this.axis.yScale.apply(a+this.data[s].y),u=this.axis.yScale.apply(r+this.data[s+1].y),o=t,x=c+(u-c)*(t-h)/(l-h)):(o=this.axis.xScale.apply(this.data[s].x),"discrete"!==this.axis.yScaleType?(i=this.axis.getYStack(this.type,this.group,this.data[s].x,this.seriesId),x=this.axis.yScale.apply(i+this.data[s].y)):x=this.axis.yScale.apply(this.data[s].y)),n=new LabelMeta(this.label,this.name,o,x),n.color=this.color,n.values.push({name:this.axis.xTitle,value:this.data[s].x,formatter:this.label.formatters[this.axis.xTitle]||this.axis.xFormatter}),n.values.push({name:this.axis.yTitle,value:this.data[s].y,formatter:this.label.formatters[this.axis.yTitle]||this.axis.yFormatter}),[n]):[void 0]):[void 0]},e}(Series),ScatterSeries=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.color=hx.theme.plot.colors[3],this.size=2}var i,a;return __extends(e,t),i=function(t){return t.filter(function(t){return void 0!==t.x&&void 0!==t.y})},a=function(t,e){var i,a,r,s;for(s=[],a=0,r=t.length;r>a;a++)i=t[a],s.push({x:e.xScale.apply(i.x),y:e.yScale.apply(i.y),color:i.color,size:i.size});return s},e.prototype.updateSvg=function(t,e){var r;return r=this,hx.select(e).view(".hx-series-data","circle").update(function(t){return this.attr("class","hx-series-data hx-series-scatter").attr("cx",t.x).attr("cy",t.y).attr("r",t.size||r.size).style("fill",t.color||r.color)}).apply(a(i(this.data),this.axis))},e.prototype.getLabelMetas=function(t,e){var a,r,s,n,h,l,o,c,u,x;if(!this.label)return[void 0];for(l=t,o=e,a=void 0,r=0,x=i(this.data),c=0,u=x.length;u>c;c++)s=x[c],n=(this.axis.xScale.apply(s.x)-l)*(this.axis.xScale.apply(s.x)-l)+(this.axis.yScale.apply(s.y)-o)*(this.axis.yScale.apply(s.y)-o),(void 0===a||r>n)&&(a=s,r=n);return a?(h=new LabelMeta(this.label,this.name,this.axis.xScale.apply(a.x),this.axis.yScale.apply(a.y)),h.color=a.color||this.color,h.values.push({name:this.axis.xTitle,value:a.x,formatter:this.label.formatters[this.axis.xTitle]||this.axis.xFormatter}),h.values.push({name:this.axis.yTitle,value:a.y,formatter:this.label.formatters[this.axis.yTitle]||this.axis.yFormatter}),[h]):void 0},e}(Series),StraightLineSeries=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.color=hx.theme.plot.colors[4]}var i;return __extends(e,t),e.prototype.updateSvg=function(t,e){var a,r;return a=i.call(this),a?(r=this,hx.select(e).view(".hx-series-data","line").update(function(t){return this["class"]("hx-series-data hx-series-constant").attr("x1",r.axis.xScale.apply(t[0].x)).attr("y1",r.axis.yScale.apply(t[0].y)).attr("x2",r.axis.xScale.apply(t[1].x)).attr("y2",r.axis.yScale.apply(t[1].y)).attr("d",t).attr("stroke",r.color)}).apply([a])):void 0},e.prototype.getLabelMetas=function(t,e){var i,a,r,s,n;return this.label?(i=this.data.dx||0,a=this.data.dy||0,s=this.axis.xScale.inverse(t),n=this.axis.yScale.inverse(e),0!==i&&0!==a&&null!=this.data.x&&null!=this.data.y?n=this.data.y+(s-this.data.x)*a/i:null!=this.data.x?s=this.data.x:null!=this.data.y&&(n=this.data.y),this.axis.xScale.domainMin<s&&s<this.axis.xScale.domainMax&&this.axis.yScale.domainMin<n&&n<this.axis.yScale.domainMax?(r=new LabelMeta(this.label,this.name,this.axis.xScale.apply(s),this.axis.yScale.apply(n)),r.color=this.color,r.values.push({name:this.axis.xTitle,value:s,formatter:this.label.formatters[this.axis.xTitle]||this.axis.xFormatter}),r.values.push({name:this.axis.yTitle,value:n,formatter:this.label.formatters[this.axis.yTitle]||this.axis.yFormatter
}),[r]):[void 0]):[void 0]},i=function(){var t,e,i,a,r,s,n,h,l,o,c,u,x,p,d,g,y,f,v,S,m,M,b,w,T,k;if(n=this.data.dx||0,h=this.data.dy||0,0!==n&&0!==h&&null!=this.data.x&&null!=this.data.y)return x=this.data.x||0,g=this.data.y||0,t=this.axis.xScale.domainMin,e=this.axis.xScale.domainMax,i=this.axis.yScale.domainMin,a=this.axis.yScale.domainMax,r=x-t,s=g-i,c=s*n-h*r,l=function(){switch(!1){case!(c>0):return p=t,u=(t-x)/n,y=g+u*h,{x:p,y:y};case 0!==c:return p=t,y=i,{x:p,y:y};case!(0>c):return y=i,u=(i-g)/h,p=x+u*n,{x:p,y:y}}}(),r=x-e,s=g-a,c=s*n-h*r,o=function(){switch(!1){case!(0>c):return d=e,u=(e-x)/n,f=g+u*h,{x:d,y:f};case 0!==c:return d=e,f=a,{x:d,y:f};case!(c>0):return f=a,u=(a-g)/h,d=x+u*n,{x:d,y:f}}}(),[l,o];if(null!=this.data.x){for(b=[this.axis.yScale.domainMin,this.axis.yScale.domainMax],T=[],v=0,m=b.length;m>v;v++)g=b[v],T.push({x:this.data.x,y:g});return T}if(null!=this.data.y){for(w=[this.axis.xScale.domainMin,this.axis.xScale.domainMax],k=[],S=0,M=w.length;M>S;S++)x=w[S],k.push({x:x,y:this.data.y});return k}},e}(Series),PieChart=function(){function t(t){this.selector=t,this.segmentPadding=0,this.innerPadding=0,this.ringPadding=.1,this.totalAngle=2*Math.PI,this.startAngle=0,this.color=hx.theme.plot.colors[1],this.label=new StandardLabel,this.formatter=hx.format.si(2)}var e,i;return t.prototype.setData=function(t){return this.data=t instanceof Array?t:[t]},e=function(t){var e,a,r;return e=!1,a=hx.sum(t.map(function(t){return t.size})),r=0===a?(e=!0,t.length):hx.sum(t.map(function(t){return i(t,a)})),{total:r,allZero:e}},i=function(t,e,i){return i?1:t.size>0?t.size:e/100},t.prototype.render=function(){var t,a,r,s,n,h,l,o,c,u,x,p,d,g,y,f,v,S,m,M;for(g=this,d=hx.select(this.selector),M=d.width(),h=d.height(),c=Math.min(M,h)/2,this.circle={x:M/2,y:h/2,r:c},t=Math.PI;this.startAngle<0;)this.startAngle+=2*t;switch(!1){case!(this.totalAngle===t&&this.startAngle%(t/2)===0):switch(!1){case!(0===this.startAngle||this.startAngle%(2*t)===0||this.startAngle%t===0):c=hx.clamp(0,h/2,2*c);break;case!(this.startAngle%(1.5*t)===0||this.startAngle%(t/2)===0):c=hx.clamp(0,M/2,2*c)}switch(!1){case!(0===this.startAngle||this.startAngle%(2*t)===0):r=-c/2,s=0;break;case this.startAngle%(1.5*t)!==0:r=0,s=c/2;break;case this.startAngle%t!==0:r=c/2,s=0;break;case this.startAngle%(t/2)!==0:r=0,s=-c/2;break;default:r=0,s=0}this.circle.x+=r,this.circle.y+=s,this.circle.r=c}return a=c*(1-this.innerPadding)/this.data.length+c*(1-this.innerPadding)/this.data.length*this.ringPadding/this.data.length,p=a*this.segmentPadding,l=c*this.innerPadding,u=c-l,o=c,x=u/this.data.length+u/this.data.length*this.ringPadding/this.data.length,m=function(t,e,i,a,r,s){var n,h,o;return o=g.startAngle+1.5*Math.PI,h=o+i/a*g.totalAngle,n=o+(i+t)/a*g.totalAngle,this.attr("d",arcCurve(g.circle.x,g.circle.y,l+x*r,l+x*(r+1-g.ringPadding),h,n,p,s)).attr("fill",e)},S=function(t,a,r){var s,n,h,l,o;return h=t.segments,n=0,o=e(h),l=o.total,s=o.allZero,this.view(".hx-pie-segment","path").update(function(t){var e;return e=i(t,l,s),m.call(this,e,t.color,n,l,r,h.length),n+=e}).apply(h)},n=function(t){var e;return g.svgTarget=this.append("svg")["class"]("hx-graph"),g.plotTarget=g.svgTarget.append("g")["class"]("hx-plot"),e=g.svgTarget.append("g")["class"]("hx-label"),g.svgTarget.on("pointermove",function(t){var e,i;return e=Math.round(t.x-d.box().left),i=Math.round(t.y-d.box().top),g.updateLabels(e,i)}),g.svgTarget.on("pointerleave",function(t){return g.labelsView.apply([])}),g.labelsView=e.view(".hx-plot-label","g").update(function(t,e){return t.render(e)}),g.svgTarget.node()},v=function(t){return this.select(".hx-plot").view(".hx-pie-ring","g").update(S).apply(t.data)},d.view(".hx-graph","svg").enter(n).update(v).apply(this),f=Number(this.svgTarget.style("width").slice(0,-2)),y=Number(this.svgTarget.style("height").slice(0,-2)),this.svgTarget.attr("viewBox","0 0 "+f+" "+y)},t.prototype.updateLabels=function(t,a){var r,s,n,h,l,o,c,u,x,p,d,g,y,f,v,S,m,M,b,w,T,k,A,L,P,_,z,C,D,I,F,V,B,O,N,Y;if(this.label){if(z=hx.select(this.selector),V=z.width(),y=z.height(),w=this.circle.r,l=w*(1-this.innerPadding)/this.data.length+w*(1-this.innerPadding)/this.data.length*this.ringPadding/this.data.length,_=l*this.segmentPadding,f=w*this.innerPadding,T=w-f,b=w,A=T/this.data.length+T/this.data.length*this.ringPadding/this.data.length,p=this.circle.x,d=this.circle.y,w=Math.sqrt((t-p)*(t-p)+(a-d)*(a-d)),f>w||w>b)return void this.labelsView.apply([]);for(F=hx.clamp(0,this.data.length-1,Math.floor((w+this.ringPadding*A/2-f)/A)),k=this.data[F],h=Math.atan2(a-d,t-p)+.5*Math.PI-this.startAngle,0>h&&(h+=2*Math.PI),o=void 0,L=0,N=e(k.segments),I=N.total,n=N.allZero,Y=k.segments,B=0,O=Y.length;O>B;B++){if(P=Y[B],C=i(P,I,n),r=L/I*this.totalAngle,s=(L+C)/I*this.totalAngle,D=Math.min(r,s),g=Math.max(r,s),h>D&&g>h){o=P,x=D,c=g,u=(g-D)/2+D-Math.PI/2+this.startAngle;break}L+=C}return o?(v=A*F+T/this.data.length/2+f,S=p+v*Math.cos(u),m=d+v*Math.sin(u),M=new LabelMeta(this.label,k.name,S,m),M.color=o.color||this.color,M.values.push({name:o.name,value:P.size,formatter:this.label.formatters[k.name]||this.formatter}),this.labelsView.apply(M)):this.labelsView.apply([])}},t}(),hx.PieChart=PieChart,StandardLabel=function(t){function e(){e.__super__.constructor.apply(this,arguments)}return __extends(e,t),e.prototype.render=function(t,e){var i,a,r,s,n,h,l,o;return i=5,hx.select(t).view(".hx-plot-label-marker","circle").update(function(t){return this.attr("cx",t.x).attr("cy",t.y).attr("r",4).attr("fill",t.color).attr("stroke","white").attr("stroke-width",3)}).apply(e),a=function(){return this.view(".hx-plot-label-box","rect").apply(1)},r=function(t,e,i){return this.view(".hx-plot-label-box","rect").update(function(t){return this.attr("width",e).attr("height",i).attr("rx",1).attr("ry",1)}).apply(t)},n=function(t,e,i){return this.view(".hx-plot-label-divider","line").update(function(t){return this.attr("x1",e).attr("y1",t).attr("x2",i).attr("y2",t)}).apply(t)},l=function(t,e,i,a){return this.view(t,"text").update(function(t){return this.text(t).attr("x",i).attr("y",a)}).apply(e),this.select(t).map(function(t){return t.getComputedTextLength()})},h=function(t,e,a){var r;return this.view(".hx-plot-label-header","text").update(function(t){return this.text(t).attr("x",e+i).attr("y",a+i)}).apply(t.name),r=this.select("text").map(function(t){return t.getComputedTextLength()}),{width:r+2*i,height:12+2*i}},o=function(t,e,a){var r,s,n,h,o,c;return o=e+i,c=a,n=0,s=0,this.view(".hx-plot-label-keys","g").update(function(t){var e;return e=l.call(this,".hx-plot-label-key",t.name,o,c+i),c+=12+2*i,s+=12+2*i,n=Math.max(e,n)}).apply(t.values),o=e+3*i+n,c=a,h=0,r=0,this.view(".hx-plot-label-values","g").update(function(t){var e;return e=l.call(this,".hx-plot-label-value",t.formatter(t.value),o,c+i),c+=12+2*i,r+=12+2*i,h=Math.max(e,h)}).apply(t.values),{width:n+h+4*i,height:Math.max(s,r)}},s=function(t){var e,s,l,c,u,x,p,d,g,y,f,v;return a.call(this),f=h.call(this,t,0,0),p=f.width,c=f.height,l=p,s=c,v=o.call(this,t,0,0+s),p=v.width,c=v.height,x=p,u=c,p=Math.max(l,x),c=s+u,r.call(this,t,p,c),e=function(){var e,a,r;for(r=[],d=e=0,a=t.values.length;a>=0?a>e:e>a;d=a>=0?++e:--e)r.push(s+d*(12+2*i));return r}(),n.call(this,e,0,p),t.bounding?(g=t.x+10+p>t.bounding.x2?t.x-p-10:Math.max(t.x+10,t.bounding.x1),y=Math.max(Math.min(t.bounding.y2-c/2,t.y),t.bounding.y1+c/2)-c/2):(g=t.x+10,y=t.y-c/2),this.attr("transform","translate("+g+", "+y+")")},hx.select(t).view(".hx-plot-label-container","g").update(s).apply(e)},e}(Label),hx.StandardLabel=StandardLabel,pie=function(t,e){},graph=function(t,e){var i,a,r,s,n,h,l,o,c,u;for(graph=new hx.Graph(t),c=e.axes,n=0,l=c.length;l>n;n++)for(a=c[n],i=graph.addAxis(a.xType||"linear",a.yType||"linear"),["xTitle","yTitle","xMin","xMax","yMin","yMax","xScalePaddingMax","xScalePaddingMin","yScalePaddingMax","yScalePaddingMin","xFormatter","yFormatter"].forEach(function(t){return hx_defined(a[t])?i[t]=a[t]:void 0}),u=a.series,h=0,o=u.length;o>h;h++)s=u[h],r=i.addSeries(s.type||"line",s.name),r.setData(s.data),r.color=s.color,r.label.interpolate=s.label.interpolate,r.group=s.group,r.fill=s.fill,r.fillColor=s.fillColor,r.markers=s.markers,r.markerColor=s.markerColor,r.markerRadius=s.markerRadius||2;return graph.render(),graph},plot=function(t,e){switch(e.type){case"pie":return pie(t,e);default:return graph(t,e)}},hx.plot=plot;})();(function(){var UserPreferences,loadPreferences,localeList,preferences,__hasProp={}.hasOwnProperty,__extends=function(e,l){function o(){this.constructor=e}for(var n in l)__hasProp.call(l,n)&&(e[n]=l[n]);return o.prototype=l.prototype,e.prototype=new o,e.__super__=l.prototype,e};localeList=[{code:"af",full:"Afrikaans"},{code:"sq",full:"Albanian"},{code:"ar",full:"Arabic"},{code:"ar-ma",full:"Arabic (Morocco)"},{code:"ar-sa",full:"Arabic (Saudi Arabia)"},{code:"ar-tn",full:"Arabic (Tunisia)"},{code:"hy-am",full:"Armenian"},{code:"az",full:"Azerbaijani"},{code:"id",full:"Bahasa Indonesia"},{code:"ms-my",full:"Bahasa Malayu"},{code:"eu",full:"Basque"},{code:"be",full:"Belarusian"},{code:"bn",full:"Bengali"},{code:"bs",full:"Bosnian"},{code:"br",full:"Breton"},{code:"bg",full:"Bulgarian"},{code:"my",full:"Burmese"},{code:"ca",full:"Catalan"},{code:"zh-cn",full:"Chinese"},{code:"zh-tw",full:"Chinese (Traditional)"},{code:"cv",full:"Chuvash"},{code:"hr",full:"Croatian"},{code:"cs",full:"Czech"},{code:"da",full:"Danish"},{code:"nl",full:"Dutch"},{code:"en",full:"English (US)"},{code:"en-au",full:"English (Australia)"},{code:"en-ca",full:"English (Canada)"},{code:"en-gb",full:"English"},{code:"eo",full:"Esperanto"},{code:"et",full:"Estonian"},{code:"fo",full:"Farose"},{code:"fi",full:"Finnish"},{code:"fr",full:"French"},{code:"fr-ca",full:"French (Canada)"},{code:"fy",full:"Frisian"},{code:"gl",full:"Galician"},{code:"ka",full:"Georgian"},{code:"de",full:"German"},{code:"de-at",full:"German (Austria)"},{code:"el",full:"Greek"},{code:"he",full:"Hebrew"},{code:"hi",full:"Hindi"},{code:"hu",full:"Hungarian"},{code:"is",full:"Icelandic"},{code:"it",full:"Italian"},{code:"ja",full:"Japanese"},{code:"km",full:"Khmer (Cambodia)"},{code:"ko",full:"Korean"},{code:"lv",full:"Latvian"},{code:"lt",full:"Lithuanian"},{code:"lb",full:"Luxembourgish"},{code:"mk",full:"Macedonian"},{code:"ml",full:"Malayalam"},{code:"mr",full:"Marathi"},{code:"ne",full:"Nepalese"},{code:"nb",full:"Norwegian"},{code:"nn",full:"Norwegian Nynorsk"},{code:"fa",full:"Persian"},{code:"pl",full:"Polish"},{code:"pt",full:"Portuguese"},{code:"pt-br",full:"Portuguese (Brazil)"},{code:"ro",full:"Romanian"},{code:"ru",full:"Russian"},{code:"sr",full:"Serbian"},{code:"sr-cyrl",full:"Serbian Cyrillic"},{code:"sk",full:"Slovak"},{code:"sl",full:"Slovenian"},{code:"es",full:"Spanish"},{code:"sv",full:"Swedish"},{code:"tl-ph",full:"Tagalog (Filipino)"},{code:"tzm",full:"TamaziÉ£t"},{code:"tzm-latn",full:"TamaziÉ£t Latin"},{code:"ta",full:"Tamil"},{code:"th",full:"Thai"},{code:"bo",full:"Tibetan"},{code:"tr",full:"Turkish"},{code:"uk",full:"Ukrainian"},{code:"uz",full:"Uzbek"},{code:"vi",full:"Vietnamese"},{code:"cy",full:"Welsh"}],preferences=void 0,loadPreferences=function(){return null!=preferences?preferences:preferences=[{name:"Time Zone",type:"Text",options:{key:"timeZone",required:!0,autoCompleteData:"undefined"!=typeof moment&&null!==moment?moment.tz.names():void 0,autoCompleteOptions:{mustMatch:!0,showOtherResults:!0}}},{name:"Locale",type:"Text",options:{key:"locale",required:!0,autoCompleteData:[],autoCompleteOptions:{mustMatch:!0,showOtherResults:!0,renderer:function(e,l){return e=hx.select(e).text(""+l.full+" - ("+l.code+")")},inputMap:function(e){return e.code},filter:function(e,l){var o;return o={searchValues:function(e){return[e.full,e.code]}},e=hx.filter.contains(e,l,o),e=e.sort(function(e,l){return!e.disabled&&l.disabled?-1:e.disabled&&!l.disabled?1:hx.sort.compare(e.full,l.full)})}}}}]},UserPreferences=function(e){function l(){l.__super__.constructor.apply(this,arguments),this._={},this.supportedLocales=localeList.slice()}var o,n;return __extends(l,e),n=function(e,l,o){var n,r;return r=document.createElement("form"),hx.select(r).style("display","block"),n=new hx.Form(r).on("submit",function(e){var l;return l=hx.notify().loading("Saving preferences..."),o.setPreferences(e,function(e,n){return l.close(),null!=e?hx.notify().error("Preferences were not saved successfully"):(hx.notify().info("Preferences were saved successfully","fa fa-check"),o._.modal.close())})}),loadPreferences().forEach(function(e){var l;return"Locale"===e.name&&(null!=(l=o.supportedLocales)?l.length:void 0)>0?(e.options.autoCompleteData=localeList.map(function(e){return e.disabled=o.supportedLocales.some(function(l){return l===e.code})?!1:!0,e}),n["add"+e.type](e.name,e.options)):"Locale"!==e.name?"Radio"===e.type||"Select"===e.type?n["add"+e.type](e.name,e.values,e.options):n["add"+e.type](e.name,e.options):void 0}),n.addSubmit("Submit","fa fa-check"),n.fill(l),e.appendChild(r)},l.prototype.show=function(){var e,l,o;return o=this._,void(o.modal||(l=this,e=hx.notify().loading("Getting preferences..."),this.getPreferences(function(r,t){return e.close(),r?hx.notify().error(""):(o.modal=new hx.Modal("Settings",function(e){return n(e,t,l)}),o.modal.show(),o.modal.on("close",function(){return o.modal=void 0}))})))},l.prototype.hide=function(){return void(this._.modal&&this._.modal.close())},o=function(e,l,o){var n,r;return r=JSON.stringify(this._.preferences),n=JSON.stringify(l),r!==n&&(this._.preferences=l,this.emit("change",this._.preferences)),void("function"==typeof o&&o(e,hx.merge(!0,this._.preferences)))},l.prototype.getPreferences=function(e){var l,n;return l=(n=localStorage.getItem("preferences"))?JSON.parse(n):void 0,o.call(this,void 0,l,e)},l.prototype.setPreferences=function(e,l){return localStorage.setItem("preferences",JSON.stringify(e)),o.call(this,void 0,e,l)},l.prototype.clearPreferences=function(){return localStorage.removeItem("preferences"),void(this._.preferences=void 0)},l.prototype.getLocaleList=function(){return localeList.slice()},l}(hx.EventEmitter),hx.preferences=new UserPreferences;})();(function(){var ProgressBar;ProgressBar=function(){function r(r){this.selection=hx.select(r).classed("hx-progress-bar",!0),this.innerBar=this.selection.append("div").attr("class","hx-progress-bar-inner"),this.setProgress(0)}return r.prototype.setProgress=function(r){return isNaN(r)?void 0:(this.progress=Math.max(0,Math.min(1,r)),this.innerBar.style("width",100*this.progress+"%"))},r.prototype.getProgress=function(){return this.progress},r}(),hx.ProgressBar=ProgressBar;})();(function(){var clearSearch,searchDOM;searchDOM=function(e,n,t,l){var o,r,c,i,u,h,a,f,d,s;return null==e&&(e="body"),null==l&&(l={}),i=function(e){return s.selectAll(".hx-opened").each(function(e){var n,t;return n=hx.select.getHexagonElementDataObject(e,!1),null!=n&&null!=(t=n.widget)?t.hide(!1):void 0}),"function"==typeof e?e():void 0},u=function(e){return r+=1,'<span class="hx-highlight-selected">'+e+"</span>"},d=function(e,n){return e.selectAll(".hx-highlighted-content").each(function(e){var n,t;return n=e.childNodes,t=document.createTextNode(e.textContent),e.parentNode.replaceChild(t,e)}),"function"==typeof n?n():void 0},h=function(e,n){var t,l;return null==n&&(n=e),null===e.offsetParent&&null!=(null!=n?n.parentNode:void 0)?(t=hx.select.getHexagonElementDataObject(n,!1),null!=t&&null!=(l=t.widget)&&"function"==typeof l.show&&l.show(!1,e),h(e,n.parentNode)):void 0},a=function(e,n){var t;for(t=e,e=c.length<50?c.length:1*e+10;e>t&&t<c.length;)h(c[t]),t+=1;return void(t<c.length&&setTimeout(function(){return a(t)},150))},o=function(e){var n,t,r,i,h,a,d;if(i=(null!=(d=e.textContent)?d.search(f):void 0)>-1){if("#text"===e.nodeName)r=hx.detached("span")["class"]("hx-highlighted-content").node(),r.innerHTML=e.data.replace(f,u),e.parentNode.replaceChild(r,e),null===r.offsetParent&&null!=(null!=r?r.parentNode:void 0)&&c.push(r);else if("function"==typeof l.elemMatch&&l.elemMatch(e,!0),t=e.childNodes,t.length>0)for(h=0,a=t.length;a>h;h++)n=t[h],o(n)}else"#text"!==e.nodeName&&"function"==typeof l.elemMatch&&l.elemMatch(e,!1);return void 0},s=hx.select(e),s.style("min-height",s.style("height")),c=[],r=0,null!=n&&n.length>0?(n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),f=new RegExp(n,"ig"),i(function(){return d(s,function(){return n.length>=(l.minLength||2)?(o(s.node()),"function"==typeof t&&t(r)):"function"==typeof t&&t(),c.length>0?setTimeout(function(){return a(0)},0):void 0})})):i(function(){return d(s,function(){return"function"==typeof t?t():void 0})}),void setTimeout(function(){return s.style("min-height","")},10)},clearSearch=function(e){return null==e&&(e="body"),searchDOM(e)},hx.searchDOM=searchDOM,hx.clearSearch=clearSearch;})();(function(){var Tabs,__hasProp={}.hasOwnProperty,__extends=function(t,e){function s(){this.constructor=t}for(var c in e)__hasProp.call(e,c)&&(t[c]=e[c]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};Tabs=function(t){function e(t){var c;this.selector=t,e.__super__.constructor.apply(this,arguments),this.selected=-1,c=this,hx.select(this.selector).selectAll(".hx-tab").each(function(t,e){return hx.select(t).on("click",function(){return s(c,t,e)})}),this.select(0)}var s;return __extends(e,t),s=function(t,e,s){return t.selected=s,hx.select(t.selector).selectAll(".hx-tab").classed("hx-tab-active",!1),hx.select(e).classed("hx-tab-active",!0),hx.select(t.selector).selectAll(".hx-tab-content").classed("hx-tab-content-hidden",!0),hx.select("#"+hx.select(e).attr("data-content")).classed("hx-tab-content-hidden",!1),t.emit("change",{id:s})},e.prototype.select=function(t,e){var c;return this.selected!==t||e?(c=hx.select(this.selector).selectAll(".hx-tab").nodes[t],s(this,c,t)):void 0},e}(hx.EventEmitter),hx.Tabs=Tabs;})();(function(){var TimeSlider,__hasProp={}.hasOwnProperty,__extends=function(t,e){function r(){this.constructor=t}for(var n in e)__hasProp.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};TimeSlider=function(t){function e(t,r,n){var s;s=new Date,s.setMilliseconds(0),s.setMinutes(0),s.setHours(0),this.start=s.getTime(),this.end=new Date(this.start+864e5-1),null==n&&(n=function(t,e,r,n,s){return hx.select(e).text(t.formatter(t.valueToDate(r)))}),e.__super__.constructor.call(this,t,r,n)}var r,n;return __extends(e,t),r=function(t,e){return e instanceof Date?(e.getTime()-t.start)/(t.end-t.start):e},e.prototype.valueToDate=function(t){return new Date(this.start+(this.end-this.start)*t)},e.prototype.formatter="undefined"!=typeof moment&&null!==moment?function(t){return moment(t).format("HH:mm")}:(n=hx.format.zeroPad(2),function(t){return n(t.getHours())+":"+n(t.getMinutes())}),e.prototype.setRange=function(t,e){return this.start=t.getTime(),this.end=e.getTime(),sliderRefresh(this),this},e.prototype.setValue=function(t){return e.__super__.setValue.call(this,r(this,t))},e.prototype.setRangeStartValue=function(t){return e.__super__.setRangeStartValue.call(this,r(this,t))},e.prototype.setRangeEndValue=function(t){return e.__super__.setRangeEndValue.call(this,r(this,t))},e.prototype.getValue=function(){return new Date(this.start+(this.end-this.start)*this.value)},e.prototype.getRangeStartValue=function(){return new Date(this.start+(this.end-this.start)*this.rangeStartValue)},e.prototype.getRangeEndValue=function(){return new Date(this.start+(this.end-this.start)*this.rangeEndValue)},e}(hx.Slider),hx.TimeSlider=TimeSlider;})();(function(){var TitleBar;TitleBar=function(){function e(e){var l,i,s;this.selector=e,this.isMobileFriendly=hx.select(this.selector).select(".hx-titlebar-menu-icon-mobile").size()>0,l=hx.select(this.selector).select(".hx-titlebar-linkbar").size()>0,i=hx.select("body").classed("hx-titlebar-fixed"),s=hx.select("body").classed("hx-full-screen"),this.isMobileFriendly&&(hx.select(this.selector).select(".hx-titlebar-menu-icon-mobile").on("click",function(e){return function(){return t.call(e,!e.visible,!0)}}(this)),this.visible=!0,t.call(this,!1,!1)),l&&(i||s)&&hx.select("body").classed("hx-titlebar-link-padding",!0)}var t;return t=function(e,t){var l;return null==t&&(t=!0),this.isMobileFriendly&&e!==this.visible?(this.visible=e,l=function(l){return e?(l.classed("hx-titlebar-mobile-hide",!1),t?l.style("height","0px").morph()["with"]("expand",150).go():void 0):t?l.morph()["with"]("collapse",50).then(function(){return l.classed("hx-titlebar-mobile-hide",!0)}).thenStyle("display","").go():l.classed("hx-titlebar-mobile-hide",!0)},l(hx.select(this.selector).selectAll(".hx-titlebar-menu-icons")),l(hx.select(this.selector).selectAll(".hx-titlebar-linkbar"))):void 0},e.prototype.show=function(e){return t.call(this,!0,e)},e.prototype.hide=function(e){return t.call(this,!1,e)},e.prototype.setActive=function(e){var t;return t=hx.selectAll(".hx-titlebar-link").classed("hx-selected",!1),null!=e?hx.isString(e)?hx.select(e).classed("hx-selected",!0):hx.select(t.node(e)).classed("hx-selected",!0):void 0},e}(),hx.TitleBar=TitleBar,hx.select(".hx-heading").size()>0&&(hx.titlebar=new hx.TitleBar(".hx-heading"));})();(function(){var Tree;Tree=function(){function e(e,t){this.selector=e,this.hideDisabledButtons=null!=t?t:!1,this.selection=hx.select(this.selector).classed("hx-openable",!0),hx.select.getHexagonElementDataObject(this.selection.node()).widget=this,this.refresh()}var t,n;return t=function(e,t,n){var r,l,s,o,c,i,h,d;return l=function(t){return function(t){var n,r;return r=hx.select(e).select(".hx-tree-node-children"),n="none"===r.style("display")?"block":"none",r.style("display",n),s(t,!0)}}(this),s=function(t){return function(t,n){var r,l;return r=hx.select(e).select(".hx-tree-node-children"),!r.selectAll(".hx-tree-node").empty()&&(l="block"===r.style("display"),hx.select(e).classed("hx-tree-node-open",l),n)?hx.select(t).select("i").morph().then(l?"rotate-90":"rotate-0").go(!0):void 0}}(this),d=hx.select(e.parentNode).selectAll(".hx-tree-node").select(".hx-tree-node-children").selectAll(".hx-tree-node").size()>0,d=t?!1:d,hx.select(e).select(".hx-tree-node-children").selectAll(".hx-tree-node").size()>0||d?(o=hx.select(e).select(".hx-tree-node-parent"),o.size()>0?o.view(".hx-tree-node-parent-icon").enter(function(){var e;return e=this.append("div"),e.attr("class","hx-tree-node-parent-icon").append("i").attr("class","fa fa-chevron-right hx-tree-node-state-icon"),e.node()}).update(function(e,t){return this.on("click",function(){return l(t)}),s(t,n)}).apply(this):(i=hx.select(e),r=i.select(".hx-tree-node-content").node(),c=i.append("div").attr("class","hx-tree-node-parent").node(),c.appendChild(r),h=hx.select(c).append("div"),h.attr("class","hx-tree-node-parent-icon hx-tree-node-parent-icon-disabled").append("i").attr("class","fa fa-chevron-right"))):void 0},e.prototype.refresh=function(e){return null==e&&(e=!1),this.selection.selectAll(".hx-tree-node").each(function(n){return function(r){return t(r,n.hideDisabledButtons,e)}}(this))},e.prototype.render=function(e,t){var n,r;return n=function(e,n){var l,s,o;return null!=n.children&&n.children.length>0?(s=hx.select(e).append("div").attr("class","hx-tree-node-parent"),o=s.append("div").attr("class","hx-tree-node-content"),t(o.node(),n),l=hx.select(e).append("div").attr("class","hx-tree-node-children"),r(l,n.children)):(l=hx.select(e).append("div").attr("class","hx-tree-node-content"),t(l.node(),n))},r=function(e,t){var r;return r=e.view(".hx-tree-node").enter(function(e){var t;return t=this.append("div").attr("class","hx-tree-node").node(),n(t,e),t}).apply(t)},this.selection.selectAll(".hx-tree-node").remove(),r(this.selection,e),this.refresh()},n=function(e){var t,r;return r=hx.select(e),r.classed("hx-tree-node")&&(e=e.parentNode,r.select(":scope > .hx-tree-node-children").style("display","block")),t=e.parentNode,null!=t&&this.selection.node().contains(e)?n.call(this,t):void 0},e.prototype.show=function(e,t){return null==e&&(e=!0),null!=t?n.call(this,t):this.selection.selectAll(".hx-tree-node-children").style("display","block"),this.selection.classed("hx-opened",!0),this.refresh(e)},e.prototype.hide=function(e,t){var n,r;return null==e&&(e=!0),null!=t?(r=hx.select(t),r.select(":scope > .hx-tree-node-children").style("display","none"),n=this.selection.selectAll(".hx-tree-node-children").style("display"),n.some(function(e){return"block"===e})||this.selection.classed("hx-opened",!1)):(this.selection.classed("hx-opened",!1),this.selection.selectAll(".hx-tree-node-children").style("display","none")),this.refresh(e)},e}(),hx.Tree=Tree,hx.initialiseTrees=function(e){return hx.selectAll(e).map(function(e){return new Tree(e)})};})();})();